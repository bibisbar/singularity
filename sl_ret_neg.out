output dir >> /home/wiss/zhang/Jinhe/singularity/neg/ret_anet/anet_anet_neg_0
rdzv_endpoint: worker-6:22348
[32m2023-10-20T15:21:36 | loopitr: [0mLogging to: /home/wiss/zhang/Jinhe/singularity/neg/ret_anet/anet_anet_neg_0/train.log

[32m2023-10-20T15:21:44 | __main__: [0mconfig: 
{'data_root': '/home/wiss/zhang/nfs/Anet_sing', 'anno_root_downstream': '/home/wiss/zhang/Jinhe/singularity/Data/anetqa', 'train_type': 'anet_ret_train_1_neg.json', 'train_file': ['${anno_root_downstream}/${train_type}', '/home/wiss/zhang/nfs/Anet_sing', 'video'], 'test_types': ['temporal_contact_swap', 'temporal_contact_swap_mani', 'temporal_action_swap', 'temporal_action_swap_mani', 'neighborhood_same_entity', 'neighborhood_same_entity_mani', 'neighborhood_diff_entity', 'neighborhood_diff_entity_mani', 'counter_spatial', 'counter_spatial_mani', 'counter_contact', 'counter_contact_mani', 'counter_action', 'counter_action_mani', 'counter_attribute', 'counter_attribute_mani'], 'test_file': {'temporal_contact_swap': ['${anno_root_downstream}/anet_ret_temporal_contact_swap.json', '/home/wiss/zhang/nfs/Anet_sing', 'video'], 'temporal_contact_swap_mani': ['${anno_root_downstream}/anet_ret_temporal_contact_swap_mani.json', '/home/wiss/zhang/nfs/Anet_sing', 'video'], 'temporal_action_swap': ['${anno_root_downstream}/anet_ret_temporal_action_swap.json', '/home/wiss/zhang/nfs/Anet_sing', 'video'], 'temporal_action_swap_mani': ['${anno_root_downstream}/anet_ret_temporal_action_swap_mani.json', '/home/wiss/zhang/nfs/Anet_sing', 'video'], 'neighborhood_same_entity': ['${anno_root_downstream}/anet_ret_neighborhood_same_entity.json', '/home/wiss/zhang/nfs/Anet_sing', 'video'], 'neighborhood_same_entity_mani': ['${anno_root_downstream}/anet_ret_neighborhood_same_entity_mani.json', '/home/wiss/zhang/nfs/Anet_sing', 'video'], 'neighborhood_diff_entity': ['${anno_root_downstream}/anet_ret_neighborhood_diff_entity.json', '/home/wiss/zhang/nfs/Anet_sing', 'video'], 'neighborhood_diff_entity_mani': ['${anno_root_downstream}/anet_ret_neighborhood_diff_entity_mani.json', '/home/wiss/zhang/nfs/Anet_sing', 'video'], 'counter_spatial': ['${anno_root_downstream}/anet_ret_counter_spatial.json', '/home/wiss/zhang/nfs/Anet_sing', 'video'], 'counter_spatial_mani': ['${anno_root_downstream}/anet_ret_counter_spatial_mani.json', '/home/wiss/zhang/nfs/Anet_sing', 'video'], 'counter_contact': ['${anno_root_downstream}/anet_ret_counter_contact.json', '/home/wiss/zhang/nfs/Anet_sing', 'video'], 'counter_contact_mani': ['${anno_root_downstream}/anet_ret_counter_contact_mani.json', '/home/wiss/zhang/nfs/Anet_sing', 'video'], 'counter_action': ['${anno_root_downstream}/anet_ret_counter_action.json', '/home/wiss/zhang/nfs/Anet_sing', 'video'], 'counter_action_mani': ['${anno_root_downstream}/anet_ret_counter_action_mani.json', '/home/wiss/zhang/nfs/Anet_sing', 'video'], 'counter_attribute': ['${anno_root_downstream}/anet_ret_counter_attribute.json', '/home/wiss/zhang/nfs/Anet_sing', 'video'], 'counter_attribute_mani': ['${anno_root_downstream}/anet_ret_counter_attribute_mani.json', '/home/wiss/zhang/nfs/Anet_sing', 'video']}, 'stop_key': 'val1/', 'is_paragraph_retrieval': True, 'text_encoder': 'bert-base-uncased', 'bert_config': 'configs/config_bert.json', 'vit_type': 'beit', 'vit_zoo': {'beit': 'microsoft/beit-base-patch16-224-pt22k-ft22k'}, 'vit_name_or_pretrained_path': '${vit_zoo[${vit_type}]}', 'temporal_vision_encoder': {'enable': True, 'num_layers': 2, 'update_pooler_embed': False}, 'add_temporal_embed': True, 'image_res': 224, 'embed_dim': 256, 'video_input': {'num_frames': 4, 'reader': 'decord', 'sample_type': 'rand', 'num_frames_test': 4, 'sample_type_test': 'middle'}, 'max_txt_l': 60, 'batch_size': {'image': 160, 'video': 32}, 'batch_size_test': {'image': 128, 'video': 32}, 'k_test': 128, 'temp': 0.01, 'loss_weight': {'itc': 1.0, 'itm': 1.0}, 'itm_hard_neg': True, 'optimizer': {'opt': 'adamW', 'lr': 1e-05, 'opt_betas': [0.9, 0.999], 'weight_decay': 0.02, 'max_grad_norm': -1, 'different_lr': {'enable': False, 'module_names': [], 'lr': 0.001}}, 'scheduler': {'sched': 'cosine', 'epochs': 30, 'min_lr_multi': 0.1, 'warmup_epochs': 0, 'epoch': 30}, 'output_dir': '/home/wiss/zhang/Jinhe/singularity/neg/ret_anet/anet_anet_neg_0', 'resume': False, 'pretrained_path': '/home/wiss/zhang/nfs/anet_anet_train_1_Seed42/ckpt_best.pth', 'evaluate': False, 'eval_frame_ensemble': 'concat', 'eval_x_only': False, 'eval_offload': True, 'device': 'cuda', 'seed': 42, 'log_freq': 100, 'dist_url': 'env://', 'distributed': True, 'fp16': True, 'debug': False, 'num_workers': 24, 'wandb': {'enable': True, 'entity': 'gengyuanzhang', 'project': 'sb_ret_anet'}, 'save_path': '/home/wiss/zhang/nfs/video_prober/singularity/anetqa/', '22348': None, 'rank': 0, 'world_size': 2, 'gpu': 0, 'dist_backend': 'nccl'}
[32m2023-10-20T15:21:44 | __main__: [0mtrain_file: ['${anno_root_downstream}/${train_type}', '/home/wiss/zhang/nfs/Anet_sing', 'video']
[32m2023-10-20T15:21:44 | tasks.pretrain: [0mCreating dataset for ret
[5m[31mWARNING[0m [32m2023-10-20T15:21:44 | py.warnings: [0m/home/wiss/zhang/Jinhe/singularity/utils/distributed.py:18: UserWarning: This DataLoader will create 24 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  builtin_warn(*args, **kwargs)

[5m[31mWARNING[0m [32m2023-10-20T15:21:44 | py.warnings: [0m/home/wiss/zhang/Jinhe/singularity/utils/distributed.py:18: UserWarning: This DataLoader will create 24 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  builtin_warn(*args, **kwargs)

[32m2023-10-20T15:21:45 | tasks.shared_utils: [0mCreating model
[32m2023-10-20T15:21:48 | models.model_retrieval_base: [0mLoading vit pre-trained weights from huggingface microsoft/beit-base-patch16-224-pt22k-ft22k.
[5m[31mWARNING[0m [32m2023-10-20T15:21:49 | py.warnings: [0m/home/wiss/zhang/anaconda3/envs/probe-sl/lib/python3.7/site-packages/torch/functional.py:445: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1639180594101/work/aten/src/ATen/native/TensorShape.cpp:2157.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]

[5m[31mWARNING[0m [32m2023-10-20T15:21:49 | py.warnings: [0m/home/wiss/zhang/anaconda3/envs/probe-sl/lib/python3.7/site-packages/torch/functional.py:445: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1639180594101/work/aten/src/ATen/native/TensorShape.cpp:2157.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]

[32m2023-10-20T15:21:50 | models.model_retrieval_base: [0mInit new model with new image size 224, and load weights.
[32m2023-10-20T15:21:53 | models.model_retrieval_base: [0m_IncompatibleKeys(missing_keys=['encoder.layer.0.attention.attention.relative_position_bias.relative_position_index', 'encoder.layer.1.attention.attention.relative_position_bias.relative_position_index', 'encoder.layer.2.attention.attention.relative_position_bias.relative_position_index', 'encoder.layer.3.attention.attention.relative_position_bias.relative_position_index', 'encoder.layer.4.attention.attention.relative_position_bias.relative_position_index', 'encoder.layer.5.attention.attention.relative_position_bias.relative_position_index', 'encoder.layer.6.attention.attention.relative_position_bias.relative_position_index', 'encoder.layer.7.attention.attention.relative_position_bias.relative_position_index', 'encoder.layer.8.attention.attention.relative_position_bias.relative_position_index', 'encoder.layer.9.attention.attention.relative_position_bias.relative_position_index', 'encoder.layer.10.attention.attention.relative_position_bias.relative_position_index', 'encoder.layer.11.attention.attention.relative_position_bias.relative_position_index'], unexpected_keys=[])
[32m2023-10-20T15:21:53 | models.model_retrieval_base: [0mBuild text_encoder bert-base-uncased
[32m2023-10-20T15:21:55 | models.model_retrieval_base: [0mBuild text_encoder bert-base-uncased, done!
[32m2023-10-20T15:21:55 | models.model_retrieval_base: [0mBuild temporal_vision_encoder (#layer=2), randomly initialised.
[32m2023-10-20T15:21:55 | models.model_retrieval_base: [0mBuild temporal_vision_encoder, done!
[32m2023-10-20T15:21:55 | utils.optimizer: [0moptimizer -- lr=1e-05 wd=0.02 len(p)=190
[32m2023-10-20T15:21:55 | utils.optimizer: [0moptimizer -- lr=1e-05 wd=0 len(p)=300
[32m2023-10-20T15:21:55 | tasks.shared_utils: [0mLoading checkpoint from /home/wiss/zhang/nfs/anet_anet_train_1_Seed42/ckpt_best.pth
[32m2023-10-20T15:22:00 | models.utils: [0mLoad temporal_embeddings, lengths: 4-->4
[32m2023-10-20T15:22:00 | models.utils: [0mLoad temporal_embeddings, lengths: 4-->4
[32m2023-10-20T15:22:00 | tasks.shared_utils: [0m_IncompatibleKeys(missing_keys=['vision_encoder.encoder.layer.0.attention.attention.relative_position_bias.relative_position_index', 'vision_encoder.encoder.layer.1.attention.attention.relative_position_bias.relative_position_index', 'vision_encoder.encoder.layer.2.attention.attention.relative_position_bias.relative_position_index', 'vision_encoder.encoder.layer.3.attention.attention.relative_position_bias.relative_position_index', 'vision_encoder.encoder.layer.4.attention.attention.relative_position_bias.relative_position_index', 'vision_encoder.encoder.layer.5.attention.attention.relative_position_bias.relative_position_index', 'vision_encoder.encoder.layer.6.attention.attention.relative_position_bias.relative_position_index', 'vision_encoder.encoder.layer.7.attention.attention.relative_position_bias.relative_position_index', 'vision_encoder.encoder.layer.8.attention.attention.relative_position_bias.relative_position_index', 'vision_encoder.encoder.layer.9.attention.attention.relative_position_bias.relative_position_index', 'vision_encoder.encoder.layer.10.attention.attention.relative_position_bias.relative_position_index', 'vision_encoder.encoder.layer.11.attention.attention.relative_position_bias.relative_position_index'], unexpected_keys=[])
[32m2023-10-20T15:22:00 | tasks.shared_utils: [0mLoaded checkpoint from /home/wiss/zhang/nfs/anet_anet_train_1_Seed42/ckpt_best.pth
[32m2023-10-20T15:22:00 | __main__: [0mtraining
[32m2023-10-20T15:22:44 | dataset.dataloader: [0mMetaLoader has 1 dataloaders, 572 batches in total
dataloader index=0 name=video, batch-size=32 length(#batches)=572 
idx in forward tensor([4126, 3501, 6133, 8752,  929, 1992, 1164, 3376, 3146, 8756,   86, 5437,
        5978, 4526, 7518, 2895, 3517, 3261, 6634, 1339, 4664, 6682, 5487, 2765,
        9080, 5385,  577, 7984, 5371, 6128, 2379, 7325], device='cuda:0')
idx in forward tensor([4828, 5526, 6157, 6416, 4455, 6005, 6064, 2680, 2526, 8350, 6012, 3466,
        1240, 5828, 7181,  744,  639,  856, 5986, 6922, 2368,  391, 1594, 4897,
        4212, 2221,  288, 7970, 6510, 6787, 3719, 1897], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3912, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3844, device='cuda:0', grad_fn=<MeanBackward0>)
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4001, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3945, device='cuda:1', grad_fn=<MeanBackward0>)
[5m[31mWARNING[0m [32m2023-10-20T15:27:33 | py.warnings: [0m/home/wiss/zhang/Jinhe/singularity/utils/distributed.py:18: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  builtin_warn(*args, **kwargs)

[5m[31mWARNING[0m [32m2023-10-20T15:27:33 | py.warnings: [0m/home/wiss/zhang/Jinhe/singularity/utils/distributed.py:18: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  builtin_warn(*args, **kwargs)

[32m2023-10-20T15:27:33 | utils.basic_utils: [0mTrain Epoch: [0]  [  0/572]  eta: 1 day, 21:57:04  lr: 0.000010  temperature: 0.0169  video-loss_ita: 2.4961  video-loss_itm: 0.6135  time: 289.2036  data: 124.1011  max mem: 30673 res mem: 32714
idx in forward idx in forward tensor([1975,  908, 5148, 6226, 9057, 2651,  845, 3310, 3545, 1263, 1490, 6214,
        9052,  229, 6731,  296, 5484, 3891, 1671, 4554, 4865, 6490,  740, 3350,
        3647, 1972, 2079, 5816, 5139, 7873, 3223, 6812], device='cuda:1')
tensor([1282,   44, 7843, 8749, 8385, 4196, 4086, 7426,  995, 1972, 5607, 1443,
        8589, 3463, 7426,   42, 1583, 1747, 4611, 8686, 2968,  418, 4778, 1356,
        5831,  114, 8544,  626,   73, 5427, 9052, 6486], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4048, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3997, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3908, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3831, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([9002, 8287, 2966, 2984, 4602, 4690, 2842, 5537, 3962, 1040, 1655,  343,
        1779, 6943, 2960, 2684, 2202, 5708, 3397, 2307, 8947, 2851, 5665, 3588,
        8759, 5837, 7685,  334, 8607, 1453,  727, 5598], device='cuda:0')
idx in forward tensor([8276, 2418, 5038, 5884, 6355, 6063, 7421, 4442, 4232, 3286, 7571, 4183,
        5600, 5038, 2999, 6162, 3732, 4764,  290, 6534, 6901, 3221, 8805, 4643,
        1601, 1379, 7782,  533,  557, 2415, 8127, 8587], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3884, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3802, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4047, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3990, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 525, 5169, 4028, 2133, 2468, 6765, 3272, 8873, 7363, 4709, 4362, 2317,
         543,  106, 8398, 5790, 8847, 2798, 1526, 5377, 8189, 9127, 1586, 3519,
        5401, 6499, 1135, 5861, 6174,  893, 8513, 4953], device='cuda:1')
idx in forward tensor([5357, 7961, 1657, 6443,  947, 4305,  779, 4126, 5579, 1971, 7449, 8589,
        2912, 1107, 8574, 2778, 1454, 4103,  500, 9145, 7610, 7998, 8128, 6686,
        3825, 7752, 1768,  436, 6300, 4988, 6133, 1601], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3938, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3865, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3871, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3779, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3460,  725,  896, 3775, 3883, 8625,  222, 1053, 6034,  341, 5296, 7868,
        3964, 8691, 7868, 3913, 7130, 3531, 5255,  820, 2216, 6022, 7210, 5547,
        4389, 1015, 3460, 5185, 7788, 1063,  743, 2753], device='cuda:0')
idx in forward tensor([6188, 5711, 8535, 3094, 2268, 5700, 5108, 1385, 3080, 2872,  309, 8864,
        2045, 8668, 3743, 1996, 5225, 6590, 1203, 3288, 7122,  345, 6539, 8208,
        3342, 1049, 3231, 3527, 4832,  871, 4647, 6867], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3799, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3711, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3872, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3794, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7672, 4782,  675, 1359, 7698, 3762, 4190, 5109, 5442,  699, 3137,  960,
        8938,  491, 6797, 3554, 5530, 2640, 1043,  873, 8139, 6152, 7309, 7999,
        2835, 7576, 2537, 3197, 4930, 8979, 9070, 8345], device='cuda:0')
idx in forward tensor([4416, 7901, 3186, 3248, 8129, 3710, 6878, 5593, 4459, 7652, 2828, 6372,
        6287, 8821, 6799, 6841, 5767, 1181, 4605, 4254, 3157, 7214,  225, 2242,
        8137, 1332, 1408, 6368, 5612, 8978,  633, 8621], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3843, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3775, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3968, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3903, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 242, 3737, 8090, 5061, 7976, 5478, 3157, 2598, 6913, 8833, 6955, 8531,
         554, 6103,  913, 1645, 6237, 1381, 2501, 2583, 8634, 1877, 6354,  842,
        1793, 7972,  531, 2066, 1212,  463,  688, 6658], device='cuda:0')
idx in forward tensor([5171, 7271, 7427,  796, 3639, 8716, 4913, 1856, 3700, 5670, 9000, 8569,
        2446, 6343, 3044, 5459, 1912, 2244, 2548, 5260, 2714, 6757, 5585, 8601,
        4701, 1934, 2591, 7145, 5273, 3160, 7321, 6793], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3923, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3855, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3898, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3826, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8425, 2000, 5187,  611, 1511, 8035, 3400, 8293,  170, 5897,  793, 6563,
        4164, 2909, 4034,  562, 6839, 5095, 3949, 8325, 2346, 6858, 3653, 7999,
        6373, 6654, 2841, 3230, 5481, 1017, 5284, 3429], device='cuda:0')
idx in forward tensor([2953, 1297, 5463, 8731,  964, 9131, 3677, 3163, 7963, 8963, 7841, 8695,
        7312, 3981, 2994, 1813, 2245, 1850, 2777, 5825, 3050, 6239, 5122, 7935,
        3264, 2602, 6906, 3834, 1046, 5406, 1119, 6439], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3853, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3776, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3900, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3837, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7132, 2038, 2066, 4930,  738, 5107,  678, 5029, 6677, 4338, 7845, 3773,
        2886, 5342, 6501, 8354, 2871, 7910, 7867, 4992, 1791, 5179, 3857, 8370,
        8134, 2636, 5977, 6599,  386, 8859, 6462, 1185], device='cuda:1')
idx in forward tensor([ 865, 9120, 8224,  874, 3760,  575, 8417, 3349, 3982, 7295, 6891, 6688,
        3725, 8790, 1324,  745, 8648, 4277, 8297, 3295, 9086, 1008, 8159, 2730,
        4774, 9115,  773, 7832, 7528, 3567, 7659, 8872], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3845, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3764, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3875, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3788, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6110, 1399,  599, 5703, 4486, 3453, 5139, 7175, 2217, 2109, 4521,  413,
        2224, 2794, 1126,  256, 5319, 8418, 8061,  589, 1617, 2609, 7933, 3676,
         125, 7717, 2382, 5398,   45, 5163, 3795, 1517], device='cuda:0')
idx in forward tensor([3583, 5328, 5756, 5895, 3751, 1261, 5150, 7828, 6900, 3407, 5184, 3020,
        6920, 4819, 2189, 7598,  793, 8152, 4532, 1163, 8885, 1652,  704,  864,
        5632, 1024, 5003,  416, 5183, 6093, 7847, 8257], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3929, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3864, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3753, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3656, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4467, 7027, 4194, 5146,  331, 2655, 7950, 2884, 4538, 4332, 1613, 4650,
        3566, 8413, 6068, 5867, 4026, 2488, 6253, 3550,  586, 1881, 8683,  122,
        3689,  340, 2884, 2315, 7740,  611, 1178, 8215], device='cuda:1')
tensor([2881, 1065, 7541, 1280, 2452,  851, 1636, 7385, 8931, 8675, 1890,  428,
        5009, 3757,  294, 3139,  961, 5934, 5442, 4165, 3102,  615, 6021, 2239,
        8645, 1507, 4584, 2571, 3124, 3786,  763, 4976], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3905, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3828, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4024, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3969, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6719,  984,  529, 3018, 4685, 4786, 7603, 7700, 8540, 2960, 2558,  702,
        8952, 2015, 2932, 8078, 1145, 6168, 6039, 2137, 6539,  386, 3531, 4099,
        3392, 4740, 6205, 4009, 1600, 7741,  889, 7032], device='cuda:1')
tensor([1125,  952, 2133,  498, 3383, 8365, 2833, 1176, 7121, 8510, 5093, 5893,
        2735, 2658, 1909, 7412, 3406, 8401, 3057, 4828, 2639, 5302, 6577, 4150,
        7968,   69, 3416, 4443, 7380, 8258, 1309, 4657], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3940, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3872, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3898, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3826, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([5201, 8772, 3136, 5520,  674, 5610, 3311, 6447, 4219, 4300,  431, 8556,
        6394, 4495, 5905, 8149, 6344, 1413, 5383, 5420, 5471, 1737, 8489,   32,
        7400, 7140, 2692, 9075, 7705, 6630, 7904, 1338], device='cuda:0')
idx in forward tensor([3983, 1752, 2934, 9142, 4461,  482, 2531,  879, 2889, 1445, 5634, 4465,
        4720, 7524, 5511,  917, 3311,  729, 1346, 2270, 2565, 5553, 3543, 8974,
        8262, 5976,  203, 5800, 3087, 6119, 8913, 8047], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3877, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3809, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3972, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3905, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6768, 4658, 3742, 6448, 3284, 3443, 1715, 5892, 8739, 9004, 3925, 1037,
        6762, 7793,  800, 4287, 1519, 8555, 5537, 1826, 8128, 2430, 1399, 8408,
        7512, 6304, 2923, 7152, 1102, 5037, 6067, 3038], device='cuda:1')
tensor([1278, 5258, 8964, 1252, 8942, 8181, 5692,   46, 8867, 7648, 7617,  828,
        1328, 2591, 6182, 7308, 7463, 6135, 3993,   94, 3229, 8492, 3698, 5781,
        6321, 3757,  972, 6874, 5938, 1884, 4711, 4127], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3936, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3871, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3880, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3809, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8823, 6986, 8080, 8780, 5461, 2722,  311, 2683, 4708, 4781, 6679, 3390,
        1321, 7650, 5357, 7069, 3245, 8793, 2004, 1247, 7086, 4545, 8726, 4926,
        7402, 2130, 7272, 3707, 4077, 2450, 3291, 3143], device='cuda:0')
idx in forward tensor([1655, 5152, 5837, 7867, 2227,  781, 5280,  689, 6947, 3999, 7471, 7592,
         670, 1162, 6565, 7797, 6459, 4974,  921, 4242, 6771, 9002, 2801, 6146,
         637, 1079, 1854, 4985, 7401, 3066, 8559, 7196], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3898, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3837, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3709, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3611, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([3492, 6827, 3225, 4658, 8438, 7316, 5372, 7659, 6616, 7464, 5216, 7147,
        8858, 7586, 2813, 3728, 1643, 8917, 9076, 7545, 1764, 3576, 4431, 4435,
        4240, 8994, 8507,  106, 7213, 6248, 5092, 1072], device='cuda:1')
idx in forward tensor([6561, 6680, 9043, 3991, 3079, 6134, 6914, 5250, 5596, 2570, 8427, 5071,
        5486, 5451, 6915, 9100, 8655, 3991, 6377, 5887, 8403, 1166, 6353,  696,
        4702, 8812, 1821, 2545, 2941,  797, 7791, 2922], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4031, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3980, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3804, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3726, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2124, 5689, 5050, 8178, 3679, 4154,  779,  879, 9065, 4093, 2024, 3169,
        8509, 7764, 3171, 5817,  371, 2971, 5323, 1828,  762, 6965, 4530, 6196,
         492, 3661, 1096, 2835, 6314, 3447, 7947, 4754], device='cuda:0')
idx in forward tensor([3590, 2351, 1995, 7312, 3899,  718, 6860, 4371, 4265, 5488, 3490, 8910,
        5078, 6406, 3067,  774, 5313, 6883, 5799, 4233, 1879, 2729, 7929, 3047,
        1855, 2416,  547, 7828, 5633, 8468, 5242, 7432], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4065, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4018, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3886, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3809, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7900, 4678, 4832, 7914, 3381, 6617, 8434, 8909, 5475, 5932, 8636, 6606,
        2705, 8652, 7438, 8265, 6320, 6890, 7830, 7573, 3636, 6562, 1171, 2495,
        3850, 5212, 6018, 2548, 1129, 8826, 8345, 6475], device='cuda:0')
tensor([3655, 5217, 4420, 4907, 7872,  246, 9115, 6888, 5791, 6791, 6073, 7130,
        5624,  552, 6140, 6709, 8205, 4575, 4179, 3348,  559, 7903, 7269, 8830,
        7063, 2809, 4466, 6580, 2708, 6609, 8977, 1180], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3982, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3920, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3919, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3852, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6430, 3498, 7816,  499, 3394,  657, 3908, 7009, 6274, 6968, 8398, 3919,
        2614, 7275, 3845, 1714, 3227, 9067, 1461,  329, 4681, 3869, 1805,  448,
        7125, 4704, 2146, 6884, 5906, 8597,  410,  377], device='cuda:0')
idx in forward tensor([5017, 7066, 6866,   47, 4773, 5226, 5186, 4855, 8649, 3268, 7800, 4456,
         821, 2420,  748, 3040, 1538, 5376, 1383, 6938, 5605, 9116, 2344,  998,
        4831, 1974, 2583, 2184, 7397, 6531, 1874, 7021], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3893, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3811, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3893, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3805, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2781, 5500, 2589, 4783, 2689, 5423, 3421, 1473,  982, 1197, 7698, 3117,
        9076, 2110, 1964, 1780, 2167, 3289, 6732, 3801, 2233, 2115, 4503, 4856,
        4552, 1459, 3974, 1628, 6045, 6358, 8095, 5131], device='cuda:1')
idx in forward tensor([1287, 8617, 1006, 3406, 1737, 4892, 5303, 3650, 6449, 3734, 6226, 7728,
        1830, 3505, 3166, 6458,  786, 3376, 6994, 6236, 3350, 4448,  494,  425,
        5456, 4904,  988, 4358,  792, 2964, 1275, 1637], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3867, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3795, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3759, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3676, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([ 730, 6334,  513, 2518, 6030, 6315, 2437, 6657, 2893,  812, 4306, 4506,
         689, 2496,  820,   17, 6404, 1931, 2529, 6620, 5164,  308, 4361, 8943,
        7269, 1323, 3129, 6101, 6732, 7759, 6092, 2222], device='cuda:0')
idx in forward tensor([5990, 3208, 3481, 4820, 7788, 7602, 7030, 1233, 8832, 1748, 6764, 2667,
        7921, 1858,  315, 1067, 7719, 5699, 7712, 5205, 3356, 6505, 1440, 6013,
        7734,  398, 7027, 1398, 1599, 7020, 1515,  886], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3907, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3849, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3838, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3764, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 201, 7943, 1810, 3570, 1993, 7544, 3015, 6837, 7297, 7327, 5463, 6064,
        7205, 3428, 1261, 3056, 9109, 6291, 3461, 2006, 2182, 4080, 3052, 3449,
        8971, 6569, 3041, 5202, 1427, 6830, 7185, 2224], device='cuda:1')
idx in forward tensor([6844, 3396,  689, 6304, 5700, 6086,   63, 8953, 8657, 8974, 5781, 1300,
        6634, 4118,  532, 1011, 6569,  509, 2709, 7736, 7336, 5976,  294, 1529,
        6987, 5452, 5196, 1490, 4772,  126, 6846, 1844], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3794, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3707, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3992, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3934, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6764, 7936, 7102,  218, 8643, 5268, 2866, 1702, 7105, 7535, 6773, 7979,
         955, 6668, 6843, 8195, 7754, 5089, 1137, 5263, 7841,  547,  243, 8616,
        5135, 3796, 3315, 3931,  133, 2214,  406, 5522], device='cuda:0')
idx in forward tensor([8969, 8107, 6770,  921, 5115, 4022, 1827, 2248, 6810,  714,  429, 7029,
        2324,  680, 3941, 5876, 5055, 3818, 2998, 1442, 2007, 8659, 7082, 4850,
        7717, 6142, 6202, 1082, 5713,   60, 2918, 8622], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3891, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3819, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3967, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3910, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6541, 5123,  380, 9154, 1700, 4425, 8217, 4133, 6184, 4715, 2577, 6957,
         166, 6374, 2685, 5712, 6151, 5129, 4350, 8265, 8695, 6014, 4811, 1642,
        1278, 7657, 6805, 8134, 4592, 3810, 7307, 5794], device='cuda:1')
idx in forward tensor([ 312, 1191, 1332, 8196, 8109, 8039,   82, 5345, 3549, 2002, 1598, 2445,
        2932, 2792, 5509, 4606, 5332, 8372, 2814, 2307, 9150, 2516, 2238,  588,
        2340, 3538, 5325, 7068, 5962, 8853, 8450, 7973], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3966, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3898, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3920, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3848, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([3282,  930, 9061, 3773, 6024,   33, 1215, 1286, 8269, 1556, 6954, 6594,
        8018, 2106, 3244, 8886, 8198, 8706, 1415,   51, 3818, 3031, 2908,  523,
        1238, 8886, 5571, 6575, 2877, 4656,  370, 5465], device='cuda:0')
idx in forward tensor([5599,  429, 4968, 2155, 8036, 1905, 8123, 6155, 6517, 8899,  742, 1976,
        8458, 1186, 4398, 7092, 3919, 5950, 1194, 7056, 4609, 6629, 3909, 3435,
        3637,  652, 7870, 2500, 9089, 7558,  407, 6632], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3919, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3844, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3926, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3848, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7828,  452, 3236, 3095, 7817, 2721,   79, 8043, 8227, 7887, 7198,  483,
        4204, 8647, 4672,   32, 3314, 4450, 7920, 7831, 5771,  760, 2969, 6489,
        8418, 3397, 4123, 8346, 2002,  217, 9053, 3106], device='cuda:0')
tensor([8848, 4126, 6228, 8187, 1725,  135, 3842, 2153, 6583, 6119, 5423, 6111,
        3240, 2653, 8849, 2595, 8375, 8998, 1097, 1606, 2116, 5836, 6901, 2170,
        4550, 7733, 3077, 2090, 6253, 6321, 8619, 1211], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3861, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3770, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3894, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3822, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 647, 1099, 5074,  802, 8798, 1573, 8593, 1734, 6440, 1313, 2961, 8398,
        9016, 8768, 7927, 3958, 5062,  766, 4504, 3833, 7921, 2667, 2631, 1892,
        2326, 8403,  496, 2260, 2847,  842, 3024, 8022], device='cuda:0')
tensor([5998, 7007, 1226, 2774, 4480, 5028, 7076,  863, 4860, 2203, 4962, 7972,
        7273, 6372, 2360,  501, 7008, 2898, 2192, 5777, 2815, 5314, 5631, 8432,
         666, 8215, 6083, 3619, 7794,  183,  655, 8111], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4065, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4008, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3958, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3891, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1403, 7551, 4117, 1539, 5224, 8614,  879, 1778, 8729, 3016, 5479, 2283,
        5446, 7116, 1444, 2453, 2908, 1981, 5119,  244, 1720, 4460,  260, 1314,
        4609, 8700, 6926, 5813, 8373, 3532, 4008, 6249], device='cuda:0')
tensor([4529, 6980, 1041, 8808, 8732, 8079, 5222, 9021, 1656,  176,  495, 6315,
        4880, 6964, 4643, 9103, 4696, 4928, 4458, 1919, 8330, 1781, 1651, 5593,
        2616, 4141, 5041,  760, 8316,  618,  211, 6003], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3940, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3869, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4003, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3945, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 761, 1677,  237, 5145, 6176, 3487, 8297,  989, 7479, 1514, 1084, 2445,
         832, 3465, 4010, 3730,  425, 3878, 7018, 4597, 4361, 6022, 7698,  591,
        2784, 4316, 8490, 2454, 3352, 6703, 6795, 3166], device='cuda:1')
tensor([7615, 3104, 5077,  641, 1206, 1722, 4467,  819, 6879, 1758,  184, 1886,
        6439, 2239, 3008,  297, 1150, 8137, 7787, 4699, 5025, 4118, 7572, 2959,
         731,  897, 1234, 3348, 6012, 1782, 6461, 3372], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4072, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4022, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3914, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3842, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8889, 1178, 6842,  859, 3283, 2139, 5815, 6045, 8632, 1549, 7367, 6031,
        8415, 7748, 2812, 2597, 5990, 7058, 6935, 2564, 1345, 7258, 5171, 2293,
        4597, 1377, 3409, 3874, 4744, 7116, 2993, 4156], device='cuda:0')
idx in forward tensor([8595, 8942, 2754, 1631, 8344, 1965, 7580, 7925, 1241, 7695, 6657, 5352,
        1834, 2435, 9132, 1283, 5372, 8759,  849, 2904, 3257,  462, 1844, 8583,
         859, 3706, 5576, 2698, 8483, 6998, 7384, 7759], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4054, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4007, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3730, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3645, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([2177, 6553, 8588, 4686, 7419, 8655, 2019, 3491, 9013, 4977, 4760, 8653,
        4078, 4120, 4970, 7202, 9038,   25, 8816, 8220, 7165, 6851, 1231, 2227,
        8789, 5818, 2809, 3629, 1340,  135, 1242, 4946], device='cuda:0')
idx in forward tensor([8547, 7890, 1702, 7245, 4029, 1496, 7751, 9044, 8021, 4069, 7984, 3526,
        4281, 2733, 8501, 1037, 1351, 7089, 3357, 5652, 8838, 4210, 5251, 1829,
         736, 1861, 7514, 7359, 2158,  480,  144, 3477], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3985, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3921, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3985, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3919, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 905, 1775, 5199, 2746, 6044, 4794, 6390,  488, 8280, 5494, 8785, 4853,
        7995, 2394, 7640, 3596, 6487, 7704, 4957, 5316, 5711, 3694, 2020, 4227,
        5347, 4544, 6929, 8050, 4884, 8294, 6581, 7012], device='cuda:0')
tensor([1792, 6664,   98,  710, 4872,  236,  952, 4460, 4662,  296, 8240, 2557,
        5070, 5981, 2283, 4902, 8218, 7779,  168, 5491, 6459, 2728, 8218, 2283,
        4544, 8286,  532, 7391, 8034, 2318, 1091, 3358], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3992, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3939, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3806, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3707, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2441, 2090, 1887, 3300, 3063, 7813, 6357, 7478, 2923, 5013, 2763, 2126,
        5046, 1478, 8097, 3235, 6070, 9064, 4785,  914, 8750, 3929, 3400, 1745,
        8329, 3090, 8438, 7825, 3554, 1697, 4365, 8233], device='cuda:0')
idx in forward tensor([3567, 6170, 7797, 3926, 4577, 6038, 3657, 3514, 6249, 7950, 5046, 1840,
        7965, 3472, 5662, 2005, 5963, 7915, 7727, 4110, 1584, 8544, 6927, 6667,
        6018, 2570, 1691, 8282, 1807, 6983,  635, 2529], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3821, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3745, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4059, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3996, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7664, 2287, 1854, 7251, 2746, 8122, 1689,   58, 6436,  974, 6491, 6618,
        4048,  743,  133, 6804, 3465, 2102,  691, 4182, 3066,  944,  806, 5652,
        1477, 5240, 4502, 4081, 1555, 7721, 5130, 5409], device='cuda:0')
tensor([5453, 2244, 1054, 1095, 7623, 8840, 5246, 2045, 8756, 7393, 8910, 7081,
         925, 6968, 5603, 7885, 4798, 8787, 7685, 7641, 4757, 4966, 1961, 8543,
        2148, 6253, 6944,  796, 2451, 2114, 4102, 7608], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3916, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3850, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3739, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3645, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2851, 5024, 8410, 4861, 6263, 1819,  372, 4515, 3409, 2240, 6845, 8962,
        8828, 7647, 8016, 1459, 5487, 5237, 6965, 2081, 7022, 6537, 7740, 5367,
         270, 1848,  230, 1314, 2019, 6155,  114, 4567], device='cuda:0')
tensor([3213, 8459, 1695, 2272, 5101, 6903, 9062, 5795, 8429, 3832, 4002, 1437,
        2169, 3972,  720, 3205, 6803, 1968, 5392, 2212, 4839, 1389, 3603, 1914,
        6600, 1513, 6758, 5067,   39, 1003, 4987, 8070], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3927, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3860, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3861, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3780, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8798, 4967, 4653, 5332, 7835,  604, 4529,    2, 5929, 3190,  417, 2071,
         228, 8903, 6917, 3914, 2502, 2883, 2953, 3127, 4537, 8406, 3865, 8081,
        1701, 2461, 2193, 1212, 7000, 4115, 6454, 7005], device='cuda:0')
idx in forward tensor([5640, 2111, 1685, 3173, 7671, 4960,  258,  210, 9141, 1358, 2517, 3165,
         224, 4935, 9151,  660, 6849,  247, 8798, 7057,  562, 4082, 2599, 6276,
        5116, 7509, 8895, 8600, 5059, 7500, 1896,  810], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4021, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3968, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3898, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3816, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1826,  189, 1644, 2352, 4416, 5308,  339, 1437, 5216, 3477, 2837, 3158,
        8156, 6113, 5959, 5114, 6658, 6566, 2198, 3049, 4953, 7816, 5461, 5144,
         270, 1929, 1799, 8199, 3490, 8337, 7454,  978], device='cuda:0')
tensor([7992, 5227, 6417, 4099, 5744, 3770, 4686, 7724, 7893, 6828, 4782, 8790,
        8374, 8236,  576, 7204, 5930, 4021, 1841,  536, 2491, 4144, 5252,  285,
        7014, 3873, 2785, 4209, 1277, 5868, 6134, 6486], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3747, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3650, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3940, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3878, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1508, 5653, 2805, 4303, 1184,  120, 5792, 4524, 9060, 1418, 8614, 7876,
        7120,    6, 4514, 6154, 4703, 8572, 5480, 8370, 4474, 5018, 4692, 1732,
        4197, 2106, 5023, 3029, 7667, 7601, 6399, 4389], device='cuda:0')
tensor([8663, 2440, 1590, 7094,  792,  580, 6985, 4763, 8311, 5725, 4802, 4098,
        5426, 7313, 7056, 3258,  938,  131, 3824,  592, 9092, 5243, 1530, 8048,
        9054, 2115,  382, 8804, 5253, 1933, 4637, 5223], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4042, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3989, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4032, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3978, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([1209, 5968, 3196,   35,  499, 7866, 4677, 5097, 3645, 8780, 8705, 6417,
        4402, 6556,  287, 3482, 6892, 2101, 3976, 8342, 4387, 3363, 1361, 1320,
        3374, 5350, 5441, 7404, 5650, 6165, 1190, 4994], device='cuda:0')
idx in forward tensor([ 660, 6702, 7961, 1218, 8015, 8351, 2550, 3961, 3101, 3722, 2465, 5953,
        1534, 1380,  532, 5764, 8416, 7859, 3327, 2092, 4253, 6714, 7615, 6909,
        6741, 3153, 6798, 6411, 1693, 8131, 9122, 6547], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3944, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3885, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3841, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3752, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8515, 1414, 8274, 6876, 8484, 4907, 8767, 2239, 4144, 4363, 5422, 3920,
        6976, 2222, 9085, 2382, 4709, 2701, 8375, 5489, 4828, 4947, 2741, 5411,
        2811, 3534,  231, 1702, 5189, 6827, 5869, 6274], device='cuda:1')
idx in forward tensor([5202, 4675, 4789, 5496, 5135, 5508, 6215, 4464, 5851, 5380, 6257, 2664,
        1755,  124, 1075, 1293, 3878, 3777, 4130, 5886, 3088, 6256, 7357, 7217,
        5641,  360, 4759,  785, 3847, 4433, 8100, 4723], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3923, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3859, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3998, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3942, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4486, 4068, 6150, 4282, 2626,  363, 1988, 3610,  619, 1547, 8213, 5649,
        1594, 4520, 8717, 4377, 8863, 3754, 5110, 5390, 6939, 7351, 1503, 7043,
        4053, 5762, 5611, 4482, 5158, 9040, 3231, 2004], device='cuda:0')
idx in forward tensor([3157, 7807, 5672, 1907, 9025, 3187, 2840, 4016, 8138, 3223, 3749, 1678,
        1324, 1946,  190, 6364, 3939, 3042, 8803, 5463, 7729, 4184, 8214, 4979,
          68,  752, 4886, 3048, 3899, 2315, 1524, 6525], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3881, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3809, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3885, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3798, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7143,  401,    2, 5840,  783, 5302, 2232, 5776,  823, 3582, 5409, 5011,
        7444, 9034, 6145, 5295, 3255,  281,  107, 5592, 7241, 2525, 4931, 6751,
        8848, 3411,   50, 6161, 3483, 8446, 2068, 6649], device='cuda:0')
tensor([8718, 7195, 4702, 2491, 7919, 4203, 7896, 3532, 1424, 1208,  206, 7201,
        3529, 4516, 3792, 5631, 7567, 1767, 2221,  151, 2299, 5325, 3170, 8330,
        7991, 1312, 8581, 5396, 1283, 8655, 8809, 2518], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3970, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3910, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3816, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3739, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([  16, 8087, 4617, 5926, 8138, 6464, 9064, 2699, 2168,  722, 9137, 4555,
        1236, 8732, 8720, 6925, 8869, 5493, 2065, 6919, 4249, 5245, 7773, 5278,
        4399, 5106, 7035,  391, 1681, 2333, 3419, 7727], device='cuda:0')
tensor([8639, 2767, 1738, 2650, 7237, 5028, 5189,  170,  901, 5027, 6757, 7386,
        1646, 2242, 3254, 4752, 5637,  395, 3382, 3195, 6718, 3104, 5338, 8266,
        7242, 4904, 5918, 9030, 8292, 8522, 8787, 1196], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3931, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3863, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3900, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3821, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([5096, 9120, 6745, 6993, 3187, 5763, 3657,  513, 1325, 6679, 7363, 5716,
        1462, 6705, 8012, 8956,  776,  726, 8151, 5932, 1432, 7069, 6211, 3300,
        3439, 8698, 4200,  453, 5939, 1630, 1074, 1411], device='cuda:1')
idx in forward tensor([9100, 1070, 8456,  416, 8010,  898, 2188, 8030, 1299, 5348,  318, 3932,
         946, 2514, 5525, 4963, 8431, 3183, 7641, 5272, 4539, 7882, 1577,  182,
        4135, 3533, 8098, 3251, 4947, 7247, 1620, 3774], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])

loss_i2t_ori in get_contrastive_loss tensor(3.3751, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3656, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3898, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3825, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4179, 2313,  268, 2499, 1995, 2196, 2574, 3816, 4500, 1168, 2165, 7018,
        6273, 1552, 5472, 7953, 6510, 7104, 1543, 4864, 8657, 8444, 8944,  786,
        5878, 2806, 4139, 2869, 8640, 1008, 6444, 6187], device='cuda:0')
idx in forward tensor([5453, 6850, 1418, 2178, 1336, 8933, 5122,  110, 3662,  454, 1804, 5310,
        7381, 1701,  413, 5086, 2064, 3940, 2249, 2277, 8946, 4941, 8677, 7446,
        5885, 6672, 5746, 3476, 3339, 3962, 8988, 8130], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3966, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3897, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3975, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3916, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8600, 2901, 2805, 4534, 4015, 2335, 8890, 7507, 4029, 7425, 4911, 5403,
        5731, 4487, 1412, 8525, 6458, 4320, 2921, 1632, 7550, 7743, 7819, 5789,
        1431, 4037, 4277, 5065, 8405, 8456, 5797, 8674], device='cuda:0')
tensor([8838, 4295, 1340, 5678, 8552, 7122, 6830,  523,  594, 5004, 7602, 1224,
        7266, 2870, 6653, 3338, 3372, 1871, 6440, 3203, 6985, 8227, 6080, 5846,
        2906, 2083, 6679, 3207, 5927, 5926, 2983, 5235], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3879, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3794, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4063, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4008, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1654, 1203, 7996,  321, 8572, 6508, 2573, 3135,  441,  747,  932, 4138,
         861, 1924, 1477, 3832,  700, 8749, 1770, 2058, 4350, 4052, 8354,  281,
        5470, 4262, 3932,  411,  833, 2322, 4726, 8735], device='cuda:0')
tensor([8664, 7333, 3123, 4852, 6210,  152, 6624, 5152, 1391, 7086, 5484, 7524,
        3773, 3547, 4100, 7392, 6872, 1217, 6563, 2472, 1954, 8452, 3084, 2190,
         398, 7974, 7378, 3363, 8133, 4343, 2561, 4205], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3767, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3667, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3830, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3742, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 433, 3134, 3191,  789, 5687, 1506, 4710, 8622, 8477, 7716, 6208, 1057,
        6047, 3013, 5389, 6561, 6769, 5810,  336, 8085,  999, 8141, 9070, 6217,
        7633, 6720, 8225, 1479, 5236, 8192, 2880, 7052], device='cuda:0')
tensor([4935, 1733, 5742, 5035, 8060, 7768,  686, 8076,  843, 6697,  706, 3238,
        7952, 4334, 1857,  420, 3880, 5595, 7849, 3961, 8157, 8788, 3442, 2090,
        4398, 2518, 7216, 1956,  245, 2382,  176, 6467], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3879, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3799, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3928, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3852, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5067, 4228, 5936,  289, 1651, 5714, 6266, 8747, 6006, 3111, 6008, 1940,
        6287, 7023, 3024, 3489, 7037, 4442, 5144, 6718, 5908, 5152, 6394, 5594,
        4897, 4803, 6263, 3296, 5904, 6220, 7589, 1206], device='cuda:0')
tensor([5735, 6104, 7207, 8266, 3237, 4590, 4201, 8733, 5682,  515, 6829, 2990,
        5099, 5640, 7959, 6944, 3099, 6974, 4603, 4928,  317, 9134, 2509, 5496,
        1468, 8685, 6264, 2675, 4060, 1086, 7101, 5028], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3957, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3713, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3620, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3893, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3532, 6367,  383, 2622, 1929, 2921, 6960, 2292, 4163, 6931, 5018, 2226,
        4613, 6142, 1907, 5809, 8455, 2978, 6959, 4147, 4427, 3717, 6866, 8082,
        1765, 7693, 5473, 2745, 7419, 8224, 4347, 1338], device='cuda:0')
tensor([5291, 5389, 8220, 2410,  862,  586, 7578, 5883,  819, 1928, 8235, 7072,
        2597, 7936,  508, 2035, 4652,  534, 7567, 3868, 8232, 5189, 7948, 2256,
        1823, 7391, 5875, 3912, 2618, 1967, 1224, 4207], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3948, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3877, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3889, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3810, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2066, 3231, 1215, 3275, 8880, 2971,   80, 8894, 2498, 3774, 8517, 7888,
        1692, 4276, 3248, 3348, 2981, 3805, 3735, 8423,  732, 3412, 6457, 6093,
        5014, 8970, 6412, 7395, 3071, 4163, 5206, 6285], device='cuda:0')
tensor([3456, 6826,  421, 4000, 4598, 6728,  504, 4891, 1537, 4299,  667, 6035,
        1053, 2430, 8443, 7356, 3348, 1895, 1352,  178,  427, 5577, 1631, 5284,
        4213, 2679, 8607, 1818, 4301, 4346, 5119, 6292], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3964, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3909, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4058, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3999, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2857, 3346, 4487, 1298,  318,  963, 8781,  503, 5936, 9108, 2453, 6878,
        4357,  191, 7529,  424, 2547, 7411, 6810, 4682, 4020, 4087,  419, 8199,
        8254, 7817, 4792, 5937, 2172, 2484, 8428, 9096], device='cuda:0')
tensor([9082, 4159,  634, 6928, 7651, 6638, 3297, 4261, 5615, 7651, 2381, 1938,
        3196, 6950, 8283, 8758, 8345, 7879, 7442, 4959,   57, 6864, 8126, 7229,
        7645,  200, 5764,  249, 3280, 4208, 1266, 4239], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3879, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3809, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3953, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3884, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 848, 4654, 4172, 1796, 5160, 8157, 7908, 7149, 5161, 4269, 5460, 1714,
        3930, 5469, 6726, 3493, 4464, 6643,  520, 2654, 3691,  417, 3950, 3944,
        8667, 4147, 6875,  623, 6787, 1078, 8458, 1828], device='cuda:0')
tensor([7149, 7628,  421, 6076,  705, 3677,  181, 8646, 4943, 1384, 4634, 3099,
        3307,  925, 8461, 4185, 4775, 2838, 7656, 2417, 7675, 3136, 6648, 4106,
        8095, 4169, 6162, 5008,  881, 5985, 9003, 1985], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3898, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3819, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3951, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3900, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 229, 1760, 8025, 6741, 1187, 5857, 4536,  430, 4194, 6568, 4629, 2801,
        7424, 6778, 2071, 1595, 8973, 4870, 1071, 4046, 5945,  826, 7254, 2099,
        5118, 8437,  427, 6230, 3037, 8005, 2387, 8207], device='cuda:0')
tensor([2182, 3379, 6340, 4588, 1176, 5004, 1998, 4847, 5562, 1067, 6430, 7964,
        3602, 5411, 7185, 1331, 6326, 8166, 7077, 3249, 3028, 3823, 4905, 1205,
        6010, 1163, 3702, 6428, 6774, 5195, 6110, 3516], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3850, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3767, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3838, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3758, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4299, 2943, 4413, 5881, 2450, 1779, 1148, 6286,  759,  762, 3245, 5465,
        5342,  120, 1966, 1639, 5514, 7430, 3571, 6490, 5690, 1735, 8930, 2172,
        1811, 6604, 5572, 5361, 7621, 1269, 1228, 3888], device='cuda:0')
idx in forward tensor([ 290,   60, 9119, 6628, 1150, 5773, 4345,  190, 2075, 4633, 4769, 6216,
        8018, 4753, 2205, 6982, 5740, 4972, 1495,  501, 8666,  751, 2095, 5911,
        1525, 6061, 2481, 7650, 8722, 7785, 3008, 1187], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3937, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3914, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3829, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3873, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([ 378, 7232, 3794, 7841, 6419,  203, 3164, 8941, 1340, 1957, 5679, 6777,
        2944, 6651, 4651, 8949, 8908, 2417, 6438, 2292, 2966, 4728, 6457, 5017,
        4406, 7486, 6381, 5847, 8767,   93, 2995, 6188], device='cuda:0')
idx in forward tensor([ 641, 2663, 8180, 7952, 3660, 7341, 2531, 4220, 5969, 2021, 4288, 2351,
        4571, 3455, 6476, 4867, 2630, 2466, 2653, 2760, 3384, 6231, 5492, 5960,
        4571, 1024, 4925, 5416, 1183, 4237, 8339, 8352], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3831, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3755, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4104, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4047, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5314, 1404, 5729, 8690, 9057, 6593, 8557, 3166, 6847, 5441, 2896, 1583,
        5814, 3629,  986, 7334, 6167, 4745, 3079, 5583,  955, 2870, 6894, 8295,
        8378, 7795, 5693,  717, 7923, 4585, 4229, 1754], device='cuda:0')
idx in forward tensor([1385, 6870, 3772, 2929, 6624, 6788, 5862, 5631, 4638, 1047,  322, 1686,
        2649, 7136, 6473,  209, 1169,  644, 6018,  243, 3435,  856, 6643, 2329,
        1760, 7267, 2364,   50, 7786, 1618, 2890, 4377], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4011, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3946, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3921, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3837, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1910, 2324, 6763, 3967, 5806, 4288, 1936, 2725, 1273, 3266, 6481,  585,
        9045, 1175, 1114, 1363, 1955, 5735, 5280, 6803, 8240,  609, 7674, 3820,
        6054, 5522, 6361,  412, 7619, 4425, 1865, 5856], device='cuda:0')
tensor([7479,  835, 5954, 5765, 1161, 2640, 7287, 3840, 8590, 1832, 7922, 8467,
        8794, 3048, 3084, 4286, 5689, 1125, 1424, 7348, 5462, 1102, 1777, 3077,
        5582, 5771, 6103, 5515, 1567, 3270,  697, 8212], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3981, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3922, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3932, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3866, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([ 670, 2366, 3656, 8523, 2821, 8343, 5498, 7243, 4867, 3418, 2135, 1607,
        5709, 7650, 2929, 5587, 3116, 3817, 1596, 8946, 5544, 6634, 5662, 1353,
        7259, 5849, 1160,  431, 5211, 5414, 3762, 7945], device='cuda:0')
idx in forward tensor([7774, 8020, 1638, 5917,  827, 1543, 2236, 5556, 2405, 8974, 6732, 1405,
         911, 2458, 2979, 8247, 4657, 2238, 5747, 6806, 6684, 8897, 2852, 5606,
        3380, 5279,  746, 5249, 5161, 4555, 1021, 1676], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4126, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4075, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3929, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3859, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8574, 8383, 2323, 6962, 1278,   22, 7165, 6652, 1722, 4342, 1797, 8124,
         654, 8023, 4238,  410, 7714, 7767, 6992, 3900, 5138, 8045, 2980, 5117,
        3247,  878, 9091, 8957, 3470, 7710, 3651, 9019], device='cuda:0')
tensor([7860, 6791, 4840, 8154,  651,  850, 3179, 8356,  893,  994, 2152, 5600,
        1712, 7581,  600, 2910, 8788, 8303, 4793, 9133, 6738, 3053, 1351, 2708,
        5847, 5836, 4143, 1139, 3202, 6907, 5993, 5260], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4018, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3950, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4070, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4018, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([3868, 1395, 5045, 8588, 5956, 7287, 3974,  435, 1635, 7140, 5536, 6579,
        4616, 7794, 2647, 4156, 2337,  507, 3669, 3781, 1754, 3990, 1963, 8779,
        8841, 7080, 1695, 5004, 2532, 6689,  812, 7420], device='cuda:0')
idx in forward tensor([2241, 3536, 2804, 5396, 1106, 3277, 3351, 4231, 8733, 6343, 5588,  949,
        3060, 1431, 8062, 8673, 6984, 1636, 8967, 5358, 2963, 4449, 2162, 2326,
        2812, 3721, 3388, 3325,    5, 3448, 8063, 4444], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4028, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3968, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3850, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3768, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([ 328, 2964,  797, 4373, 5370, 8795, 5131, 6921,   64, 4721, 5665, 7869,
        2028, 7766, 2351, 5256, 5047, 4652, 5964, 7007, 4494,  717, 3725,  612,
        1189, 6753, 7932, 3559, 2653, 8577, 5128, 2853], device='cuda:0')
idx in forward tensor([8435, 4993, 1438,  969, 7768, 6306, 2983, 6523, 3119,  453,  700, 2737,
        8386, 3364, 5016,  324, 3610, 1336, 5054, 6958, 8927, 3219, 5249, 8253,
        1134, 6879, 6224,  548, 5380, 1096, 5872, 7976], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3996, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.4037, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3980, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3926, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4149, 4295, 1719, 6765, 4396, 1951, 7574, 1646, 2744, 3410, 6921, 5002,
        4942, 5721, 1409, 7151, 8731, 2988, 6410, 3311, 5498, 6731, 1364, 5473,
        1579, 2961, 4168, 8197, 6537, 7851, 1373, 1327], device='cuda:0')
tensor([1116,  738, 5862, 4975, 5627, 4742, 6720,  214,  876, 4683, 4582, 4927,
        3053, 8671, 8311, 5334, 7500, 8550, 4894, 2141, 5116, 5369, 7989, 2685,
        4729, 4665, 1232, 7122, 5454, 4577, 4560, 8423], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4035, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3986, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3970, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3904, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4470, 7673, 8038,  162, 8902, 6318, 3317, 4158, 4284,  155, 5254, 3080,
        3218, 4793, 7486, 1755, 3980, 7239, 3093, 4621, 3224, 6114, 7817,  663,
          79, 6011, 8305, 6352, 9004, 4819, 3023, 5287], device='cuda:0')
idx in forward tensor([7792, 9097, 6424, 3618, 2125, 3911, 5284, 7838, 4905, 2931, 8431, 2368,
        5335, 1868,  926, 7946, 6559,  314, 3182, 7311, 7491, 2733,  706, 2867,
        1609, 3272, 4745, 7372, 2340, 3428, 7801,   78], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3969, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3897, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4036, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3982, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4279, 1234, 9024, 5754, 2210,  566, 6258, 7011, 3315, 5093, 1560, 3614,
        3381, 8895, 5066, 4018, 4794,  529, 8495, 1905, 1255, 2395, 2125, 6808,
        7250, 8859, 4003, 7394, 7744, 6897,  924,  480], device='cuda:0')
tensor([8384, 2147, 1684, 8061, 4527, 4590, 2627,  314, 7303, 1233, 8104, 7406,
        5661,  322, 1935,  920,  942, 6530, 2934, 2031, 3616, 4834, 2232, 1403,
        2657,  410, 2388,  411, 7063, 8110, 2388, 7456], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3753, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3661, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4024, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3964, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 734, 6948, 3489,  960, 4885, 8523, 9043, 6325, 2466,   47, 3463, 9005,
        6102, 2046, 2141, 5315, 4648, 1085, 8368,  248, 2588, 1976, 1169, 6908,
        2474,   84, 5853, 6266, 4469, 5074, 4576, 7235], device='cuda:0')
idx in forward tensor([ 254, 1410, 7057, 5102, 7853, 6939, 4440,    0, 2036,    7, 7340, 7177,
        6291, 7390, 8313, 8265, 3625, 8650, 4260, 5376, 2455,  845,  711, 5388,
        4136, 6769, 5022, 5914, 6040, 5479, 2982, 5126], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3944, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3877, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4054, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3987, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8432, 9069, 4351, 8871, 7592, 1623, 6517, 6946, 7093, 7410, 1496, 3349,
         316, 4584,  462, 8756, 2772, 8599,  546, 4682,  278, 5722, 8726, 1079,
        8104, 3584, 8105, 8476, 7673,  976, 9039, 7004], device='cuda:0')
tensor([2041, 8351, 4167, 2843, 3217, 4940, 7653, 2087, 1337, 4425, 6725, 5870,
        8537, 2717, 6600, 8933, 4747, 2917,  760, 1356,  501, 1127, 6836, 6103,
         481,  531, 7493, 6096, 1500, 8576, 5907,  121], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3907, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3843, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4033, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3980, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([5287, 1301, 4463,  991, 2335, 1141, 4593, 8113, 8065, 6403, 7581,   45,
        7123, 1766, 5324, 1795, 4279, 9125, 1097, 5060, 5286, 6796, 2612, 5016,
        6382, 5231, 4647, 3887, 8234, 2017, 3910, 1524], device='cuda:0')
idx in forward tensor([6673, 5802, 8770, 3818, 6519, 4018, 1796, 5357, 9106, 9063, 8783, 3712,
        6636, 4518,   19,  846, 7091, 2511, 7369, 4755, 6003, 5310, 7861, 4720,
        2344, 8564, 8670, 2775, 5507, 2075, 1703, 8005], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3947, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3882, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3849, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3765, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 688, 6712, 4267,  618,  764, 3451, 4704, 8519, 9122, 1391, 8388, 8098,
        6257, 8801, 7622, 5877, 9072, 7013, 1420, 1892, 1869, 2439, 8931,   94,
        4900, 7834, 4804, 5523, 2080, 1798, 7570, 3555], device='cuda:1')
tensor([4297, 7049, 6445, 2480, 3946, 6238, 8400, 7959, 3613, 2675, 6136, 4588,
        7472, 2353, 3420, 5167, 7011, 6378, 3268, 3180, 8152,   48, 2584,  117,
        3455, 6836, 5436, 8057, 1289, 3759, 1573,  974], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3977, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3910, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3978, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3926, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2738, 6345, 7895, 4709,   55, 7930, 6546, 1999,  781, 3876, 1408, 4096,
        5982, 2111, 1286, 1372, 3229, 1604,  777, 8394, 1852, 7420, 6848, 4844,
        7153, 6833,  355, 1250, 5942, 1532, 8111, 2710], device='cuda:0')
tensor([9003, 7827, 6861, 3141, 7004, 2358, 5402, 7974, 4769, 5265, 7206, 4801,
        7364, 1479, 5480, 8533,  138, 4236, 2310, 4352, 2576,  418, 2053, 4004,
        4076,  581, 3183, 4684, 3719, 5404, 8454, 8541], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4038, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3978, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3943, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3867, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6802, 1402, 2083, 4540, 1272, 8028, 2910, 3075, 5882, 8571, 5895, 8988,
        5157,  231, 8392, 4736, 7177, 8853, 2930,  867, 3604, 1070, 1292, 8363,
        8788, 2563, 4566, 7604, 8744,  303, 8967,  854], device='cuda:0')
idx in forward tensor([2997, 1101,  320, 1441, 5244, 1321, 5726, 1329, 3856, 4916, 4118, 4357,
        6696, 6736, 9047, 3431, 1815, 4078,  266, 7530, 8281, 4967, 7578, 7355,
        6633, 4513, 2936, 5554, 1174,  857, 7944, 3695], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3826, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3734, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3829, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3748, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([2962, 6541, 1397, 2311, 6034, 5779, 3878, 7651, 8906, 8229, 2328, 5541,
        1098, 7726, 7740, 1055, 3301, 8627, 5240, 8199,  877, 8298, 5273, 6524,
        3883,  567, 5499, 6555, 7279,   66, 2497, 7594], device='cuda:1')
idx in forward tensor([ 246, 5418, 5805, 3838, 4365, 1833, 2849, 1612, 1375, 8248, 4795, 7180,
        4283, 6408, 4294, 1284, 3505, 6326, 6766, 5283, 2373, 2915, 8262, 5170,
        2555, 6332, 3471, 3302, 2121, 7100, 4702, 7409], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3796, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3700, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3834, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3738, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6088, 3241, 4013, 3154, 2709,  548, 8705, 7624, 4478, 9058, 7163, 6353,
        2635, 7971, 8527, 6033, 1572, 5948, 2520, 4200, 4386, 1201, 2122, 1756,
         718, 6105, 1822, 2183, 6717, 1922, 6295, 2185], device='cuda:0')
idx in forward tensor([8720, 7389,  792, 2917, 8179, 4797, 7044,  744,  122, 5399, 5760,  508,
         727, 3369, 2487, 8412, 5794, 3238, 3015, 2398, 3090, 6691, 1406, 4953,
        3138, 2249, 2052,  219,  809, 8320, 7440, 1717], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3919, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3848, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3940, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3860, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8120, 2533, 6043, 6224, 4440, 8354,  550, 1831,  587, 8975, 1789, 3206,
        5029, 5428, 7577, 3106, 4060, 1060, 6969, 8536, 5903, 2677, 1780, 4046,
        5030, 8631, 1204, 7044, 8245, 4079, 8446, 1934], device='cuda:0')
idx in forward tensor([5975, 4164, 5263,  520, 6209,  708, 8249, 1083, 8692, 2190, 6457, 1092,
        1248, 8196, 5202, 7848, 6990, 2331, 7857, 5855, 6491,  323, 8430,  749,
        8166, 2010, 7085, 4551, 5157, 4766, 7852, 7296], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3855, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3768, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3944, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3870, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3624, 3182,  312, 5435, 6859, 3599, 9145, 8119, 3173, 4948, 5292, 7888,
        5501,  247, 2142, 4480, 5778, 7864, 3042, 4795, 1374, 8827, 7120, 4004,
        2404, 7915, 5853, 4235, 2830, 4678, 4475, 3445], device='cuda:0')
tensor([1410, 7781, 2985, 3556, 2586, 2166, 5183, 8077, 1540, 1851, 1713, 1324,
        2357, 1515, 7750, 8698, 4677, 8385, 2096, 2916, 5661, 2138,  775, 3077,
        2833,  187, 2702, 2182, 3487, 7840,  162, 8710], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3920, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3845, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3835, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3755, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7703, 6013, 1120, 8775, 4548, 3626, 5915, 3860,  282, 4038, 3556,   63,
        8666, 5824, 7328, 4742, 2692, 3604, 5902, 8408, 2623, 3560, 6862, 4622,
        4185, 5040, 7471, 3526, 1960, 3714, 1987, 8660], device='cuda:0')
tensor([4087, 7201, 2483, 4287,  977, 8594, 3089, 7548, 4403, 7975, 2247, 2610,
        4549, 4420, 5000, 3442, 6698, 8132,  275, 3542,  623, 8193, 6756, 4111,
         592, 6174, 5658, 3720, 8558, 7067, 5658, 1911], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4035, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3972, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3947, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3877, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7470, 5651, 7446, 8172, 5949, 2962, 1004,  553, 5188, 2406,  263, 5718,
        7263, 5510, 3415, 8519, 4065,  576,  974, 3745, 4644, 4331, 2104,  154,
        8838, 2285, 4563, 4493, 5246, 7186, 8261, 7598], device='cuda:0')
tensor([  33, 6504, 1661, 7033, 1027, 2290, 3949, 5654, 1057,  274, 9148, 4982,
        1165,  101, 1323, 2095, 5535, 2803, 7424, 3720, 2187, 6583, 3178, 8515,
        5657, 4284, 3608, 6157, 2330, 4644, 8730, 4297], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3909, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3839, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3807, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3731, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2822, 9123, 3537, 2085, 8073, 6530, 7124, 6017,  531, 2001, 1904, 8817,
        4115, 4875, 6814, 7624, 7583, 2275, 7965,   11, 3895,  284, 1045, 1749,
        4092, 2571, 6723, 4532, 8207, 9101, 3762, 8412], device='cuda:1')
tensor([6857, 3148, 2905, 8170, 1890, 5070, 6631, 6296, 5465, 8925, 8524, 2658,
         677, 7676, 3571,  550, 7004, 5844,  630, 3744, 8462, 1118, 5086, 7956,
        2975, 5123, 8037, 2374, 8086, 8550, 5195, 2940], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3910, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3837, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3935, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3873, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2039,  333, 8656, 8471, 8157, 3513, 6266,  691,  863, 6490, 6126, 4417,
         440, 6716, 7477, 2150, 3275, 2600, 8834, 8948, 2196, 5792, 7172, 4425,
        1711, 7352, 6360, 6820, 2353, 1492, 7591, 7734], device='cuda:0')
idx in forward tensor([2295, 3545, 4094,  378, 6328, 1689, 6777, 4076, 5393, 6726, 4333, 4381,
        5239, 8667, 3101,  785,  827, 8305, 2997, 3380, 1743, 4258, 4381, 7626,
        4813, 5305, 3844, 2621, 3058, 7885, 8557,  387], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3914, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3836, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3792, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3701, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4405, 2262, 5262, 6008, 3644, 2416, 1050, 3823,  208, 8700,  403, 7131,
        5655, 3265, 3175, 6668, 5146, 1384, 3836, 2214, 8230,  903, 5148, 7707,
        7588, 5669, 8925, 5189, 1390, 3805, 3779, 5466], device='cuda:0')
tensor([6611, 3983, 5524,  842,    6, 4006, 1572, 3387, 6949, 8251, 3146, 6533,
        5296, 1966, 9102, 8585, 7929, 3853, 2187, 4023, 5052, 3852, 8428, 9027,
        7706, 4668, 4445, 2037, 1948,  538, 5555, 6364], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3905, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3823, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4012, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3944, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5226, 1090,    1, 1064, 7081, 2208, 3216, 2946, 7785, 2039, 2073,  104,
        3375, 6702, 1638, 4874, 5629, 8864, 7616, 5172, 2367, 3078, 3638,  198,
        4005, 3535, 1169,  118, 2267, 8844, 3294,  749], device='cuda:0')
idx in forward tensor([4302, 6121, 4580, 3998, 1782, 5398, 2123, 3608, 7805, 4665, 6317, 8891,
        1066, 6659, 6597, 2490, 5984, 4832, 3376, 2823,  299, 7473, 6345, 3270,
        3215, 8981, 3756, 1824, 6636, 2883, 5234, 1783], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3897, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3811, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3948, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3879, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7687, 2557, 6528, 5777,  992, 8246, 2690, 6802, 1204, 6129, 4318, 2043,
        4457, 3038, 5401, 6321, 6570, 5435, 8565, 7559, 3672, 3181, 2430, 5447,
        5614, 6424, 7070, 3485, 8856, 1865, 2930, 8053], device='cuda:0')
tensor([5743, 2392, 6934, 1044, 8760,  925, 6097, 5900, 2566, 3382, 8136, 5869,
        5520, 5562, 4453, 6125, 4573,  301, 5572, 1619, 1995, 7197, 4511, 6026,
        8613, 2156, 7243, 5471, 1754, 2140, 3691, 3977], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3893, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3822, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3895, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3826, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([2181, 6389, 1252,  289, 4432, 6334, 6472, 1866, 8525, 6433, 4921, 7055,
         699, 3130,  462, 8669, 3565, 5850, 2873, 1326, 3278,  226, 8641, 8267,
        2984, 1422, 2505, 4863, 7639, 8894, 4567, 2395], device='cuda:1')
idx in forward tensor([6322,  369, 2712, 1463, 4059, 2753, 8169, 2612, 3232, 4419, 9092, 2451,
        7404,  614, 2430, 3907, 6857,   82, 7191, 3074, 1152,  412, 6017, 3808,
        8042, 6737, 7823, 1349, 1175, 3335, 6585, 8992], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3855, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3781, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4045, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3994, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6911, 8887, 3662, 2095, 5945, 4473, 8348, 8257, 1574, 6841, 5360, 2384,
        4734, 1696, 3590, 6671,  574, 5341, 4091, 1986, 4126, 1315, 8556,  415,
        7743, 2245, 7021, 3678, 5176, 7058, 8460, 6623], device='cuda:0')
tensor([3891, 4258, 5238, 2611, 8606, 1061, 4339, 6556, 4193, 2555,   41, 7258,
        8183, 2987,  869, 3162, 6350, 3263, 3754, 7799, 5720, 4937, 1141, 5962,
         308, 3785, 5066, 6730, 8263, 6895, 4383, 4301], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3792, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3705, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3882, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3801, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([ 980, 2464, 6192, 6722, 7898,  808, 4636, 7333, 1453, 8469, 1531, 6644,
         620, 3433, 6449, 7281, 2296, 7114, 3289,  499, 6921, 2367, 1833, 4962,
        2240, 7388, 6420, 6511, 5006, 3016, 4040, 6044], device='cuda:1')
idx in forward tensor([6584, 4287, 2533, 3586,  608, 4280, 6709, 6762, 1219,  966, 6976,   14,
        4775, 7749, 7553, 1932, 1033, 4809,  884,  437, 6153, 7145, 7427, 1058,
        7965,  923, 2047, 8929, 8580, 7761, 3064, 3468], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3857, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3777, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3874, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3803, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7741, 8240, 5747, 1310,  268, 6959, 4391, 4265, 5925,  672, 1425, 1334,
        8191, 6175, 5677, 4949, 6691, 4785, 9073,  548, 2191, 6896,  871, 3993,
        2908,  348, 6741,  734, 2843, 3343, 5407, 8263], device='cuda:0')
tensor([6391,  955, 1404, 5765,  408, 6086, 1393, 7146, 7544,  978, 1392, 5672,
        1899, 3597, 5562, 8860, 9061,  686, 5339, 3744, 8641, 4694, 8646, 5180,
        1056, 8158, 3373, 3004, 2134, 8143,  133,  696], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3719, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3621, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3906, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3839, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([ 572, 8134, 7305, 9099, 8136, 1753, 6861, 6987, 1690, 3745, 3918, 6233,
        2206, 6618, 2540, 1461, 1634, 6812, 4992,  513, 8530, 1706, 1451, 6240,
        4406,  661, 3359, 1401, 5356, 8267, 4811, 4182], device='cuda:0')
idx in forward tensor([2713, 4421, 1415,  131, 2097, 1270, 1652, 3054, 2213, 6053, 4554, 3278,
        2031, 4679, 7662, 3141, 7614,  690, 6516, 7315, 7346, 4270, 3020, 4642,
         195, 9103,  192, 5270, 4552, 7599, 5131, 5529], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3838, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3763, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3929, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3852, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 240, 2790, 8458, 6199, 3458, 8115, 7629, 8034,  822, 8065,  158, 3207,
          53, 9138, 6718, 5502, 4900, 7157, 5761,  955, 1623,  160,  847, 9109,
        1630, 9149,  604, 8135, 1184, 7279, 5787, 4373], device='cuda:0')
idx in forward tensor([7516,  104, 2785, 4257, 1625, 8509, 9139, 8113,  278, 3320,  732,   27,
        2535,  273,  385, 3301, 7104, 7064, 3854,  438, 8648, 4217, 1898, 7105,
        4223, 6950, 1753, 6857, 5750, 6658, 6610, 4485], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3807, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3720, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3856, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3781, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7756, 1821, 1475,  742, 6822, 3502, 3682, 2920, 3872, 4887, 2186, 7879,
        1473, 7478, 3384,  240, 2272, 4511,  430, 6799, 1741,  629, 8312, 6256,
        8946, 7177, 7978, 2622, 2307, 7441, 6620, 7195], device='cuda:0')
tensor([4515, 7611, 5866, 2034, 6392, 7231, 2792, 8443, 7038, 7514, 9059, 1850,
         285, 1944, 8513, 8952, 6686, 6916, 6289, 2941, 4256, 6979, 5422, 7141,
        8993, 1271, 5157, 1129, 4030, 2364, 4882, 6066], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3839, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3744, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3912, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3836, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4310, 1721,  306, 1688, 4851, 8025, 3459, 3198, 1520, 4294, 6939, 5059,
        3889, 4408, 2414, 2880, 4569, 6247,  631, 9095, 8945, 7625, 6623, 3375,
        6532, 1163, 2046, 6111, 4401, 4301, 1919, 7801], device='cuda:0')
idx in forward tensor([1760, 2622, 3905,  641, 5222, 7674, 3463, 5728, 3703, 4766, 3694, 1058,
        3261, 3956, 8289, 5984, 1936, 5360, 7513, 2706, 1357, 2716, 1090, 7606,
        6980, 4556, 2363, 8437, 8932, 2178, 8150,  460], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3948, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3874, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3883, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3812, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8124, 8065, 1778, 7533, 5177, 3793,  674, 6917, 2790,  271, 3966, 8598,
        2858, 9002, 7472, 6826, 8047, 1663, 1858, 4712, 5871, 8181, 6557, 7010,
        6019, 3813, 7976, 7106, 5674, 4283, 4679, 6914], device='cuda:1')
idx in forward tensor([ 682, 4396, 4295, 4082, 2084, 2144, 8863, 7822, 6808, 3808, 8991, 5753,
        3940, 8384,   44, 6197, 4520, 2816, 7848, 3002, 4490, 3805, 4230, 8197,
        5796,  464, 4384, 8319, 6470, 6591,   65,  389], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3956, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3888, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3952, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3877, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1446, 8820, 2209, 6259, 7499, 3276, 4202, 6546,  993, 7499,  281, 1700,
        8352,  443, 3357, 4354, 4639, 8224, 5088, 3666,  293, 1466, 4964, 2486,
        4664, 3739, 8964, 2528, 4094, 4783, 7277,  771], device='cuda:0')
tensor([3630, 3864, 8679, 4031, 3976, 5346, 6025, 2208, 3033, 3019, 8221, 8341,
        4170,  806, 5380, 1588, 1476, 4657, 8307, 6005, 5161, 2022,  706, 5306,
        1578,  324,    4, 8447, 8506, 4510, 3754, 2290], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3963, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3898, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3834, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3748, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4551, 4628, 6212,  182, 1348, 5769, 5712, 4500, 1060, 4367, 2645, 1430,
        8127, 3782, 6470,  818, 9071, 1282, 4723,  815, 2887, 7291, 3441,  461,
         364, 9140, 2977, 8263, 9090, 1983, 3079, 6131], device='cuda:0')
tensor([ 159, 2879, 5618, 9124, 6724, 3217, 1147, 3273, 1113, 7995, 4251, 1969,
         588, 4670,  420, 1580, 6415,  808, 3912, 7690, 5055, 5137, 5733, 2945,
        2554,  390, 3811, 5205, 3140, 8334, 7638, 1255], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3851, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3763, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3822, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3738, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4640, 3624, 6975, 4914,  116, 6891, 7579, 4933, 1605,  546, 4758,  665,
        8309, 4205, 5638, 1361, 5991, 6585, 2492, 3363, 3383, 4128, 4518, 6720,
        2765, 3564, 7143, 6380,  688, 6866,  266, 5091], device='cuda:0')
idx in forward tensor([3228,  716, 8351, 7532, 1209, 6760, 1307, 2408, 4846, 6953, 1598, 1313,
        2787, 6830, 2298, 3762, 8170, 3607, 3150, 8967, 4795,  326, 1367, 3507,
        7029, 4493, 2715, 3972, 2259, 6514, 1792, 4236], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3800, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3721, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3825, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3741, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8899, 3715, 1969, 4901, 3228, 2026, 7092, 6631, 3616, 2973, 8080, 7495,
        4883,  402, 3999, 7254,  909,  345, 4273, 2363, 8852, 3945,  924, 4650,
        5164, 7950, 1421, 1827,    9, 7499, 2291, 8890], device='cuda:0')
idx in forward tensor([1744, 4423, 1602, 8282, 6495, 2725, 2580, 6669, 8076, 1193, 8503, 8964,
        7577, 7940, 7663, 1317, 9039, 8485, 7146, 7041,   26, 6733, 6037, 6416,
        3249, 6314, 4122, 1069, 5803, 8502, 4948, 4836], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3861, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3794, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3786, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3698, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4423, 1034, 8834, 5406, 5341, 5558, 8327, 7292, 1028,  573, 7466, 6473,
        3062, 2916, 4885, 1329, 3032, 2301, 4427, 3932, 1151, 1633,  454, 7216,
        4690, 5580, 8663, 5767, 8480,  494, 8982, 6998], device='cuda:0')
idx in forward tensor([ 523, 6600, 8097, 2145, 6932, 4218, 1133, 4103, 5721, 2605,  223, 6535,
         222, 5798,  758, 6379, 4796, 4143, 3740, 8314, 4116, 8424, 9149, 8230,
        2282, 6503,  959, 7786, 2861, 2507,  941, 7464], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3898, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3812, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3897, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3820, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3960, 5903, 5992, 8754, 5126, 8187,  260, 8978, 6468, 7971, 6221, 5350,
        5997, 3296,    5, 7789, 7398, 3204,  817, 6239, 8736, 5832, 4549, 3329,
         432,  401, 4961, 3367, 3018, 5861,  241, 3806], device='cuda:0')
idx in forward tensor([7279, 1790, 3767, 3774, 5560, 7244,  876, 1370, 6696, 1700, 2515, 1665,
        3241, 4685, 4546, 4178,  984, 5381, 6263, 5671, 8611,  622, 5428, 7204,
        7979, 5417, 1041, 2634, 8659, 1891, 4408, 1670], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3943, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3875, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3936, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3875, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3215, 6790, 2541, 2917, 3655, 1323, 5918,  379, 1793, 7241, 8134,  158,
        6151, 5517,  796, 8440, 9063, 6159, 5468, 8272, 9127, 7409, 7967, 8930,
        1364, 2837, 4345, 3414, 2081, 2172, 1403,  404], device='cuda:0')
tensor([5844, 2972, 6058, 5975, 7242, 3185, 5132, 5840, 7765, 2616, 7805, 1425,
        8675, 6740, 7589, 8960, 7315, 1513, 3234,  601, 4015, 7842, 3610, 8771,
        3494,   51, 8367,  999, 6352, 3877, 1779, 1138], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3958, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3891, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3969, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3908, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5275, 8102, 3010, 6381, 3769, 3330, 2582, 6530, 1645,  910, 1682,  251,
        8994, 6779, 1795, 5639, 6347,  985, 4387, 7119,  811, 3276, 5852, 2870,
        8349, 4004,  104, 6907, 6685, 1229, 6053, 6187], device='cuda:0')
idx in forward tensor([4319, 8404, 5959, 3512, 1006, 8470, 7289, 2488, 2158, 1908, 3026, 7183,
        1817, 2700, 6329, 3379, 6828, 4803,  370, 1874, 7633, 1481, 2974, 2373,
        1887, 4196,  591,    9, 8113, 2055, 5613, 4186], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3922, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3984, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3926, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3857, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4754, 2679, 3570, 5702, 8239, 2017, 2829, 8979,   50, 6310, 5513, 2521,
        4433, 3666, 4621, 1161, 2386, 3800, 6495,  497, 5329,  672, 9110, 6858,
        6067, 6550, 2842,  579,  444, 3511, 2990, 7836], device='cuda:0')
idx in forward tensor([ 878, 5595, 8988,  291,  242, 6098, 7955, 5478, 3668, 2215, 7997, 3124,
          83, 1194, 3583, 3233,  592, 3262, 7978, 7905,  219, 2348, 4225, 9129,
        6188, 2779, 7194, 6398, 7194, 5204, 8704,  749], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3881, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3815, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3932, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3857, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2607, 5989, 7675,  704, 3018, 2254, 4484,  941, 2853, 1330, 4578, 2558,
        3593, 8560,  780, 8399, 7215,  252, 5682, 7993, 5691, 7549,    2, 3288,
        2643,  997, 6605, 8807, 5172, 6901, 8923, 9051], device='cuda:0')
tensor([ 540,  734, 3914,  703, 3935, 5081,  927, 6696, 1075, 7776, 6204, 6889,
        5796, 9108, 2667, 3587, 7618, 6437, 7058, 4177, 2001, 2980,  472, 5500,
         119, 2716, 1861, 2151, 5339, 5798, 6661, 3209], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3967, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3901, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3894, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3816, device='cuda:1', grad_fn=<MeanBackward0>)
[32m2023-10-20T15:39:49 | utils.basic_utils: [0mTrain Epoch: [0]  [100/572]  eta: 1:19:52  lr: 0.000010  temperature: 0.0172  video-loss_ita: 2.7305  video-loss_itm: 0.6091  time: 7.2059  data: 0.0071  max mem: 33192 res mem: 33720
idx in forward tensor([4690, 4469, 4842,  980, 9048, 3778, 8045, 7262, 2695, 7688, 7326, 3934,
        6205, 7749, 4513, 8680,  522, 5425, 1287, 5651,   37, 4380, 8988, 4217,
        7368, 6801, 6912, 4737, 4212, 1499, 8729, 2920], device='cuda:0')
idx in forward tensor([8313,  617, 1147, 8903, 7255, 5024, 4030, 7182, 4705,  997, 5094, 4378,
        3649, 4407, 3115, 3582, 6446, 8537, 8816, 6896, 3917, 6042, 4049, 7929,
        7493, 8275, 3783, 2520, 4563, 6876, 6777, 7713], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3914, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3840, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3926, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3862, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6399, 7732, 3304, 7071, 6241, 5435, 7142, 5106, 3845, 6193, 8397, 2426,
        2442, 7216, 2952, 1211, 3903, 1434, 6546, 6345,  236, 7377, 3960, 8216,
         173, 7180, 4756, 5822, 4157, 5764, 1923, 7640], device='cuda:0')
tensor([5395, 2098, 3072, 3596, 7724, 7990, 4453, 3659, 8701, 1360, 3924, 3621,
         265, 8843, 6402, 2696, 7557, 1788, 1983, 3622, 3381, 5455, 3866, 8962,
        3237, 1497, 7831, 7542, 1304, 4306, 8870, 8928], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3980, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3910, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3905, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3843, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3007, 6980, 5375, 6384, 8386,  772, 5654, 4393,  330, 7820, 4479, 8186,
        7264, 3148, 3252, 1200,  349, 6688, 6367, 5415, 4909, 6305, 4065, 9021,
        2072, 4492, 6427, 1987, 3115, 8022, 6754,  287], device='cuda:0')
idx in forward tensor([ 218,  654, 8642, 2146, 3708, 4837, 7669, 7366, 1618, 7540, 1726, 2759,
        1208, 1292, 8237,  377, 6504, 2138, 4805, 5374, 6269, 3234, 4566, 2964,
        1762, 7431, 3884, 4063, 8980, 6037,  298, 2310], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3817, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3731, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3799, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3716, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([1010, 4148, 4957, 3568, 2413, 2965, 1735, 5284, 1627, 1512, 3298, 1950,
        2480, 7340, 1016, 3799, 1630,  603, 8513, 8084,  851, 7711, 8765, 4691,
        2617, 4025, 1494,  702, 9146, 3886, 5195, 6406], device='cuda:1')
idx in forward tensor([7880,  335, 3976, 5354, 1460, 3381,  318, 6035, 6212, 8847, 4578,   13,
        8636, 6432, 7957, 3114, 5464, 3310, 1664, 9055, 1802, 2326, 3710, 3036,
        7028, 3378, 8088, 4533, 1043, 2438,  446, 5755], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3997, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3929, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3946, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3874, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4465,  305, 6737, 1528, 9059, 2046, 1931, 7878, 4210, 2475, 2771, 2163,
        8003, 3332, 8900, 5248, 7795,  405, 1011, 8153,  421, 1673, 6192, 6543,
        3343, 2993, 6233, 5908, 6403, 2561, 5288, 7127], device='cuda:0')
idx in forward tensor([8221, 2446, 1952, 7295, 1216, 4829, 4259, 5691, 8951, 2339, 5761, 6815,
        1379, 2112, 3551, 7451,  511, 7725, 8955, 5350, 1821, 7862, 7162, 3209,
        5930, 6821, 1259, 8635,  521, 2759, 6492, 7252], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3921, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3854, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3908, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3835, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8311, 6378, 7450, 1705, 6380, 6831, 7382, 8621, 2909,  215, 6153, 4240,
        7570, 6236, 7398, 4195, 3669, 6889, 8657, 9146, 4540, 2325, 2142, 4674,
         143, 4539, 2439, 1270, 5553, 1791, 2898, 2175], device='cuda:0')
tensor([8546, 3265, 4846, 7901, 4213, 5365, 8404, 1148, 3789, 7187, 6882, 2623,
        4756, 4698, 6719, 9070, 7661, 6494, 8956, 8712, 2355, 1250, 7675, 3627,
        1080, 1992, 6072, 5866,  725, 5372, 4461,  612], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3908, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3841, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3880, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3809, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3127, 7798, 4088, 4438, 5322, 3902, 2704, 2951, 6370, 1052, 8762, 5831,
        6742, 5373, 8604, 7983, 7996, 5445, 5541, 5705, 1188, 2979, 4062, 2878,
        3556, 4813, 2947, 7897, 1284, 4864, 5384, 6024], device='cuda:0')
idx in forward tensor([9075, 1567, 7049, 5852, 1483, 5671, 8711, 7926, 7839, 6907, 3427, 6981,
        4867, 7323, 3042, 5710, 4787, 7482, 7215, 6405, 8878, 6004, 2164, 2942,
        6920, 8043, 6364, 1245, 8837,  755, 8839, 5608], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4023, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3960, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3942, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3865, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1245, 5309,  144,  393, 8613, 2942, 6296, 3729, 6415, 6819, 9108, 8403,
        8241, 6512, 6333, 4599, 8287, 2916, 1642, 1520,  112, 2210, 6160,  458,
        9076, 6704, 4365, 6633,  678, 2312, 3631, 5974], device='cuda:0')
tensor([6170, 2808, 2196, 1811, 6468, 6230,  888, 1794, 7272, 8240, 4042, 6376,
        6467, 2719, 1639, 6393, 2752, 6399, 8882,  232, 4599,  262, 7630, 8857,
        8199,  609, 7650, 8401, 9126, 8891, 8308, 8794], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4041, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3986, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3980, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3920, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([6838, 3561, 5953, 3916, 5466, 2641, 1061, 1670, 5719, 6629, 1326, 5720,
         501, 2469, 3162, 3909, 4912, 5489, 3608, 6795,  996, 3154, 3235, 7369,
        1037, 2563, 1756,   70, 8275, 2231, 8246, 8761], device='cuda:0')
idx in forward tensor([4631, 5182, 8209, 6166, 1680, 7667, 1548, 8567, 2867, 3219, 5270, 1912,
        9062, 5800, 3908, 1274, 8404, 1746, 8139, 8304, 7940, 5507, 6105, 3506,
         289, 7668, 3950, 6311, 9144, 4752, 7407, 4727], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3973, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3909, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3900, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3824, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5479, 8990,  586, 7904, 6427, 3321, 1108, 7534, 2412,  894,  474, 8049,
        6786, 4796, 1934, 7220, 6125, 2347, 8615, 8500, 8155, 4534, 2439, 1561,
        5237, 6003, 2294, 6701, 6112, 3383, 4134, 6420], device='cuda:0')
idx in forward tensor([1728, 8728, 1412, 4598, 3326, 2468, 5525, 6397, 2970, 7144, 5320, 2475,
        6114, 3858, 3664, 9119,  441, 2710, 9013, 5695,  884, 4107, 8671, 8741,
        6855, 3477, 5033, 5659, 7542, 1105,  764,  511], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3909, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3838, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4000, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3939, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6823, 6856, 6984, 8985, 5293, 1715, 1723, 2584, 6590, 6910, 6725, 1166,
        7974, 3878, 5900, 6177, 5531, 4155, 7159, 1666, 4810,  715, 5444, 6885,
        5599, 7683, 5776, 1742, 6148, 7236,   38,  774], device='cuda:0')
tensor([7987, 1137, 1729, 7951, 8843, 8259, 5594, 7550, 9018, 1094, 6400, 1577,
        5751, 7240, 4728, 1588, 6518, 1019,   75, 8185, 8830, 3438, 5048, 5765,
        8555, 8352,  548, 2849, 4031, 8755, 6239, 7492], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3921, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3847, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3996, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3937, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5041,  316, 9136, 4733, 9078, 6407, 1886, 5266, 2871, 8284, 2881, 6574,
        3794,  769, 3861, 2860, 8924, 5667, 9048, 2663, 4455, 4093, 1366, 4595,
        8283, 4868, 4939, 6813, 1722, 3264,   17, 6173], device='cuda:1')
idx in forward tensor([1605, 8238, 8537, 6197, 1973, 3569, 3973, 8377, 7053, 7744, 3535, 3479,
        5000,  906,   86, 5440, 1939, 7761,  683, 3715,  833, 8782, 2365, 5354,
        5835, 9088, 3711, 5352, 2989, 6181, 3051,  582], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3844, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3774, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3910, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3829, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2041, 8831, 2744, 5341, 3718, 2072,  261, 3259, 5293, 4184, 8750, 8684,
        5758, 7039, 4917, 7588, 4830, 6800, 7415, 5526,  231, 6893, 8147, 8846,
        3779, 7314, 2833, 8217, 3755, 4478, 1328, 8380], device='cuda:0')
idx in forward tensor([ 554, 1045, 5391, 6699, 1758,  757, 3363, 1761, 3579, 1923, 1401, 8767,
        3168, 1540, 4599, 5877, 4338, 1145, 5032, 2081, 1122, 3488, 5383, 6102,
        5430, 1791, 4458, 4318, 7540,  640, 1698, 5020], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3848, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3774, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3907, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3835, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4077,  304, 9014, 4626,  274, 5235, 7433, 7136, 6237, 8986, 6936, 4735,
        4394, 8783, 7957, 6009, 2762, 8265, 8125, 1387, 5318, 5926, 7041,  748,
        8011,  509, 5094, 3106, 4466, 1730, 6123, 3990], device='cuda:1')
idx in forward tensor([7373, 1254, 3980, 2356, 7668,  321, 2266,   35, 7316, 7939, 4491, 2955,
        8272, 8714, 1370, 4807, 1121, 3656, 4719, 2698, 6231, 8906, 6763, 5919,
        2486, 2915, 8915, 8309, 1320, 8081, 6214, 6012], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3853, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3785, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3905, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3830, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5542, 8101,  726, 8747, 3782, 6186, 7466, 1284, 7737, 2341, 1018,  599,
        1282, 3405, 4600, 5612, 4384, 2488, 6766, 8467, 3692, 2615, 7587, 7205,
        6693, 8845, 3436, 4285, 7173, 3323, 1038, 2463], device='cuda:0')
tensor([4923, 2346, 7488, 2340, 5216,  751, 1545, 5702, 9113, 5826, 8922,  465,
        3677, 8190, 6271, 1368, 8592, 3793, 1214, 5243, 2937, 1551, 6043, 8018,
        8154,  711, 1734, 7555, 7343,  595, 8779, 1226], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3863, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3770, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3927, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3854, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4332, 3217, 1518,  204, 5100, 8682, 5022, 5448, 2499, 7225, 7476, 8699,
        7886, 5075, 2269, 2920, 6714, 2807, 4224, 6851, 1709, 6501, 7341, 8277,
        2613, 6661,  316,  873, 7141, 7263, 7722, 6116], device='cuda:0')
tensor([2856, 6722, 3114, 5505, 1341, 3295, 4525, 8449,  408, 1229, 4329, 7153,
        7697, 4816, 8584, 5864, 6140, 7563, 5511, 3017, 2407, 1993, 1628,  783,
        9137, 3945, 7202, 2056, 3152, 3315, 5196, 8044], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4007, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3949, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3751, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3667, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7747, 3851, 7850,  739, 3930, 4420, 8882, 2374, 8396, 3643, 5323, 8535,
        8024, 8680,  926, 7807, 5907, 8922, 1172, 6562, 8761, 1946, 4366, 6890,
        4948, 6400, 5074, 8605, 3271, 3703, 8536, 3563], device='cuda:0')
idx in forward tensor([7523, 4140, 8822,  483, 6534, 3081,  520, 6653, 2241,  615, 1832, 9008,
        4579, 5699, 5712, 5715, 8476, 8846, 4060,  216, 1438, 8853, 7133, 2604,
         226, 5513, 3646,  784, 2816, 2681, 2585, 5576], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3948, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3886, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4012, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3957, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4952, 6786, 4262,  131, 4707, 8169, 1756, 9118,  337, 1772, 5207, 7076,
        2180, 3614, 8321, 6852, 2301, 4738, 5501, 6565, 2045, 6545, 1713, 1857,
         923, 8206, 3262, 2768, 2273,  187, 6091, 2678], device='cuda:0')
idx in forward tensor([8741, 3912, 5253, 2776, 5415,  552, 3069, 5887,  126, 3822, 5098, 3723,
        4182, 2857, 2215, 2131, 7918, 2254, 2587, 2021, 6081, 8514, 6549, 1171,
         445, 7560, 1061, 3667, 8050, 4555,  168, 6241], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3925, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3850, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3916, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3842, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([3547, 3279, 7644, 3829, 1687, 2897, 2067, 5497, 7228, 8123, 3150, 1541,
        1896, 3534, 1390, 7520,  914, 4098, 4776,  172, 8347, 3450, 3856, 3222,
        6655, 9066, 8806, 5851, 1262, 1264, 4881, 7013], device='cuda:0')
idx in forward tensor([6826, 4110, 1544, 7347, 7022, 8464, 7016,  143, 9041,  958, 8915, 7261,
        1197, 8156, 7234, 4575, 6234, 3889, 6488, 8085, 6671, 6837, 5551, 1872,
         404, 3269, 7005, 2192, 5522, 6635,  589, 3792], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3904, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3825, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4034, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3964, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5555, 6687, 6355, 2976, 2756, 4220, 6681, 2619, 3593, 8463, 4634, 6954,
        5060, 5633, 8603, 2665,  591, 6975, 2500, 6746, 6351, 5545, 1984, 7022,
        8778, 9000, 4961, 6432, 5194, 7926,  375, 7822], device='cuda:0')
tensor([8297, 7138, 8642, 3454, 3140, 5457, 2770,  907, 6292, 5324,   16, 7065,
        7118,  309,  202,  680, 3068, 8939, 5749, 8449, 7140, 4396, 2218, 1475,
        9072, 1380, 7924, 5691, 2179, 6426, 3451, 4451], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3851, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3763, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3910, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3837, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2159, 5097, 1978, 2312, 3484, 3494, 4656, 7737, 7638, 3513, 4393, 8961,
        2462,  320, 3078, 1087,  597, 2067, 2793, 1901, 3854, 6416, 8514, 6307,
        4412, 2569, 3522, 4814, 9019, 5396,  521, 3408], device='cuda:0')
idx in forward tensor([8658, 3419, 5545, 2662, 4746, 5622, 4221, 2096, 4045, 4322, 1100, 1435,
        8346, 4862, 3979, 7114,  364, 1219, 2177, 3770, 7305, 3392, 3230, 5951,
        2696, 1195,  655, 5979, 8865, 3680, 4703,  989], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3872, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3865, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3789, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3795, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7011, 2873, 8879, 4801,  196, 7824, 1522, 2611, 4459, 2235, 2933, 5011,
        8766, 2739, 3178, 6323,  172,  644, 9065,    8, 1566, 3487, 7343, 6410,
        5922, 4810, 2899, 3021, 7586, 7975, 2085, 1091], device='cuda:1')
idx in forward tensor([4219, 2861, 7039, 1074,  132, 8191, 6107, 3711, 3713,  710, 3736,  307,
        6474,  428, 6464, 9007, 2347, 2973, 1585, 1256, 3912, 4526,  608, 4093,
        2410, 8999, 1934,  164, 6071, 7037, 2049, 7026], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3870, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3787, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3908, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3841, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([1649, 8980, 6221,  761, 8528, 7861, 6186,  762, 2976, 6616,  809,  768,
        2771, 2489, 9028, 1503, 4627, 5552, 1142, 2387, 8162, 7207, 3863, 4371,
        7019, 4048, 5314, 4675, 1285, 6886, 5697, 1766], device='cuda:1')
idx in forward tensor([4569, 7848, 1394, 3087, 6505, 7559, 4614,  476, 1185, 8174, 9110, 6879,
        2658, 2546, 8281, 5252, 6995, 2529, 6139, 3221, 2270, 4268, 3840, 4121,
         831, 5515,  952, 2103, 3440, 3585,  970, 6342], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3985, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3920, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3883, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3812, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7389, 7268, 8901, 7256, 8264,  409, 8664, 4909, 6327, 8544, 2951, 8651,
        1972, 6568, 8025, 1618, 8539, 4007, 9055, 7538, 7492,  338, 5891, 4796,
        7060, 2707, 4047, 6374,  990, 1913, 5467, 7203], device='cuda:0')
tensor([4128, 8365, 6509,  456, 5587, 5547, 5409, 7285, 4347, 7848, 8660, 8561,
        1218, 1529, 1644, 1121, 4681, 3096, 3918, 8306, 3015, 3461, 8395,  621,
        5253, 1040, 8014,  963, 8969, 2434, 8327, 1862], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3917, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3833, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3898, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3822, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([1773, 6467, 1918, 8232, 4491, 3161, 7255, 7850, 2148, 7759, 6947, 5472,
        1291, 5895, 9085, 5003, 5291, 4930, 6785, 4829, 7137, 2818, 2820, 8035,
        4083, 1183, 7888, 3145, 5983,  526, 2632, 3611], device='cuda:0')
idx in forward tensor([2909, 8396, 3848, 1114,  475, 3077, 8336,  298, 3673, 4531, 2513, 6558,
        4771, 3751, 3634, 1835, 8017, 5959, 3753, 4824, 8802, 7576, 1428, 2103,
        8075,   14, 6048, 7525, 8073, 6254, 4038,  265], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3912, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3838, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3940, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3862, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8047, 6077, 2671, 3773, 8105, 3594, 6387, 8333, 2532, 5678,  409, 7009,
        5901, 7600, 8697, 8007, 6227, 4531, 4191, 2352, 1523, 7656, 4882, 4999,
        5281, 7506, 4681, 1540, 6252, 7627, 4546, 8692], device='cuda:1')
idx in forward tensor([7707, 3112, 4964, 8255, 3468, 7495, 5543, 3528, 1800, 2691, 6738, 3318,
        8695,  736, 1316, 2369, 4370, 3568, 7152, 5993, 4428, 3397, 8452, 2007,
        1842,  532, 5165, 7758, 3390, 2478, 3176, 4711], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4006, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3946, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3870, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3783, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7983, 8719, 3025,   49, 2224, 8783, 5452, 7374,  350, 4184, 8856, 3360,
        8108,  215,  719, 3888, 1283,  979, 8179, 1616, 4470, 7129,  825, 6442,
        4889, 6797, 7126, 1058, 2479, 7358,  137,  686], device='cuda:0')
tensor([8413, 6507,  272,  112, 6308, 1693, 6673, 8940, 8518,  791, 3896, 5677,
        8533, 8052, 8092, 4733, 5434, 2664, 3330,  751, 1081, 5676, 3537, 5948,
        1177, 2763, 1674, 4914, 3502, 5084, 1216, 5608], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3862, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3789, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4008, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3951, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6485, 6872, 8226, 3250,  362, 2214, 2830, 7444,  871, 7545, 5038, 7219,
        8423, 2306, 1690, 6814,  395, 3007, 8279, 3064, 4735, 3938, 7783, 8031,
        8693, 7510, 6207, 4021, 8502, 6297, 5423, 3408], device='cuda:0')
idx in forward tensor([1272, 7332, 2673, 5634, 4948, 6308, 7995, 6788, 8697, 2334, 7963, 5988,
        7178, 7096, 4669, 3954,  844, 2346,  822,  358, 2379, 5799, 2491, 2714,
        2738, 2399, 3697, 4806, 4649, 7456, 8828,  565], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4013, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3952, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3777, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3683, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8388, 4095,  109, 6251, 3891, 1694, 7288, 7840, 2588,  922, 4272, 8023,
        1600,  373, 5026, 4606, 3668, 7512, 7210, 5573, 6196, 6905, 6296, 6767,
        6576, 2406, 4105, 8852, 2681, 6167, 3177, 4461], device='cuda:0')
idx in forward tensor([6002, 1046, 3989, 5683, 6186, 4340, 6229, 2421, 7208, 8256, 6202,  780,
         668, 7568, 8285, 5816, 8219, 6243, 7905, 3580, 5501, 1491,  293, 2059,
         576, 2682, 5305, 6768, 3517, 6706, 7841, 4074], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3920, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3855, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3806, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3718, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6996, 6932, 6302, 4899, 4903,   11, 8972, 3191, 2082, 1385, 5197,  528,
        5989, 3485, 4233, 6422, 2633, 5477, 1611, 3189, 5429, 4609, 9113, 1674,
        5332, 7055, 7942, 6606,  900,  259,  138, 4655], device='cuda:0')
idx in forward tensor([5120, 3370, 1104, 8002,  652, 5763, 5746, 1685, 8914, 5737, 8674, 7953,
        8721, 1413, 6854, 2832,  122, 5413, 7299, 8083, 1611, 4402,  858, 5032,
        6137, 3636, 6442, 5495, 8151, 5820,  400, 7039], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3873, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3797, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3853, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3770, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([2575, 3115, 3497, 1866, 4852, 8381, 2791, 8907, 5662, 7248, 7998, 8796,
        4887, 1369, 6700, 2385, 8476, 3699, 4621,  430, 7757, 4842,  339, 4062,
        6877, 3213, 7394, 4342, 5386, 4721, 7854, 4366], device='cuda:0')
idx in forward tensor([3818, 2774, 5271, 2361,  673, 3597, 7454, 2194, 1218,  960, 6258, 8945,
        5132, 5210, 3519, 6279, 8022, 7320, 8447, 7925, 8965, 7724, 4176,  434,
        5195, 6754, 4046, 2759, 2660, 6750, 4992,  366], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3971, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3907, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3804, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3715, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 283, 5370, 7027, 1887, 4583, 5182, 7358, 6209, 5200, 6705, 6510, 1229,
        6760, 5014,  926, 4344, 5069, 4817, 8261, 2009, 8432, 1788,  538, 5650,
        2585, 3839, 7272, 8465, 5995, 1006, 2142, 8410], device='cuda:1')
tensor([4051, 3965, 8669, 1694, 6270, 5585, 5252, 1158, 4528, 6082, 1601, 7641,
        1016, 2286, 3281, 7720, 7926, 3834, 5492, 3508, 2321, 2783, 3274, 2340,
         737, 7904,  976, 3469, 6675, 1953, 2467, 7533], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3791, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3704, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3951, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3879, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6436, 4670, 5323, 9004, 6765, 6254, 4950, 2845, 2063,  975, 7414, 2332,
        3402, 8874, 8531, 8482, 2544, 3746,  880,  238, 6402, 8889, 4186, 2576,
        8434, 3812, 7546, 8939, 5497, 8245, 1837, 2503], device='cuda:0')
tensor([8824, 1060, 3776, 4648, 4575, 8055, 3195, 7134, 3457, 3538, 2375, 7987,
        4300, 3752, 8551, 8803,  971, 6444, 4988, 8357, 8442, 4839, 1107, 8479,
        2972, 1776, 4419, 8049, 4846, 6801, 2927, 5833], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3893, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3815, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3962, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3892, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5493, 9016,  525, 4801, 8981, 6974, 3852, 1968, 4528, 1958, 2770, 1127,
        3290, 1736, 4571, 2661, 1220,  460,  684, 5872, 2568, 4089, 2758, 7664,
         726, 2287, 1655, 4731, 1295, 7750, 8530, 3609], device='cuda:0')
tensor([5548, 4318, 2825, 2999, 4299, 6395, 3702, 4467, 5909, 3091, 5059, 5574,
        6062, 1665, 8494, 7656, 2427, 2349, 1606, 4130, 7063, 5886, 3364, 6245,
        5215,   59, 1960, 2028, 5299, 4833, 3985, 8993], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3899, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3826, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3958, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3886, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6776, 5968,   34, 7191, 6545, 4570, 2891, 7317,  129, 8565, 1957, 1368,
         473, 2456, 2281, 5486, 4176, 4032, 6620,  362, 4217, 8529,  549, 2973,
        3942, 5998,  504, 3746, 8685, 2977, 6962, 7730], device='cuda:0')
idx in forward tensor([8182,  801, 1354, 3828, 3137, 2442, 8993, 3451,  585, 3117, 8512, 4524,
        7084,  136, 3632, 6164, 8336, 3740, 8594, 3686, 1785, 7289, 7467, 2438,
         275, 5027, 2999, 5137, 5116, 6892,  861, 6335], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4016, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3959, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3949, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3878, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 807, 3065, 4746, 7766, 8019, 5632, 5894, 7206,  750,  667, 5008, 8159,
        9072,  785,  983, 7758, 1101, 3327, 7339, 5446, 5350, 5522, 4875, 6356,
         869, 7277, 3906, 6806,  305, 6523, 2721, 1751], device='cuda:1')
idx in forward tensor([5373, 8287, 1343, 8361, 8738, 2547, 4492, 8883, 6727, 2207, 2228, 4500,
        8114, 4043, 2117, 1112, 7905, 6027, 1834, 2853,  163, 4246, 7920, 5389,
        1953, 5012, 8520, 3192, 8078, 5767, 5471, 1239], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3873, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3801, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3902, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3814, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([ 951, 2813, 3070, 4947, 6316, 1768, 6418, 2841, 1432, 2624, 1083, 8857,
         506, 6826, 7156,  105, 4755, 2967, 7447, 6309, 5123, 3917, 3246, 6934,
        1876, 5570, 9009, 5748, 2236,  754, 2799, 6373], device='cuda:0')
idx in forward tensor([7164, 1468, 2539, 6172, 7106, 5871, 7590, 2722,  671, 4195, 6558, 2342,
        7591, 5628, 9053, 4836, 3506, 2912, 2511, 7564, 3627,  452, 7876, 1771,
        8573, 7914, 3533, 2339, 1543, 8788, 8048, 5679], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3870, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3799, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3884, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3801, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7161, 3293, 6214, 2878, 4502, 4747,  750, 4893, 8644, 2523, 3520, 1999,
        8255, 4461, 7132,  802,  983, 4669, 8274, 6373, 4953, 2119, 4152, 5062,
        2078, 7433, 1516,  727, 6704, 2383, 1368, 2378], device='cuda:1')
tensor([2553,  325, 3953, 7519, 6346, 4184,  338, 4932, 6161, 4848, 1508,  440,
        2997, 7243, 3650, 9031, 7265, 3393, 8581, 7260, 5563,  254, 4346, 9020,
        2807, 7395,   42, 8480, 8715, 6176, 8300, 8847], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3926, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3849, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3908, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3833, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3217, 8320, 4149, 8552, 7945, 4132, 3254, 2055, 3184, 6300, 5340,  856,
        1962, 1788, 5759, 2341, 1101, 6439,  817, 5136, 4784, 5923, 4106, 6628,
        8173, 5602, 7147, 2632, 1383, 4058, 1915, 1610], device='cuda:0')
idx in forward tensor([5591, 5247, 4660, 4064, 8772, 7896,  515, 7593, 7379, 7013, 5808, 4459,
        5544, 4451, 1312, 8715, 7729, 7596, 7701, 5625,  375, 1764, 5459, 1068,
        3494,  247, 7624, 2748, 5173, 7730, 7552, 3034], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3984, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3917, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3820, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3738, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5291, 1089, 4390, 2023, 6840, 4497, 7941, 8379, 6513, 8562,  913, 6809,
         295, 7310, 7995, 2980, 8136, 5121, 6218, 2372, 8694, 4036, 5435, 4774,
        7225, 8060, 6434, 2859, 1342, 7313, 3278, 5997], device='cuda:1')
idx in forward tensor([3507, 5528, 6577, 4743, 4300, 7154, 4339, 1271, 8300,  642, 3345, 5849,
        5254, 2505, 6106, 3412, 8897,  334, 2597, 8950, 9132, 4620, 6011, 6095,
        1731, 5063, 5736, 5574, 2039, 3884, 2540, 3098], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4053, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3986, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3711, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3614, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8103, 1478, 2249, 1748, 3337, 7780, 4380, 5454, 3846, 6463, 4752, 1267,
        5763, 1394,  365, 8953, 1352, 2742, 1511, 7887, 7288,  658, 3290, 7811,
        7662, 2466, 1763, 2690, 3727,   96, 4894, 3078], device='cuda:1')
tensor([6840,  844, 6825, 2979, 8158, 2240, 7896, 1232, 8649, 8909, 8560, 2829,
        5237, 7504, 1971, 6276, 1275, 5114, 3300, 7582, 5788,  473, 8650,  185,
        6201, 6138, 1315, 4396, 2626,  368,  394, 5501], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3947, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3872, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3850, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3763, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3759, 4028, 3370, 7096, 3073, 7829, 3736, 8497, 7037, 7050, 6261, 6529,
        5069, 8439, 8544, 8236, 3954, 5914, 4157, 1001, 8538, 3877, 1491, 8408,
        6554, 4943, 8592, 8865, 2431, 2381, 5662,  913], device='cuda:0')
tensor([7345, 8012, 7728, 8879, 4433, 6292, 2319,  654, 6933, 3740, 5809, 6425,
        2060, 3898, 4568, 4605, 2217, 7526, 5001, 2232, 8567, 1528, 3909, 5685,
        2540,  877, 3491, 7934, 2063, 4897, 7781, 8676], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3917, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3849, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3876, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3798, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4671, 6039, 8928,  224, 8067, 7976, 3452, 3605, 3499, 8681, 4557, 3816,
        5732, 4337, 6684, 1181, 8995, 2143, 1416, 6773, 3104, 4676, 4135,  373,
        8842,  455, 3467, 5880, 3896, 3492, 7084, 5072], device='cuda:0')
tensor([8855, 2886, 6849, 1836, 6547, 5346, 4180, 4706, 7834, 5086, 5609, 4911,
        6049,  269, 4388, 1213, 1621, 6501, 4937, 6067, 7446,  118, 2082, 2362,
        3546,  173, 7807, 5866, 6965, 6898, 8384, 3226], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3964, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3899, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3936, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3861, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([5709, 3510, 7213, 8857, 8933, 2005, 4039, 5103, 3360, 8039, 1736, 5343,
        2846, 3036, 6656, 6099, 2855, 6027,   87, 2434, 5987, 7461, 1012, 6111,
        6392, 6811, 1435, 5205, 2869, 7154, 6610, 5556], device='cuda:0')
idx in forward tensor([3919, 6415, 5096, 3047, 4858, 3857, 2895, 1394, 5810, 5567, 2234, 1411,
        3804, 8318, 3167,  958, 2305, 3543, 5696, 8098, 3257, 2591, 8671, 4887,
        4227, 6633, 6149, 4075, 7001, 4134, 5698, 4354], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3952, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3884, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4002, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3937, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5575, 2682, 9118, 3351, 3051, 1113, 5115, 9073, 7392, 6663,  961, 4851,
        6535, 7431, 7117, 2684, 3362, 4620, 7120, 7103, 6651, 3415, 1495,  805,
        5962, 4777, 7726, 9107, 5952,  798, 8925, 7050], device='cuda:0')
idx in forward tensor([4457, 2425, 1599, 6752, 3088, 8032, 1339, 8276, 4368, 3846, 1806, 4392,
        7318, 4956, 2236, 7666, 2857, 6054, 6989, 5617, 5431, 4475, 6347, 1916,
        8528, 2719, 7852, 8504, 5197, 6482,   82, 4674], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3871, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3779, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4008, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3941, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7560, 5786, 7460, 8041,   46,  271, 8409, 7159, 7891, 4997, 2827, 4279,
        4041, 1998,  853, 5132, 1650, 5599,  223, 8331, 5181, 2876,  300, 3944,
        5292, 8318, 3206, 7310, 6448, 2369, 1555, 4301], device='cuda:0')
tensor([2268,  493, 4196, 3084, 2409, 6674, 4420, 4237, 7677, 7903, 8476,  497,
        7420,  549,   21, 5834,  853, 8763, 5129, 7100, 6845,  807, 8160, 4759,
        3127, 6222, 5407, 1774, 6934, 3086, 4585, 6235], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4008, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3952, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3771, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3671, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7646, 2049, 9146, 8488, 5269, 5876, 4358, 1530, 1199, 5117, 7636, 5034,
        4728, 3496, 3771, 6374, 3522, 4376,  238, 5660, 6548, 8689, 8736, 3923,
        8646, 8363, 8734, 6010,  422, 6625, 6899, 3612], device='cuda:1')
idx in forward tensor([ 646,  356, 4853, 3115, 2259, 5365, 4980, 4213, 4400, 3398, 3741,  623,
        1494, 3118,    1, 6945, 7344,  471, 1330, 4371,  954, 5153, 6862, 8414,
         399,  334, 3369, 2267, 5529,  697, 5342, 2469], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3862, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3787, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3965, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3892, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([2017, 6093, 6553, 7697, 2863,  489, 4806, 1525, 3262,  234,  865, 1082,
        4479, 7660, 1172,  367, 7855, 6469, 6918, 8314, 4119, 8835,  180,  439,
        6592, 6204, 8521, 6503,  111, 6575, 6298, 8615], device='cuda:0')
idx in forward tensor([7515,   24, 5440, 4304, 1950, 4348, 5987, 2691, 1860,  910, 6690, 6057,
        6470, 5250, 9149, 1122, 6485, 6061, 2793, 4158, 8978, 2962, 5005, 4326,
         624, 8246, 9035, 8359, 3622, 4777, 2732, 9098], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4080, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4030, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4027, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3970, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([9021, 7726, 3892, 3470, 8814, 6126, 1186, 7234, 3881, 7609, 2072,  443,
        9131, 4693, 5591,   25, 3156, 8229, 8716, 1349, 6144, 6277, 1588, 7322,
        7525, 2930, 1512, 7592, 4221, 6112, 6853, 6700], device='cuda:1')
idx in forward tensor([6910, 7348, 6967, 6200, 4050, 7636, 5881, 7683, 8679, 5402, 2291, 3709,
        5946, 3541, 1384, 1503, 5091,  957, 6834, 1557, 5502, 5912, 3210, 1138,
        2695, 8453, 8253, 3404, 8966, 4919, 4672,  127], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3851, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3767, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3851, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3769, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2101, 6324, 8840,  708, 1302,  694, 4657, 7212, 9116, 4558, 7513, 5330,
        2150, 2077, 4847, 2700, 3304, 5432, 6394,  912, 3274, 6996, 6141, 2222,
        4826, 4152, 8755, 3199, 5198, 1669, 7172, 2129], device='cuda:0')
idx in forward tensor([7833, 3685, 6531, 4639, 7613, 7038, 6966,   91, 7655, 7257, 1852, 6920,
        7052, 7322, 4531,  182, 6612, 8774, 8126, 8970, 8606, 7680, 1922, 5838,
         488, 3985, 1476, 1288, 5680, 5064, 2159, 4716], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4030, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3971, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3975, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3914, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 445, 1034, 6904,  545, 1108, 6892, 6081, 5484, 7101, 8434,  213, 6024,
        6991,  370,  787, 5322, 8724,   87, 4176, 6515, 6579, 6273, 3472, 9093,
         798, 1420, 5957, 6116, 4896, 8051, 6418,  997], device='cuda:0')
tensor([8605, 1518, 2807, 1795, 4681, 4927, 1080, 1747, 1637, 1002, 6192, 4128,
        1204, 8334, 7108, 8455, 1453,  266, 2364, 2303, 4863, 5842, 2846, 5088,
        1847, 7634, 4415, 3307, 6989, 3702, 7273, 5851], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4000, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3940, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3737, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3643, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6981, 6597, 3931, 4597, 7485, 2168, 1893, 2562, 4870,   21,  450, 4612,
        6395, 7330, 6897, 8663, 1719, 6341, 7315, 2114, 2606, 8094, 7877, 7711,
        7709, 8650, 1769, 7822, 8989, 6893, 1384, 8549], device='cuda:1')
idx in forward tensor([6729,  208, 3286, 2188, 1588, 2061, 7314, 8718, 2406, 1003, 3881, 1502,
        1807, 7619, 1797, 2829, 1663, 4382,  533,  564, 2986, 2375, 6101, 7745,
        7265,  718, 2627, 8298, 1896, 5121, 8551, 4245], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3805, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3720, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3948, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3881, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([2342, 8555, 8259, 5711, 6647, 5831, 1596, 8832, 4488, 8688,  206, 2127,
        6750, 8904, 8274, 4309, 6967, 6324, 3335, 4343, 3963, 6323, 2138,  695,
        3281, 8587, 7718,  352, 3512, 4640,  447, 7589], device='cuda:0')
idx in forward tensor([4098, 9061, 7770, 5948,  134, 2498, 8346, 2179, 3565, 3772, 7627, 3304,
        4070, 3149, 1172,  269, 4952, 2771, 9001, 7029, 2086,  902, 7667, 1564,
        4499, 4939, 2718, 3646, 5868, 3244, 4293, 7899], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3894, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3816, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3907, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3831, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([7645, 8027, 3478, 7242, 5145, 8813, 1034, 8972, 9015, 5359, 5588, 4476,
        1160, 3548, 7605,  921, 1770, 5730, 4307, 3552, 9104, 8893, 7503, 3927,
        4076, 7099, 2408, 9105, 9010, 2644, 3466, 2263], device='cuda:1')
idx in forward tensor([8471, 6670, 6824, 3735, 7779,  277, 8445, 7505, 3105, 2743, 5497, 4691,
        3947,  395, 4022, 4569, 6341, 3638, 8630, 1258, 4711, 4167, 8829,  220,
        8171, 2144, 3841,   30, 4632, 3596, 1115, 2659], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3966, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3903, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3844, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3767, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4893, 4071, 3593, 6589, 3500, 6300, 3019, 6055,  141, 4890, 7095,  302,
        6091, 8453, 7533, 7852, 5917, 4479, 8066, 3069, 2777, 8595, 5861, 8149,
        1628, 6369, 6515, 1823, 8970, 2360, 7699, 8677], device='cuda:0')
tensor([6329, 7015, 9121, 2087, 1443, 4779, 5957, 3781, 5245, 8111,  332, 1315,
        4761, 3207,  946, 4924, 6073, 6983, 7566, 6212, 6461, 6241, 4946, 6120,
        2044, 7070, 3798, 8570, 3265, 2728, 8771, 8991], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3920, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3851, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4080, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4029, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8682, 5448, 5523, 7969, 5863, 3571, 8995, 2341, 6823,  993, 7623, 8445,
        1496, 1523, 6739, 3961, 8400, 7403, 6305, 3650,  940, 5600, 3590, 5486,
        2423, 2682,  177, 4552,  823,  495, 4602, 3117], device='cuda:0')
tensor([8382, 7402, 8642, 2745, 2330, 6278, 7378, 3895, 6302,  225, 3514, 2162,
        1428, 5185, 5114,  283, 7253, 2569, 5359, 6120, 4571, 1429, 7703,  954,
        5966, 7919, 5308, 6423,  875, 3065, 1288, 3625], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3962, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3903, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3790, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3709, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4441, 3879, 1642,  825, 8038, 1784,  460, 2424, 8797, 6881, 1106, 6278,
        5082, 7002, 4913, 8374, 6977, 3134, 2444, 4599, 5820, 7609,  782, 6133,
         216,  491,  792, 5362, 3027,   64, 2903, 1782], device='cuda:0')
idx in forward tensor([6572, 4878, 7097, 8524, 8804, 6153, 5054, 8242, 5082, 6795, 2289, 3066,
        4996, 7297, 1701, 6241,  332, 6005,  297, 3824, 7829, 3460, 3131, 3946,
        4786, 3945, 4908, 7889, 3407, 7378, 1843, 5257], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3850, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3781, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3840, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3757, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4676, 1416, 3967, 7575, 3138, 7390, 2584, 7745, 1608, 3085, 6224, 6092,
        4996, 1804, 7438, 5104, 4643,  908,  393, 7612, 6963, 4207, 1831, 5433,
        5882, 5844,  868, 4714,  130, 2548, 8224, 6059], device='cuda:1')
idx in forward tensor([8248,  716, 8626, 8065, 7857, 8451, 8884, 9046,  308,  291,  595, 7054,
        1197, 7277, 1727, 1126, 3306, 8306, 4067, 1682, 7555, 5622, 5863, 7579,
        9098, 5681, 5784, 6710, 4896, 5102, 6687,  457], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3860, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3790, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3915, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3842, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([3184, 8740, 7062, 2383, 5673, 4740, 5133,  577, 8852,  898, 7495, 6825,
        3585, 5856, 2435, 2386, 7229, 5048, 6551, 7571, 8146,  249, 6690, 7565,
        4859,  212, 8710, 6651, 3790, 9067, 2711, 7584], device='cuda:0')
idx in forward tensor([6618, 6397, 4475, 3236, 6877, 8480,   30, 1498, 1024, 6950,  149,  673,
        2357, 1466, 8328, 8192, 5717, 7370, 7596, 2741, 1875, 3732, 8900, 3770,
        3876, 1629, 7763, 8662, 5745, 4659, 4175, 1215], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3736, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3640, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3944, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3875, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5276, 1780, 5182, 9047, 5661, 3001, 9093, 4079, 8310, 5537, 3127, 5380,
        4372, 5680, 1678, 7158, 5610, 8320, 3446, 2502, 7632, 6269, 3722, 7750,
        6638, 5100, 3849, 6873, 6629, 3376, 8431,  336], device='cuda:0')
tensor([6227, 1483, 5324, 3139, 4730, 7573, 8469, 3927, 3542, 5215,  328, 7911,
        2635, 3113, 7959, 5398, 4816, 2739, 8942, 1193, 2207, 1926, 1749,  831,
        8233, 2204, 4173,  771, 4814, 8121, 8308,  324], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3896, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3813, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3842, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3758, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([6571, 6094, 6217, 3874, 3282, 7992, 2203, 6283, 6701, 2750, 2907, 3107,
        4401, 2676,  832, 9034, 6660, 2045, 3782, 5451, 8010, 1352, 7178, 5308,
        3713, 6280, 1407, 8660, 9109,  750, 5516, 5927], device='cuda:1')
idx in forward tensor([7633, 6298, 6035,  997, 7214, 1104, 1445, 3828, 4304, 5320, 8521, 1140,
        3842, 1030, 6216, 3085, 4269,  358, 7541, 5629, 2071, 1161,   84, 6391,
        4932, 1044, 3354, 9066, 1858, 8419, 8667, 1714], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3940, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3870, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4080, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4027, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2412, 6536, 4906, 4439, 2646, 6559, 2176, 7137, 2494, 6954, 8795,  197,
        8824, 6169, 5258, 6589, 3626, 1029, 8250, 8496, 5716,  321, 4486, 8295,
        2230, 8909, 6408, 3917,  788, 6370, 1571, 3784], device='cuda:0')
tensor([5241, 3742, 7787,  139, 1220, 5130, 5129, 3355, 7476,  714, 1109, 4999,
        4146, 1955,  840, 1193, 7766, 5224, 2967, 8859, 6066,  554, 5118, 3753,
        8619,  406, 8599, 2332,  652,  112, 4188, 2615], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3932, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3860, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3830, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3755, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8626, 1123, 8899, 7895, 8920, 7028, 2557, 3478, 2624, 5719, 5238,  384,
        5360, 6057, 5289, 9035, 1543, 1251, 4501, 3242,  565,  519, 5659, 4268,
        1106, 3704, 5100, 4056, 6647,  103, 8692, 4383], device='cuda:0')
tensor([6871, 7169,  286, 1095, 2578,  635, 3784, 8599, 4166, 9077,  681,  705,
        3243, 6477, 8099, 2919,  855, 3800, 1649, 1409, 5130, 1012, 4689, 6404,
        4854, 1694, 4071, 2100, 6496, 2022,  977, 5795], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4035, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3980, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4001, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3934, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 812, 2881, 5158, 7448, 2756, 4135, 1790, 3748, 8786, 3123, 3720, 2273,
        7514, 3633, 3902, 5636, 1909, 2799,   29, 3129, 4611, 5201, 4376, 1648,
        3776, 7481, 7367, 8877, 2890, 5105, 1173, 3631], device='cuda:0')
idx in forward tensor([  28, 8618, 2042, 7497, 1251, 4505, 7569, 2486, 4407, 6595, 3196, 5667,
        5165, 6279, 5193, 4825, 1133, 1959, 8712, 3279,   53, 5904, 6015, 1629,
        4989,  124, 2746, 2621, 3563, 6041, 6443, 6340], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3888, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3815, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3989, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3918, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 481, 2643, 4222, 7097, 8529, 1826, 7099, 3612, 8714, 1616, 1478, 2250,
        3581, 2269, 2369, 5514, 6365, 7629, 6424, 1246, 8331, 8327, 5175, 1786,
        1774,   83, 2021,  127, 9103, 5328, 7209, 8628], device='cuda:0')
tensor([5906, 8919, 8826, 2620,   18, 8505, 1369, 7731, 6876, 4614, 1167, 1378,
        2177, 2444, 6422,  582, 5771, 3577, 4706, 5005, 5581, 4931, 3657, 3693,
        3561, 3624,  791, 4291, 1863, 6036, 2014, 8567], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4013, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3953, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3898, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3837, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5699, 7769, 9031, 5305, 4587, 5076, 6821, 8325, 4961,  147, 2543, 8525,
        8516, 5737, 8000, 6317, 6514, 5627, 7437, 3158, 3328, 4178, 6061, 3726,
         897, 5139, 4174, 4104, 9089, 8302, 6554, 7931], device='cuda:0')
tensor([7909,  360, 9048, 7429, 2237,  632,  484, 8477, 6243, 3030, 5614, 7088,
        4291, 5612, 1925, 7783, 8931, 8635, 9049,  886, 2646,  893, 8535, 8133,
        2674, 5015, 1532, 1529, 8881, 9079, 7359,   75], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3917, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3847, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3858, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3784, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8521, 6090, 8836, 8983, 5202, 5319, 4076, 7232, 1056, 2169, 4001, 3422,
        1990, 2692,  680, 6039, 6335, 5618, 7326, 1718, 1961, 6592, 2294, 1069,
        6385, 6666, 1914, 3250,    6,   13, 6649,  345], device='cuda:1')
idx in forward tensor([5990, 7515, 4090, 1868, 5974, 3159, 3674, 7243,  563, 2176, 3355, 7347,
        5290,  252, 3422, 7573, 7340, 2420, 4560, 1321, 3250, 2280,  396, 7344,
        4123, 4812, 5312, 3736, 7521, 2327, 1429, 6537], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3782, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3701, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4089, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4039, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([1311, 4585, 4306, 6909, 8079, 3560, 4426, 3243,  756, 2126, 3527,  146,
        5013, 6978, 7047, 7810, 1413, 6999,  929, 1531, 8426, 5673, 7197, 6023,
         678, 4485,  468, 6586, 6292, 4995, 4410,  935], device='cuda:1')
idx in forward tensor([5892, 3549,  788, 8034, 6272, 8210, 1372, 2414, 7634, 4273, 7538, 7836,
        2476, 3144, 8364, 4406,  173, 3987, 8640, 8106, 1613, 4639, 4973, 1640,
        3264, 7657, 6983, 1984, 4986, 9050, 8139, 8073], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3860, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3782, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4049, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3995, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6780, 5226, 1020, 3406, 5801, 5063, 3307,  122, 2865, 5805, 5941, 6021,
        2566, 2550, 7790, 2243, 4161,  113, 2150, 4824, 5219, 7083, 5569, 3435,
         994, 1921, 8463, 7280, 7116, 8919, 3096, 6952], device='cuda:1')
idx in forward tensor([8114, 1307, 5117, 5784, 7771,  987, 5579, 7829, 5538, 7697, 9116, 2686,
        8969, 1855, 7221, 1130, 1617, 7839, 4661, 8120, 6595, 5865, 3635,  947,
        1070, 7089, 1668, 5311, 8239, 7222, 8767, 4333], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3950, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3887, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4057, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3998, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([6303, 2827, 1547, 2616, 5158, 5854, 7274, 5628,  834, 8011, 8088, 2093,
        3574, 3265, 3920, 1717, 1227, 1144,  571, 9014, 8894, 8307,   63, 2897,
        7127, 8067, 7418, 3738, 5321, 1147, 3699, 1656], device='cuda:0')
idx in forward tensor([7174, 6769, 5230, 5705, 8777,  346, 4104, 5561,  528, 4901, 6912, 4308,
        5996, 2836, 7372, 8856, 4429, 2660, 7098, 3358, 5627, 5842, 7739, 5227,
        3606,  537, 8262, 3476, 1470, 7751, 5878, 4719], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3909, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3846, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4128, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4077, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([2541, 4239, 6519,  512, 2076, 3692, 6269, 1004, 4851, 6714, 6577, 4350,
        4708,  291, 4195, 8069, 8550, 7353, 3286, 8305, 5229,  766, 8773, 2617,
        2508, 1100, 8533, 5000, 5966, 5261, 7309, 3604], device='cuda:0')
idx in forward tensor([5916, 1168, 4000, 2206, 4670, 3334, 5364, 7535,  741, 4390, 3109, 1419,
        7405, 5443, 8032, 3777, 3398, 5110,  347, 8136, 3531, 2605, 8792, 4550,
        7613, 8512, 3675, 7580, 4704, 1449, 1430, 4235], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3831, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3749, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3934, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3863, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 341, 6438, 7317, 8602,  342, 6796, 2052,  694, 8473, 3324, 5826, 3259,
        2928, 2669, 1008, 3885, 4979, 8948, 7630, 7218, 3074, 6494, 8054, 3394,
        4020, 6417, 3909, 1260, 2203, 6336, 2394, 1683], device='cuda:1')
idx in forward tensor([8591, 7424, 4916, 1546, 8553, 8953, 5126, 2855, 2737, 6713, 6483, 2416,
        3423, 2593, 5864, 9138, 4017,  267, 6166, 6200, 2647, 4545, 2850, 3875,
        7077, 2875, 1728,  451, 1281, 7311, 6752, 8341], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forwardtext in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
 torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3730, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3632, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4024, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3967, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7775, 1405, 2796, 2131, 1066, 7573, 2556, 6713, 2613, 2833,  895, 4763,
        1242,  303, 5723, 7356, 6184, 8126, 3580, 4527, 3002, 2252, 2838, 6942,
          20, 3375, 4145, 1457,  258, 4694, 1157, 2040], device='cuda:0')
idx in forward tensor([8284, 7715, 5315, 1980, 8954, 6065, 6049, 2751, 4247, 4530, 4877, 9114,
        4522, 7970, 4061, 7325, 1104, 1999, 6586, 3415, 5496, 5158, 4137, 2673,
         135, 5222, 3175,  201, 4873, 8815, 9043, 8478], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4054, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3999, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3919, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3843, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3186, 4319, 3479, 1308, 1450, 6475, 6118, 7837, 3927, 5408, 7694, 5349,
        7316, 8587,   98, 1260, 5664, 3263, 2889, 4439, 7600, 3984, 1177, 5206,
        1187, 2092, 8809, 7491, 2022, 5783, 3987, 7956], device='cuda:0')
tensor([4580, 5788, 7385,  660, 4108, 8730, 4239, 9126, 7306, 4751, 9016, 3038,
        7476, 8440, 5795,  233, 6708, 7345,  191, 6557, 7775, 1840, 3509, 3280,
        7253, 4623, 5800, 7796, 1599, 4170, 2176, 8447], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3992, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3932, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3781, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3690, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1823, 5462, 4009, 3824, 8058,   52, 2742, 6773, 7039, 8025, 8839, 5955,
        7947, 1388, 2076, 7572, 5453, 2781, 2321,  513, 5386, 5061, 8055, 1186,
        7755, 5029, 6341, 5879, 4252, 7256, 9036, 1064], device='cuda:1')
tensor([3697,  715, 7385, 1040, 2459, 6313, 4654, 2424, 2751, 1482, 3558,  875,
        3698, 3838, 6297, 1112, 7947, 7198, 6085, 5920, 4267,  562, 4622,  465,
        2056, 8609, 6633, 8910, 8359, 7296, 1757, 5173], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3934, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3872, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3851, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3767, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7852, 3990, 5414, 3996, 5400, 8979, 1509, 1111, 5361, 7588, 6626, 6512,
        2767, 4586, 2136, 8048, 5832, 2654, 2225,  716, 3534, 6124, 8432, 2014,
        2644, 4367, 2937, 2841, 5823, 5938, 3490,  243], device='cuda:0')
idx in forward tensor([8845, 8669, 5049, 7874, 8033, 2280, 2059, 1246, 8607,  223, 5686, 2837,
        3545, 5026, 6532, 5165, 8994,  773, 5879, 5718, 8746, 3658, 5931, 3261,
        3347, 3649, 6114, 3464, 4399, 1732, 8945, 3131], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3850, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3769, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3976, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3915, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2671, 4192, 4645, 6613, 5774, 4918, 5725, 1667, 5602, 2948, 6675, 1090,
        1669, 3340, 8811,  545, 3508, 2735, 4507, 4090, 6339, 4163, 7686, 7966,
        5036,  251, 7429, 1249, 5692, 3812, 7202, 1913], device='cuda:1')
tensor([7117, 5859, 5344, 6164, 5626, 4226, 7189, 6803, 4637, 2970, 7069, 1132,
        1012, 8619, 6268, 1996, 4798, 5749,  816, 6543,  226, 7188, 6736, 3707,
        6432, 5983, 6128, 9147, 5549, 6090, 4403, 6687], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3867, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3794, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3989, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3929, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2818, 2037, 6230,  888, 3268, 5873,  584, 6356, 6581,  713, 2982, 7309,
        6748, 5617, 3102, 8068, 8604,  871, 3879, 7372, 6672,  811, 1019, 5315,
        7752, 2398, 3480, 1886, 8741, 4373, 2079,  277], device='cuda:0')
tensor([7103, 3082,  274, 3624, 7070, 1577, 2656, 4263, 4679, 6405, 2393, 5688,
        5068, 5924, 8189, 6506, 8140, 5455,  935, 5049, 3398, 7681, 5590, 5512,
        8052, 8645, 5228, 6306, 4714, 3293, 4765, 8977], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3975, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3904, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3949, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3886, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3333, 9037, 7982,  803, 2699, 6036, 6396, 1593, 6290, 8733, 4484, 7270,
        7622, 8835, 2482, 3000, 1036, 5546,  434, 6721, 1742, 4035, 2766, 5047,
        8678, 3041, 4207, 8757, 7943,  649, 1324, 8291], device='cuda:0')
tensor([1626, 8939, 7043, 1211, 7031, 2334, 6425, 4629, 7611, 6069, 2587, 6932,
        3559, 5025, 1266, 8633, 4212, 4208, 3978, 4812, 7611, 5512, 1161, 8983,
        1221, 8971, 2864,  333, 7630, 6244, 2616, 2047], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3958, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3900, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4081, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4024, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7405, 1875, 5091, 3361, 1613, 8979, 3589, 2320, 4398, 4419, 5682, 6456,
        6430, 3561, 5057, 4183, 1254, 5612, 7164, 6615,  782, 7221,  161, 7601,
        2356, 7691, 6913, 2540, 1578, 1051, 7692, 6096], device='cuda:0')
idx in forward tensor([7937, 2008, 9138, 7034,   10, 3138, 8282, 5223, 2871, 2603, 7430, 8395,
        8106, 4007,  874, 8326, 1413, 3009, 5022, 9102, 6994, 8547, 8592,  390,
        2966, 4057, 3051, 7691, 3285, 1363, 3817, 2277], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3945, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3865, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3881, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3804, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5335, 3316, 1482, 6379, 2201, 3083, 5031, 8808, 1729, 3486, 2795, 7837,
        4084,  885, 5718, 1536, 5576,  588, 2932,  778, 2201, 4820, 3617, 8723,
          12,  362, 5630, 1918, 7678, 8086, 5437, 7200], device='cuda:0')
idx in forward tensor([2519, 4875, 5835, 7689, 2661, 4039, 7872, 7080, 4210, 2732, 5730, 5090,
        4320, 6141, 1472, 4083, 5994, 4278, 2199, 2279, 8646, 1391,  115, 3108,
        6434, 3188, 7489, 6195, 4151, 6450, 6705, 7160], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3916, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3847, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3978, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3909, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([3767, 1901, 1882, 8178, 6222, 7921, 1159, 6988, 8764, 1210, 8873, 8691,
        5267, 2120, 3411, 4823, 6912, 2516,  778, 8058,   63, 6847, 8633, 8864,
        9031, 2115, 4991, 7696, 7339, 8772, 7798, 6688], device='cuda:0')
idx in forward tensor([7676, 8841, 3970, 2736, 1542, 6963, 1674, 6007, 6179, 3425, 6527, 9011,
        5424, 1080, 8703, 5550, 7928, 7604, 6113, 2303, 6169, 9012, 7442, 7488,
        5689, 1897, 3106, 2878, 6905, 8815, 5145, 3199], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3904, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3844, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4061, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4004, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1729, 1414, 7291, 1956, 1736, 7760, 6617, 6835,  556, 5759, 2933, 4409,
        1322, 8732, 7894, 1746, 4809, 1353, 4516,  903, 6780, 1979, 4912,  417,
         680, 2037, 3247, 5377, 2180,  775, 1049, 5194], device='cuda:0')
tensor([1575, 6265, 2312,  140, 4063,   54, 5440, 9026, 6755, 7125, 3490, 4996,
          17, 5748, 8287, 9088, 2536, 6878,  101, 2574, 4236, 2714, 2810, 2079,
        8520, 2993, 4893,  777,  535, 5397, 7220, 6945], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3980, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3923, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3792, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3695, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 912, 4517,  685, 7806, 5917, 4424, 6104, 7451, 8758, 7190, 2483, 2256,
        4401,  210, 7387, 3338,  894, 4936, 5028, 8571, 7435, 4132, 1775, 2023,
        7318, 7996, 2593, 4593, 4862, 1132, 7985, 1974], device='cuda:0')
idx in forward tensor([3826, 7241, 5449, 3764, 4605, 7523, 7785, 2220, 1031, 9079, 4509, 9026,
        8763, 5382, 7671,   40, 4628, 3789, 5343, 1227, 3957,  628, 8889, 8441,
        6674, 7836, 7091, 4696, 9069,  174, 5042, 1996], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3816, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3741, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3898, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3822, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([1068, 1874, 1679, 8174, 8508, 1513,   58, 1628,  570, 1705, 7396, 2201,
        7508, 1924, 3683, 3792, 8202, 2281, 5346, 6707, 6944, 3232, 7673, 8290,
        1426, 6185, 9071, 5988, 1902, 8959, 6384, 6825], device='cuda:0')
idx in forward tensor([1017, 6165, 7929, 5268, 6804,  244, 7546, 5045, 8017, 4704, 2668, 3176,
        6770, 4818, 3738,  306, 8672, 1065, 7884, 8976, 6438, 8503,  693, 4270,
        6603, 2258, 6456, 4016, 5720, 5002,   87, 5939], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3836, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3778, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3943, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3877, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6472, 3523, 5211, 7451, 8264,  707, 6370, 6816, 8740, 6079, 7074, 7847,
        1356, 4643, 5224, 6481, 3145, 5449, 5083, 3303, 4411, 6357, 8867, 3981,
        7017, 7332, 2794, 7274, 1960, 8014, 4374, 5918], device='cuda:0')
tensor([2567,   92, 4172, 2612, 1819, 3537, 5178, 1081, 3356, 7819, 1804, 3564,
        2867, 8461, 4608,  983, 4586, 3623, 6387, 8752, 8398, 1306, 6421, 3245,
        2747, 3507, 3602, 3716, 8301, 3470, 1071,  587], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3872, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3795, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3827, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3743, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7375, 6973, 4902, 1503,  507, 5643, 2285,  765, 4827, 1608, 4923, 1045,
        1421, 1256, 2899, 8713, 8278,  462, 2860, 1229, 7778, 1388,  993, 2521,
        5180, 7194, 5405, 7703, 8631, 3843, 5309, 2199], device='cuda:0')
tensor([5110, 7273, 3389, 4549, 2726, 2722, 4329, 2972, 2216, 1591,  514, 2702,
        4700, 7846, 1769, 3291, 4132, 2931, 7558, 3600, 6192, 8974, 6986,  864,
        4515, 3592, 8161, 4558, 5562,  248, 4949, 6312], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3971, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3906, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3918, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3849, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3622, 3572, 4600, 6087, 6197, 5385, 8096, 9066, 6748, 3044, 3734, 8086,
        1109, 8187, 1867, 4645,  350, 7424, 8689, 2001, 1088, 4665, 8376, 8926,
        3438, 7135, 4903, 8254, 8093, 3815, 8378, 3988], device='cuda:0')
idx in forward tensor([2615, 8917, 1479, 3922, 5363,  117, 1362, 4600, 6665, 5580, 3109, 1675,
        3159, 3929, 3591, 5710, 8950, 1390, 3299,  984, 3345, 6584, 4018, 4118,
        7248, 9023, 5476, 8066, 6227, 3295, 8628, 1464], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3987, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3911, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3824, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3744, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8531,  342, 2889, 7285, 1920, 5503, 4800, 2788, 6111, 3220, 7827, 7778,
        3649, 4775,  646, 2193, 1972, 5778, 3153, 5033,  636, 5412, 3355, 7607,
        8723,  932, 4697, 2941,  380, 2590, 8246, 5552], device='cuda:1')
idx in forward tensor([8242,  396, 2265,  965, 3662, 8549, 5890, 9038, 1030, 7853, 3977, 3214,
        6659, 5048, 6712, 6756, 7988, 2286, 4149, 5559, 2825, 4778, 8471, 5143,
        2683, 4457, 7798,   24, 3796, 4822, 5407, 3013], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3953, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3895, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3905, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3837, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8995,  598,  739, 8383, 2661, 6211,  234, 1605,   74, 1000, 3200, 6490,
        1709, 7601, 7428, 8054, 7095, 2659, 1142, 4507, 6196, 5240,  391, 7842,
        2983, 8110, 1580, 9001, 1002, 8607, 4192, 6006], device='cuda:0')
idx in forward tensor([4756, 2261, 5877, 4862, 4963, 3793, 4473, 1864, 8389, 3227, 3302,  553,
        5564, 4463,  105, 9005,  752, 7826, 5001,  896, 1373, 4160, 2069, 1839,
        3663, 7360, 3378, 5831, 4639, 3445, 7021, 3358], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3961, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3891, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3902, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3826, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4691, 4841, 5923, 8891, 7201, 6436, 6923, 2963, 6169, 4868, 3332,  603,
        5543, 2191, 6206, 5069, 4699,  134, 7915, 6047,  493, 1801, 9010, 7168,
        6966, 8499, 2764, 8148, 1655, 3198, 3439, 6807], device='cuda:0')
idx in forward tensor([6557, 2586, 4183, 8006, 7782, 6560, 3931,  237, 6312, 6562, 2829, 5056,
        1899, 1899, 3424, 6727, 3969, 8654, 9056, 2718, 3497, 4248, 8475, 5622,
        2262,  777, 1800, 3236, 1989, 2320, 4193, 3862], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3857, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3782, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4045, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3990, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([3103, 2363, 2220, 1840, 1333, 4671, 8731, 5451, 5215, 1547,  147, 1019,
        2098, 8921, 5363, 4446, 8800, 9090, 8324, 6461, 1018, 1347, 4720, 7409,
        4884,   75, 8029, 4629, 8662, 4203, 1087, 3518], device='cuda:1')
idx in forward tensor([6578, 4877, 2252, 7866,  301, 6071, 6453,  490, 2490, 3123, 2724, 6187,
        6294,  240, 8122, 3761, 2955, 2893, 1566, 2707, 4562, 4505, 5669, 2054,
        8954, 3386, 8144, 6610, 3317, 1139, 8063, 1085], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3883, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3812, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3772, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3678, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2394, 2594, 7955, 7162, 4423, 4450, 3323, 6601, 6744, 8668, 1444, 6738,
        5055, 6666, 1303, 6808, 2315, 8125, 1536, 6573, 8027, 7138, 8890, 8093,
        7989,   37, 6327, 4453, 7869, 4553, 2349, 7298], device='cuda:0')
idx in forward tensor([5320, 4680,  457, 8626, 2676,  938, 2392,  312, 7434, 7643, 3620, 7783,
        2695, 1669, 5173, 9148,  733, 5624, 1610, 2855, 2076, 5706, 5230, 2865,
         856, 1119, 6159, 7111, 7744, 7716, 7519, 6240], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3871, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3784, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3804, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3728, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1900, 1853, 3306, 3185, 1307, 1177, 8617, 3462, 4469, 2662, 8073, 8830,
        7908, 8784, 7301, 5700, 3174, 4778, 2860, 6794, 5607, 3575,   10, 1008,
        6309, 3833, 7305, 5218, 7190, 1213,   27, 6522], device='cuda:1')
tensor([3063, 3324, 7672, 1048, 8082,  836,  574, 2587, 6868, 5575, 1032, 7469,
        7030, 1962, 4013, 7804, 7166, 6460, 5626, 6040, 2748, 6675, 2641, 6180,
         877, 6337,  379, 7871, 5280, 4003, 7235,  492], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3909, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3832, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3831, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3747, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8138, 3577, 3361, 4160, 6691, 5587, 4012, 8440, 4581, 2405,  364, 4540,
        6580, 5529, 5643, 2478, 1754, 8472, 7917, 7453, 3271, 1689, 1035, 8829,
         289, 3711,  883, 2638,  140, 8570,  478, 8046], device='cuda:1')
idx in forward tensor([8464, 5507,  580, 8624, 3353, 3628, 3090, 3076, 4219, 3274, 7177, 2718,
        7856, 8308, 3710, 4287, 7327, 5996, 1535,  423, 6363, 6747, 6566, 8966,
        2063, 1260, 1312, 6396, 7142, 8941, 2573, 2813], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3935, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3868, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3826, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3744, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 560, 4633, 2323, 3492, 2396, 4001, 3193, 1077, 8654, 6715, 6910, 5941,
        2154,   61, 5718, 3073, 8294, 7125, 8396, 6069, 8132, 6388, 6582, 7431,
         190, 5141, 1532, 4264,   12,  527, 7500, 1874], device='cuda:0')
tensor([2587, 3647, 3825, 2463, 6746, 4914, 6137, 5243, 2478, 6824, 8334, 7176,
        5096, 6730, 1895, 2785, 4793, 4784, 7438, 7304, 7894, 5256, 4042, 2425,
        1412, 1963, 5744, 2082, 1863, 8401,  681, 6670], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3639, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3518, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3850, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3773, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([7393, 2247, 3903, 8681, 3715, 1208, 7831, 2332, 5001, 4128, 7054, 1798,
        6943, 8851, 4910, 6773, 2509, 3567, 5007, 7025, 1977, 5156,  354, 6655,
        6290, 2581, 6360, 8303, 4825, 7780, 1186, 5190], device='cuda:1')
idx in forward tensor([2327, 5508, 1357, 2740, 2717, 1793, 2357, 4551, 8102, 8568, 5489,  586,
        8247, 2004, 5293,  459, 1169, 6009, 7380, 7818, 2240, 2106, 5944, 2542,
        7186, 2470, 4328, 8462, 5841, 1344, 1521,   97], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3887, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3818, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3858, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3783, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4488, 3604, 3287, 3611, 5596, 7301, 5902,  805, 1489, 6573, 8146, 1041,
        3907, 3412, 1221, 1414, 6875, 3041, 6930, 2117, 4866, 8492, 2428, 3533,
        8493, 4133, 8325, 4558, 3642, 5642, 6937, 6833], device='cuda:0')
idx in forward tensor([1207, 2395, 4873, 8490, 8596,   15, 3156, 4560, 2065, 4215, 7274,  774,
        2638, 1217, 7283, 2821, 4395, 1698, 2731, 4866, 5736, 5459, 7481,  910,
        8100, 6580,  732,  613, 2724, 5908, 5643,  916], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3959, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3888, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3890, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3816, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6734, 4613, 8130, 1991, 8765, 6289, 1472, 4024, 7480, 8140, 7641, 4467,
        3334,  945,  801, 3216, 1314, 1560, 2380, 4543, 8451, 5694, 7349, 7610,
        5906, 1426, 4349, 1433, 7494, 5469, 7325, 2328], device='cuda:0')
tensor([8043, 8329, 5667, 3870, 7611,    0, 7132, 8827, 8109, 7371, 8032, 1170,
          54, 2912, 5639, 3145, 3009, 6401, 4661, 4292, 8285, 2412, 6390, 6443,
        5217, 2875, 7734, 6893, 7853, 3206, 6329, 5803], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3859, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3789, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3908, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3832, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3747, 2024, 6975, 6027, 7382, 8001, 9090, 5850, 6742, 3959,  658, 7763,
        8318, 6744, 4636, 8936, 3648, 7913, 4230, 5586, 2832, 4593, 3574, 2397,
        2404, 7102, 7881, 8277, 8751, 3860, 7721, 8358], device='cuda:0')
tensor([5151, 1300, 3591, 8938,  625, 6856, 2336, 6051,  482,  500, 2300,  183,
        5156, 3149,   80, 4254,  416,  143, 8142, 7494, 3757, 1614,  840,  445,
        2279, 7217,  325, 6793, 7791, 2951, 3092, 7917], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3859, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3777, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3803, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3722, device='cuda:1', grad_fn=<MeanBackward0>)
[32m2023-10-20T15:52:05 | utils.basic_utils: [0mTrain Epoch: [0]  [200/572]  eta: 0:54:19  lr: 0.000010  temperature: 0.0176  video-loss_ita: 2.4310  video-loss_itm: 0.5177  time: 7.6260  data: 0.0035  max mem: 33192 res mem: 33720
idx in forward tensor([2852, 2261, 7350, 3287, 4352,  385, 3648,   85, 7187, 4446, 6551, 2134,
        4274, 4066, 2392, 6966,  800, 6401,  180, 2291, 8505, 1331, 2099, 8266,
        7862, 6306, 2512, 3722, 3340, 5935, 1112, 3319], device='cuda:1')
idx in forward tensor([2862, 8524, 3284, 7635, 4201, 2750, 3344, 6064,  180, 7408,  919, 1293,
        2903, 5203,  311, 7539, 5228, 2362, 3171, 4271, 3108, 1480, 2971, 2367,
        6941, 4275,    7, 1435, 3065, 4402, 5646, 3239], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3836, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3750, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3889, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3809, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4830, 4872, 2961, 3347, 8197, 4036,  255, 4984, 4110, 5938, 3743, 2148,
        5573, 8292, 1750, 9019, 5864, 9114, 6104,  670, 6074, 5080, 3331, 2775,
        7258, 5174,  455, 4194, 3416, 1873, 6938, 4518], device='cuda:0')
idx in forward tensor([1936, 7134, 1246, 8086, 3780, 6932,  170, 3163,   18, 5780, 5120, 8548,
        8249, 5722, 1818, 8973, 2083, 6771, 4787, 2551,  630, 7844, 2283, 8800,
        7607, 5826, 3559,  343, 5780, 6272, 3027, 2435], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3847, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3780, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3796, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3712, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5203, 4437, 2170, 9147, 4627, 4255, 6242, 1681, 6195, 5292, 2228, 5167,
        8709,  301, 5982, 3546, 5579, 4081, 3033, 3126, 2862,  919, 7973, 8643,
        8900, 4762, 8101, 1304, 3456,  490, 2762, 1457], device='cuda:0')
idx in forward tensor([7193, 1518, 7093, 4501, 8996, 5333, 8527, 4282, 5039, 4675, 2673, 4330,
        7504, 3815, 4544, 2334, 6242, 6131, 7438, 1981, 6632, 2852, 2164, 4216,
        1423, 2835, 7590,  205,  594, 3025, 2477, 5020], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3932, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3860, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3833, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3746, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6782, 8457, 1831, 7227, 3216, 4648, 4099, 2998, 3831, 1298, 5295, 5566,
        2162,  971, 6338, 3804, 6552, 3724, 2117, 5747, 4807, 4721,  944,  794,
        5572, 5229, 8683, 4655, 7035, 5374, 7597, 8648], device='cuda:0')
tensor([ 280, 5758, 5344, 2020,  383, 1579, 5471, 4285, 8153, 6857,  132, 3126,
        7991, 4790, 4211,   35, 5762, 4446, 1128, 1956, 6232, 8880, 7971, 3836,
        4969, 8355, 4572, 7899,  676,  137, 2545, 2391], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3887, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3811, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3816, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3732, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4107, 3743,   76, 7649, 1745, 4735, 1816,   88, 6077, 8303, 5524, 6704,
        6021, 9138, 4071, 7489, 4432, 7357, 8509, 8913,  685, 5674, 5613, 8952,
        4033, 7209, 4352, 2355, 4885, 4646, 3993, 2487], device='cuda:0')
tensor([ 820, 4087, 1499, 2900, 6463, 8289, 1361, 4669, 1570, 4495, 1077, 5907,
        5930,  741,  813, 4022, 5427,  787, 5086, 3521, 5112, 4876, 3837, 5848,
        4415,  725,  881,  956, 2169,  288, 6940, 5633], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3822, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3739, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3901, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3823, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2211, 7592, 3377, 7826, 4590, 5698, 7554, 3118, 4686, 3034, 3652, 2878,
        4035, 8700,  434, 7505, 2956, 8882, 8764, 1362, 1777, 4289, 5690, 3780,
        3334, 6652, 9020, 6759, 3074, 8452,  212, 1778], device='cuda:0')
idx in forward tensor([6280, 5221, 3664, 5957, 3748, 8324, 2855, 2530, 8387, 1397,  503, 3054,
        7164, 7597,  741, 2404, 1031, 2781, 5586, 4327, 7933, 6414, 5460, 8019,
        8799, 6232, 5375, 8333, 7035, 7603, 2648, 6206], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3928, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3964, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3900, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3859, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5647, 2038, 5742, 6148, 1294, 3951, 7199, 5249,  208, 6679, 7233, 2697,
        5701, 6244, 6973, 7672, 6601, 6060, 1439, 9128, 1541, 1771, 6829, 7696,
        7882, 5485, 1133, 9110, 6233, 2798, 8449, 7927], device='cuda:0')
tensor([6538, 7121, 4823, 8220, 7365, 2135, 4174, 3396, 6548, 7270, 6311, 4385,
         807, 8297, 3139, 5945, 3371, 4228, 2778,  583, 8941, 9068, 5393,  381,
        2949, 4231, 2062, 4732, 3128, 6354, 2691, 2263], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3882, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3808, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3713, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3810, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8466, 5730, 4289, 1824, 7378, 6847, 8394, 1595, 4958, 1290, 1592, 1182,
        6194, 4868,  551, 1484, 7084, 4095, 9151, 4986, 6904, 1603, 5986, 5786,
        6662, 5916, 8698, 3821,  347, 7823, 7245, 3765], device='cuda:0')
idx in forward tensor([1706,  695, 8689, 5995, 1672, 1983, 6065, 5358,  428, 7655, 6141, 3292,
        1568, 8304,  168, 4945, 1763, 7182, 2347, 6050, 1073, 7450, 5653,  324,
        3601, 8589, 7522,  273, 8670, 4876, 3136,  817], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])

neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3851, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3771, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3938, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3874, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([   8, 2023, 5394, 7480, 2389, 1455, 4313, 5371, 8175, 4139, 2708, 1806,
        3790,  405, 1110, 8675, 8785, 8006, 3982, 4426, 7220, 8982, 7407, 8208,
        3189, 8267, 5209,  361, 3974, 7461, 8741, 5904], device='cuda:0')
tensor([4776, 1331, 3093, 6736, 6352, 3095, 2413, 2040, 1402, 2978, 2442, 5685,
        6869, 9085, 6379, 6121, 8799, 7139,  438, 6313, 1351, 2257,  875, 3295,
         596, 5943, 2074, 3441, 6149, 4163, 5112, 8707], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3850, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3772, device='cuda:1', grad_fn=<MeanBackward0>)
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3821, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3738, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6889, 8256,  904, 8001, 2415, 2890, 6385, 7012, 3336,  383, 6391, 8487,
        7383, 1902,  390, 3671, 2217, 2949,  527, 8147,  392, 8572, 2439, 2011,
        8926, 5343, 6990, 4108, 4439, 5388, 2617, 4634], device='cuda:0')
idx in forward tensor([3208, 5088, 2366, 8903, 5571, 4067, 6332, 7148, 2013, 2030, 8200, 5848,
        5537, 5226, 1042, 4944, 3766, 3903, 7425, 3615, 8437, 1386, 6656, 2784,
        3646, 3341,  328, 8625, 5920, 4348, 1095, 8266], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3818, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3729, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3946, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3866, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([7615,   26, 4792, 7108, 1527, 6068, 5839, 1498, 3004, 6401,  492, 7757,
        3302, 3087, 2276, 7602, 7449, 4954, 8926, 5218, 5530, 1739,  963, 4202,
         321, 4403, 2522, 3943, 1725, 3371, 1017, 6461], device='cuda:1')
idx in forward tensor([5719, 6310, 5034, 2398, 6306, 4512, 5298, 2357, 1371, 7857, 4445, 4165,
        3458, 3318, 1159, 1714,  443, 3112, 3220, 6284, 4023, 4400, 7872, 5488,
        2705, 6754, 1257, 5491, 4436, 3570, 3522, 2745], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3851, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3771, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3817, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3743, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([5597, 6225, 8732, 3446, 8848, 5004, 3821, 4364, 7725, 1925, 4032, 2901,
        8376,  524, 4582, 4787, 7815, 4991, 8562,    3, 3787, 9145, 1448, 2609,
        2048, 1653, 7259,  931, 2433, 2707, 7975, 2056], device='cuda:0')
idx in forward tensor([7114, 3085,  153, 5840,  349, 6717, 8126, 7981, 8359, 4549, 7028, 2895,
        2636, 5065, 7097, 4955, 2696, 1164, 1584, 2401, 5620, 4478, 7065, 7968,
        6016, 4517, 8279, 5658,  107, 4563, 3291, 4557], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3732, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3627, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3877, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3793, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([2631, 8977, 8319, 7865,  537, 8819, 6481, 8439, 6673, 8454, 4101, 5177,
        9023, 6497, 6745, 7543, 7033, 5035,  717, 1547, 3666, 8003, 9151, 6083,
        2705,  481, 6189, 6283, 2449, 6619, 6451, 4083], device='cuda:0')
idx in forward tensor([3585, 1237, 5585, 5636,  276, 8887, 2694,  633, 5698, 6107, 5260,  300,
        3070,  567, 8661, 4245, 7353, 5463, 5619, 2572, 6895,   61, 7830, 2289,
        7437, 6872, 7710, 7510, 1859, 8037, 1853,  207], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3869, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3792, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3973, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3907, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6336, 7955, 1765,  892, 6432, 1552, 6112, 5966,  253, 4896, 3518, 3469,
        8066, 3535, 2280, 4175, 7604, 5053, 4654, 1251, 2228, 1442, 8688, 1638,
        6918, 8635, 6938, 2727, 1632, 1334, 4915, 3976], device='cuda:1')
idx in forward tensor([5475, 1932, 3803, 6496,  253, 1849, 7062, 1335, 6147, 2402, 5143, 8526,
        5430, 5005, 2003, 7994, 7766, 5363, 2981, 6413, 5570, 5973, 7735, 3513,
        2384, 2952, 7962, 6157, 2569, 3832, 1681, 7498], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3974, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3906, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3827, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3748, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8108, 4548, 2279, 8099, 2297, 4722, 4526, 5738,  834, 1011, 1081, 3727,
        5373,  939, 5110, 5297,  936, 3113, 3360, 7225, 2379, 2084, 3310, 1343,
        7773, 2876, 4351, 8553, 5162, 6571,  171, 2870], device='cuda:0')
idx in forward tensor([2658,  120, 4568, 7689, 4771, 6229, 5623, 3914, 3312, 2458, 7495, 2314,
        4347, 6837, 6121, 8958, 8914, 1640, 5755, 7152, 7085, 3238, 9039, 6478,
        8169, 5051, 6181, 3547, 2428, 3142, 5535, 1790], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3951, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3881, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3987, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3924, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5392, 5081, 8129, 2987, 7618, 3564, 4893, 5698,  469, 1075, 5401, 5473,
        5431, 7331, 5483, 6567, 6371, 5884, 3765, 1889, 2664, 1947, 4462, 2620,
        1443, 3984, 6175, 6967, 1342, 4814, 4895,  353], device='cuda:0')
idx in forward tensor([ 884, 4860,  103, 9030, 2806, 4722, 7642, 8394, 8116,    4, 7326, 5772,
        6831, 8957,   26, 4519, 4504, 4506, 5565, 1921, 3739, 2581, 7521, 4786,
        1614, 6327,   90,  169, 1821, 4624, 8125, 7550], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3887, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3810, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3803, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3713, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6669, 1892, 5024, 6242, 4581, 8624, 6270, 2597, 8388,  447, 1142, 2160,
        3794, 1417, 2073, 5651, 2736, 1088, 7595, 5789, 7685, 1506, 9032, 2875,
        5502,  672, 7209, 8232, 1653, 7199, 1664, 6062], device='cuda:0')
idx in forward tensor([1569, 8356, 4266, 1228, 5680, 4011, 5917, 6509, 4371, 2659, 1144,  934,
        5781, 8873, 6217, 2358, 7129, 7526, 1560, 1513, 1035, 2978, 1195, 5523,
        5298, 4782, 6856, 5619, 5006,  342,  508, 3244], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3915, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3839, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3871, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3794, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([3317, 7240, 6615, 8322, 1010, 1837, 5863, 3520, 8794, 2963, 1606, 1989,
        6025, 2338, 1253,  577, 3661, 4395, 8258, 4499, 6650, 5368, 3288, 8576,
        3879, 2141, 2824, 6088, 2109, 8961, 6485, 4326], device='cuda:0')
idx in forward tensor([5542, 3699, 4955, 4168, 2294, 5127, 6080, 6990, 2268, 9151, 2331, 7453,
        8495, 4503, 8876, 1801, 7235, 5120,  142, 7816, 1711, 7068, 5418, 4140,
        5269,  256, 4810, 7849, 1231,  491, 6550, 8096], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3851, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3776, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3920, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3851, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([1179, 8220, 8234, 3440, 2041, 6424, 6104,  582, 7677, 2711,  735, 5039,
        8784,  703,  945,  195, 8300, 6261, 1379,  880, 7115, 4250, 5945, 4464,
        5645, 5954, 7990, 9128, 4458, 5620, 5977, 7936], device='cuda:1')
idx in forward tensor([4516,   18, 2315, 7662, 8991, 5384, 8877, 5092, 4106, 4764, 3742, 1471,
        8962, 7537, 5691, 7006, 1599, 1525, 1812, 1748, 4100,  400, 7494, 8924,
        3181, 8195, 5931, 6323, 3337, 3410, 3073,  160], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3884, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3802, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3855, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3769, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2575, 2729, 8576, 6735, 3010, 8158, 4767, 1444, 4848, 8846, 1248, 4877,
        5433, 2895, 4915, 7652, 3465, 3201,  157, 6059, 7980, 4757, 4334, 1288,
        5019, 3245, 9035, 2959, 3031, 2567, 8586, 8222], device='cuda:1')
tensor([5064, 6328, 5809, 4258, 4435, 8249, 8373, 1257, 3400, 1856, 2707, 7395,
        2490,  873, 3344, 8488, 4029, 3391, 9124, 8752, 1297, 6685, 2436,  607,
        5212, 8089, 1555, 6654, 7002, 8557, 2757, 2047], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3906, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3825, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3914, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3846, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3935, 8583, 4056, 4178, 2562, 2314, 3670, 2992, 3276, 3108, 8953, 2407,
        2642, 1122, 7179, 2866,  724, 7618, 7516, 4423, 7654, 8563, 3924, 4865,
        2167, 6713, 6937,  524, 6155, 2605, 1967, 8293], device='cuda:1')
tensor([3484, 5417, 6855, 5354, 1239, 4190,   38, 4972, 6550, 1077, 2939, 8888,
        6100,  556, 5394, 4664, 8498, 4054, 8622, 6390, 2826,  326, 7539, 2755,
        2873, 7858, 8596, 6951, 1240, 8681, 3436, 7339], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3994, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3891, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3814, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3932, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7003, 7447,  984, 2897, 8323, 6772, 4125, 1362, 4469, 3055,  610, 6158,
        7789, 7150,  277, 7509, 7334, 2308, 5677, 6105,  127, 6385, 3562, 9126,
        5578, 8608, 6914, 7261,  844,  490, 7433, 6158], device='cuda:1')
idx in forward tensor([2146, 8504, 8384, 8497, 6489, 3037, 8543, 2306, 7001, 8554, 5477, 8187,
        3062, 2501, 2628, 3356, 5191, 4792, 6783, 3345, 2051, 5333, 1334, 5266,
        8488, 7317, 1139, 6595,  576, 6879,  130, 6385], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3872, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3800, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3776, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3683, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([ 952, 4007, 3233, 2036, 7627, 3539, 8156, 7395, 2029, 8769, 7354, 4849,
        7832, 6339, 3697, 1029, 8192, 7838, 2872, 5891,  497, 8699, 1501, 1223,
        5663, 5581, 3271, 7251,  363, 7457, 1199, 2428], device='cuda:0')
idx in forward tensor([3536,   29, 2760, 3746,  995, 5527, 5421, 7762,  193, 4635, 6428, 2543,
         649, 1668, 1299, 5035, 6622, 6694, 1671, 1107, 4641, 7561, 1631,  493,
        8668, 4766,  103, 1446, 1944,  615, 8170, 6992], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3827, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3748, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3917, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3849, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([7380, 1570, 1433, 4750, 8927, 5801, 7986, 7484, 1179, 6796, 2498, 3436,
        6240, 4148, 7759, 3377, 5731, 3366, 4562, 2148, 4916, 4703, 1354, 8468,
        7631, 3852,  723, 5264, 2757, 2622, 1217, 3670], device='cuda:1')
idx in forward tensor([8762, 1486, 8296, 1113, 7608,  596, 4741, 1166, 4313, 1830, 4944, 5358,
         446, 4799, 4641, 6817, 6621, 7188, 6315, 7050, 7242,  723, 5970, 4148,
         364, 6595, 4807, 5644, 7861, 3779, 3841, 6190], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3856, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3784, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3896, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3822, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2861, 2329, 1445, 2211, 2013, 1517, 2594, 7682, 3193, 8591, 8996, 9105,
         521, 4336, 6538, 5312, 8047, 1568, 6722, 8574, 1131, 5089, 4744, 8518,
        4963, 8439, 1959, 2191, 6968, 7064, 7850, 5286], device='cuda:0')
idx in forward tensor([4006,  777, 3449, 6296, 9094, 8892, 2709, 2810, 8233, 6797,   52, 5397,
        4049, 5701, 8898, 8449, 4188, 7484, 5126, 4250, 5365, 3539, 5348, 2511,
        2278, 5085, 8963,  210, 3662, 6034, 8017, 2447], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3920, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3844, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3900, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3814, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([1752, 1911, 7452, 4026, 4592, 7219, 6129, 3483, 2981, 3333, 8014, 9061,
        4916, 6500, 8469, 5220, 8004, 1128, 4791, 1022, 6606, 6112, 4431,  451,
        5188, 8419, 8231, 3308, 7482, 1941, 5896, 7562], device='cuda:0')
idx in forward tensor([4696, 7296, 5090, 4225, 6478, 4655, 1015, 1375, 4870, 3861, 2477, 8000,
        5760, 2599,  155, 3701,  975, 5071, 5133, 1994, 2411, 1982, 1705, 2507,
        1367,  876, 1881, 8372, 8339, 1387, 4523, 3629], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3909, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3830, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3836, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3761, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3875,  414, 6903, 1652, 7565, 5761, 2578, 5296,  211, 3907, 7414,  897,
        6693, 4482, 3859, 6947, 7774, 4309, 5950,  574, 2108, 3598, 3566, 7903,
        5965, 2460, 5033, 4803, 3681, 5236, 1434, 2259], device='cuda:0')
idx in forward tensor([4656, 4057, 2200, 2314, 2523, 7825, 4802, 5859, 6044, 3726, 3849, 8369,
         184, 4971, 8216, 8399,  419, 1038, 6076, 5649, 7701, 3479, 4054, 1005,
        3050, 4447, 5503, 5857, 7280, 3573, 3070, 7823], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3820, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3741, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3939, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3871, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 996, 4520, 7973, 3619, 5186,  909, 3046, 3114, 2996,  561, 5057, 6181,
        3865, 4672, 9046, 8463, 2628, 1587,  179, 8479, 2685, 8776, 5582, 2827,
        5123, 5460, 6916, 6302, 4321, 5577,  422, 1602], device='cuda:0')
idx in forward tensor([8795, 7874, 7033, 4004, 5599, 1165, 5277, 8868, 7009, 2443, 1808, 4278,
        7562, 5483, 1424, 6482, 6778, 4456,  342, 5347, 6368, 5949, 8094, 5800,
        1814, 7077, 3500, 6896,  102, 2057, 2593, 8057], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3839, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3757, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3889, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3816, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2907, 6323, 5407, 4542, 2405,  477, 6589, 7246, 5802, 1338,  517, 7068,
        5729, 2473, 3352, 3267, 2856, 7682, 4524, 8355, 5170, 9117,  957, 8686,
        5044, 2304, 7542, 6353, 4130, 4407, 7917, 3221], device='cuda:0')
tensor([4165, 2915, 2901, 1687, 2161, 8054, 6435,  849, 2814, 1006, 1237, 8117,
        6318, 2551,  878, 2910, 1973, 5540, 6585, 7499, 5113, 9045,  108, 2723,
        6719, 6449, 2199, 4727, 4626, 2604, 1485, 1803], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3890, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3824, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3810, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3733, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7658, 6846, 2052, 8561, 5741, 5770, 7593, 8306,  570, 4476, 5412, 2792,
        3049, 4621, 2629, 1125, 2965, 2284, 8301, 5168, 8395, 6494, 7989, 8177,
        7956, 5483, 8854, 2441, 4582, 5830, 6183, 2804], device='cuda:0')
idx in forward tensor([3520, 2303, 8278, 2925, 6553, 5737, 3769, 7564, 2453, 6028, 3857, 8121,
        8326, 5211, 2156, 7980,  858, 2273, 5541, 5222, 6903, 2844, 4316, 6814,
        3599, 5597, 6169, 4901, 8904, 2413, 6360, 2124], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3880, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3800, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3879, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3791, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([7688, 2533, 2840, 7891, 6408, 1303,  189, 3584, 1084, 3539, 8504, 5155,
        8226, 7702, 1027, 6576, 7036, 3543, 5481, 5411, 5508,  790, 2206, 3305,
        8753, 4688, 1470, 7549, 6676,  620, 2144, 7969], device='cuda:0')
idx in forward tensor([  88, 3652,  429, 2912, 7064,  830, 8918, 2213, 2128, 1309, 1744, 2755,
        8162, 1232, 1335, 2620, 8254, 3796, 3387, 7006, 3112, 6870, 8634, 3519,
        4525,  861, 7505, 7355, 1605, 9017, 7266, 5729], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3967, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3900, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3864, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3777, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5295,  197, 5546, 7067, 9091, 1235, 5023, 5180,  998,   60, 3234, 1062,
        1648, 5391, 3588, 4701,  906, 4517, 8271, 1226, 2426, 7445, 4283, 1838,
        4441, 3970, 2811, 1210, 6555, 6612, 5868, 2948], device='cuda:0')
idx in forward tensor([4198,  514, 4357, 3304, 4271, 3208, 7393, 6046, 2389, 3926, 8080, 2467,
        1729, 7933, 8379, 6246, 4753, 2996, 3169, 5438, 1986, 1837, 6858, 1551,
        8072, 4525, 2581, 2506, 3997, 7765, 7670, 4059], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3843, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3755, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3740, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3641, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([9102, 1407, 1667, 5968, 2171, 8534, 3437, 1231, 4257, 9150, 1086, 8778,
        3446, 9122, 3428, 2060, 4180,  854, 8728,  369, 8454, 1175, 6208, 7061,
        8859, 1888, 1089, 2539,  251,  126, 2581, 1590], device='cuda:0')
idx in forward tensor([3399, 5212, 1945, 1082, 6159, 1916, 5953, 3681, 3133, 8627, 4168, 3509,
        3791, 9126, 3672, 5473, 9040, 3341, 6933,  657, 4497, 7924, 8156, 3093,
        2543, 5277, 8064, 6231, 8685, 4027, 2655, 3733], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3925, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3853, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3882, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3814, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5231, 3819,  336, 5664, 3989, 4815, 2604, 8782, 5425, 7908, 5712, 5912,
        2297, 3823, 6649, 6487, 7635, 8725, 4695, 5314, 2710, 8860, 4243, 6422,
        4510, 7399, 4131, 3675, 5166, 8501, 6522, 5021], device='cuda:0')
idx in forward tensor([4588, 7031, 8360, 1016, 6136, 1750, 3362, 8698, 8804, 1856, 2821, 3645,
        1700, 5972, 6964, 7271, 8585, 3279,  995, 5140, 8164, 7722, 6598,  550,
        2922, 5035, 2781, 6919, 4055,   98, 3873,  440], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3895, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3815, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3880, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3808, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7522,  356,  767, 3406, 8944, 1021, 6208, 4741, 3379, 3380, 1842,   81,
        6454, 1185, 5221, 7676, 4429, 4528, 7234, 3979, 1761, 2790, 1902, 2996,
          39, 5787, 2391, 5540, 5124, 7523, 2200, 4302], device='cuda:0')
tensor([1589, 1923, 7932, 7444, 4607, 6515, 4908, 4910, 8357, 8245, 4087, 5302,
        2373, 7065, 8178, 7912, 6229, 4215, 5939, 6520, 3401,  589, 5971,  610,
        8997, 3359, 9135, 7225, 2716, 5610, 8667, 8527], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3717, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3628, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3871, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3799, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5037, 5006, 3294,  991, 1018, 6271, 4214, 2717, 4844, 5717, 3497, 5276,
        1436, 2923, 1584, 5161, 8204, 7458, 8393, 5849, 8439, 8536, 6809, 4261,
        5979, 5031, 4951, 8990, 4488, 6280, 3326,  824], device='cuda:0')
tensor([9087, 1132, 6247, 8854, 2619, 4694, 8763, 6287, 7302, 6369, 3092, 2331,
        7803, 2684, 5135, 2004, 7193,  121, 4815, 2519, 1409, 6228, 6660, 6124,
        8051, 6477, 7413, 1293, 4404, 5735, 4969, 3210], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3831, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3738, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3780, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3695, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([7559, 3592, 7442, 1358, 1451, 2839, 1087, 8075, 3157, 1736, 8089,  233,
        8296,  427, 5000,  821, 3637, 2414, 7940, 2475, 1629, 2645, 1198, 2488,
         423, 4934, 6117, 5108, 8124, 1568, 7092,  514], device='cuda:0')
idx in forward tensor([7569, 7939, 1397, 4552, 6885, 8958, 2715, 5355, 7418, 4429, 8235, 7571,
        5782, 1176, 1912, 1353, 9146, 8868, 6585, 3203, 8036, 7174, 6819, 3001,
        8206, 5282, 2797, 2510, 6634, 2088, 5920, 4394], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3879, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3801, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3871, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3799, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5649,  587, 8920, 3688,  650, 5366, 5146, 1664, 2611, 5766, 3109, 5545,
        5306, 7348, 6081, 5498, 3053, 7418, 6960, 8360, 1567, 5469, 8107, 3890,
        5175, 5904, 1381, 8892, 4929,  707,  771, 2872], device='cuda:0')
tensor([1253, 2479, 2980, 2952, 1296, 6544,  666, 2502, 6767, 3477, 6923, 4542,
        2523, 7818,  494, 7567, 1911, 2946, 6452, 8895, 8565, 8145,  714,  570,
        4753,  296,  903,  271, 6004, 4591, 7784, 1943], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3966, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3898, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3867, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3781, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([ 969, 2995, 7407, 2027, 4506, 8450,  479, 6827, 7198, 3161, 8789, 4187,
        1415, 3544, 1824, 5944, 5113, 6222, 2510,  306, 2328, 5011, 6723, 3139,
        5822, 5627, 6009, 4317, 5821, 4028, 7962, 1401], device='cuda:0')
idx in forward tensor([2415, 8172, 4062, 7197, 3579, 4306, 7815, 1402, 2121, 5814, 6602, 1857,
        7457, 4711,  151, 3160, 1566, 5244, 6586, 3171, 7692, 7856,  179, 2175,
        3791, 5828, 1641, 8818, 2504, 5565, 7082, 5591], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3900, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3818, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3752, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3662, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 207, 1943, 1908, 7633, 1198,  564, 1895, 2367, 4579, 7501, 2859,  808,
        6066, 8734, 7758, 2352, 8450, 7168, 1480, 5244, 2971, 7520, 8020, 8225,
        8641, 6423, 2738, 4977, 4090,  647, 8376, 9117], device='cuda:0')
tensor([ 994, 2697, 8492, 2545,  820, 8971, 7697, 2511, 3394, 5138, 1641, 4251,
        4823, 4693, 5140, 6540, 7505, 7606, 6338, 2957, 2874, 6099,  536, 5764,
        4445, 8496, 2644, 8317,  261, 6074, 1585, 1192], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3812, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3715, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3899, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3823, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7413, 2483, 9153, 4324, 6195, 5793, 9109, 5301, 3890, 8769, 3756,  557,
        3855, 4186, 6476, 1966,  683, 2298, 8353, 2110, 8539, 6465, 4111,  665,
         139, 4659, 6847, 9141, 7139, 5346,  687, 1330], device='cuda:0')
tensor([5213, 9037, 9056,  464, 1871, 5570,  109, 8983, 1681, 7124, 4865, 5845,
         397, 2726, 8142, 6046, 3203, 5855, 2266, 3810, 5036, 3632, 4246, 5403,
        3596, 7574, 6405, 7031, 1348, 8584, 8244, 2160], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3945, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3878, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3879, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3810, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4715, 5262,  832, 5704, 2070, 8421, 4983, 5476,   15, 9027, 3942, 3107,
        4209, 7184, 8891, 1716, 2674, 6447, 1240, 6509, 3622, 7003, 6789, 4871,
        5832, 8421, 8469,  510, 6127, 5199, 3826, 4998], device='cuda:0')
idx in forward tensor([7232, 6544, 3225, 3819, 5134, 3211, 1004, 1532, 5085, 7207, 7183, 4835,
        2143, 3137, 4434, 6203, 5245, 8961, 6176, 7923, 8658, 8336,  466, 3656,
        7157, 6271, 1984,  986, 3542,  455,  930, 8008], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3999, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3938, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3809, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3730, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3964, 4099, 5506, 4232, 9123, 2815, 7752, 8426,  662, 6987, 8491, 2955,
         516, 6526,  547, 3346,  141, 1417,  596, 8592, 1401, 6199, 8580, 8781,
        9026, 2473, 4882, 2429, 4353, 3731, 1879, 6213], device='cuda:0')
tensor([4746, 1325, 5303, 8382,  949, 4421, 4646, 4602, 8460, 7032, 3719, 2452,
        2770, 2404,  938, 5884, 7487, 9008,  403, 3528,  701, 7167, 3906, 1653,
        2672, 8221, 6754, 6567, 7824, 3103, 1746, 2398], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3885, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3803, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3771, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3690, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8862, 7812, 8484, 1092, 8091, 2264, 1285,  282, 7006, 6199, 4765, 2102,
        8499, 3486, 3211, 6868, 4834, 8717, 7265, 1922,  471,  968, 5865, 2909,
        8411, 4587, 3351, 1541, 6089, 2906,  640, 4887], device='cuda:1')
idx in forward tensor([8194, 7014, 4422, 1269, 6825,  755, 7780, 3886, 8956, 2172, 7066,  934,
        8886, 6526, 7526, 8951, 6246, 8267, 3006, 6822, 8328, 6085, 4119, 3378,
        2902, 3782, 6613,   96, 2293, 7380, 8159, 5312], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3803, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3710, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3812, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3725, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([7971, 1489,  939, 2985, 7846, 5400, 3858,  512, 1813, 3416, 6126, 1393,
        6132, 6518, 8003, 4762, 5293, 5455, 5311, 1381, 4790, 3290, 4567, 7500,
         621, 4933, 1476, 1257, 2662, 9062, 6970, 5892], device='cuda:0')
idx in forward tensor([3788, 5578, 2471, 3835, 7182, 6652,  111,  534, 2064, 7607, 7513, 7517,
        9110, 4188, 8896, 1296, 3197, 3720,  233, 8286, 4789, 7130, 2631, 7949,
        3666, 2584, 5602, 4323, 4541,  687, 9079, 6482], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3702, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3603, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4029, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3966, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 372, 4022, 8228, 6193, 3631,  343, 4826, 8508, 6166, 4959, 7186, 6446,
        2893, 1844, 2570, 7719,  762,  890, 3293, 4262,  740, 4754, 7634, 4247,
        6834, 8359, 8750, 1991, 1192, 4477, 5867,  518], device='cuda:1')
idx in forward tensor([4556, 6665,  414, 2393, 7682, 9033, 3741, 6485, 6495, 8712, 8214, 4807,
        4207, 2767, 9013, 6681, 2122, 2412, 1369, 3764, 5430, 1200, 8310, 6055,
         444,  597, 4275, 7534, 8999, 1126, 8362, 7203], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3972, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3915, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3866, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3784, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8180, 1301, 8911, 5400, 3211, 9030, 9139, 3850,  449, 3598, 8223, 9136,
        5967, 3360,  653,  631, 6349, 6226, 8723, 1898, 8849, 4762, 2349, 7456,
        5464, 2755, 7045, 2598, 6781, 1805, 5340, 3441], device='cuda:0')
idx in forward tensor([2332, 5650, 1833,  517, 2232, 8957, 3947, 1156, 8362, 9015, 7670, 1580,
        3995,  374, 1423, 6889, 7761,  394, 4019,  207, 6880, 4494, 6128, 6033,
        6398, 2740, 1342, 6596, 3877, 7108, 8072, 1942], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forwardtext in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
 torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3849, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3773, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3840, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3765, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2568, 1611, 2371, 5272, 5242, 5219, 2905, 8693, 7019, 5306, 8428,  917,
        6025, 5710, 1847, 7867,  431,  829, 2278, 2041, 7100, 1572, 8706, 8149,
        2306,  833, 6512, 2420,  857, 2579, 3844, 4794], device='cuda:0')
tensor([ 162, 7455, 7604,  632, 8862,  568, 1274, 6456, 5037, 4603, 2965, 4667,
        5371, 4718, 3589, 9060, 3370, 3014, 1162, 6997,  823,   40, 5466, 2564,
         464,   10, 5270,  121, 6471, 2875, 1986, 1746], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3762, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3664, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3877, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3812, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6047, 1037, 7446, 3544, 7007, 8787, 1494, 1473, 4559, 1808, 1035, 6318,
        6734, 1290, 7690, 7137, 7214, 5313, 8738, 8091, 7075, 2906, 6255, 5241,
        8857, 4290, 1329, 8627, 8015, 5437, 5883, 2456], device='cuda:0')
tensor([7410,  644, 3032, 5060, 4634, 7459,  355, 5230, 1731, 5605, 9040, 8360,
        2964, 9015, 8684, 6294, 1196, 6264, 3602, 4622, 3995,  707,  756, 9098,
        3966, 7196, 5636, 2167, 5186, 8162, 2991, 4338], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3943, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3877, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3868, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3792, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5946,  924, 3752, 1997, 8071, 4859, 3138, 4941, 2646,  631, 5509, 7726,
        5043, 4826, 7417, 8350,  187, 6460, 7657, 6691, 8802, 1974, 2260, 8122,
         134, 5201, 8811, 8929, 2070, 3083, 2911, 7935], device='cuda:0')
idx in forward tensor([4407, 6337, 3616, 2595, 3583, 3038, 3987, 8593, 1997, 5519,  676, 4455,
         412, 4223, 1721,  387, 2904, 7986, 3418, 6471, 2318, 1479, 1086, 5808,
        7849,  669, 2015, 2337, 4630, 3522, 9152, 2758], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3884, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3810, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4007, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3950, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2519, 2307, 2723, 7437, 7512, 1286, 7693, 5969, 8390, 7824, 4051,  729,
        4489,  161, 6873, 1544, 5149, 6798, 6549, 2700, 6048, 2206, 5150, 5775,
        8915, 4272, 1020, 6694, 3870, 3451, 6416, 7251], device='cuda:1')
tensor([8193, 4073, 7900, 3327, 7115, 8279, 6132, 7748, 6540, 7043, 7754, 1248,
        5754, 3967, 7206, 3696, 7658, 1001, 7732, 3059,  379, 4064, 7571, 3237,
        4958, 6931, 1694, 4365, 8612, 5967, 7605, 2009], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3943, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3870, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3883, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3800, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([6267,  156, 1564, 7161, 8379, 5536, 1301,  458, 3784, 1073, 7046, 2383,
        2058, 5552,  248, 7616,   74,  187, 7693, 6927, 5560,  202, 1462, 4934,
        7632, 8968, 9010, 2877, 4922, 6936, 4844,   55], device='cuda:0')
idx in forward tensor([5925, 7863, 6598, 2156, 5855, 1497, 2032, 1143, 1592, 7696, 8608,  500,
        7096, 1200, 5632, 2197, 6431, 7843, 2219, 3269, 8409,  837, 6544, 7042,
         931, 2650, 4857, 8807, 6493, 8697, 8895, 3188], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3800, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3701, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3780, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3692, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 419, 5568, 7457, 1339, 5182, 2440, 8759, 4421, 3527, 2476, 6189, 2723,
         942, 5118, 7129, 8478, 2308, 1350, 3040, 4427, 4509, 8609, 2528,  566,
        4783, 6257, 4830, 4812, 1032, 6063, 3454, 8387], device='cuda:0')
idx in forward tensor([5485, 8456, 7577, 2025, 7987, 3822, 3709, 6158, 8847, 7721, 2234, 8264,
        1730, 3809, 3557, 4193,  734, 5255,  716, 7867,  953, 6604, 3212, 6458,
        7708, 5915, 3002,  171, 2260,  590, 5717, 3891], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3832, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3755, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4077, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4024, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4259, 2914, 1819, 5167, 2736, 6918, 5307, 1794, 3027, 4751, 7728, 2784,
        6612,  583, 3799, 8009, 2264, 5116,  603, 1827, 7422, 3973, 4792,  325,
        2565, 6999, 7276, 8415, 8950, 5559, 4667, 7967], device='cuda:0')
tensor([ 380, 4849, 8827, 4096, 5975, 6764, 1941, 8587, 1306, 4150, 1299, 3565,
         368, 6740, 4356, 3905, 1797, 6163, 5889, 4989, 8638, 3951, 1738, 5225,
        1458, 6098, 5251,  102, 4012, 5725,  860, 8415], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3753, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3667, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3909, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3840, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3709, 5296, 1776, 7280, 8335, 4362, 5664, 2698, 2271, 3294, 7682, 7284,
        5159, 8575, 2308, 4580, 7746, 7728, 3764, 3614, 1066, 6272,  888, 9088,
        6028, 4123,   17, 5375, 1870,  562, 7433,  394], device='cuda:0')
idx in forward tensor([8158, 6252, 2674, 1131, 3200, 6136, 5104, 7411,   82, 4171, 4079, 3402,
        4583, 5095, 1809, 8262, 1957, 8422, 9093,  889, 6792, 7427, 8530, 4651,
        3151, 2728, 4481, 8577,  286, 3871, 2154,  159], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3867, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3786, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3884, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3815, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 866, 8410, 8803, 3248, 2585, 4451,  119, 2355, 8142, 5316, 1818, 6478,
        7338, 6003, 7118, 4873, 7907,  913, 5833, 3168, 4142,  669, 4225, 7531,
        1121, 3280,  129, 1916, 4199, 1685, 5506,  759], device='cuda:0')
tensor([8819, 9145, 1738, 6943,  775, 2660, 3392, 7090, 9150, 1275, 5418, 9004,
         323, 3076, 4574, 8962, 8145, 8721, 3455, 5210, 2547, 8528, 3529, 7023,
        4380,  874, 1313, 3473, 1685, 6525, 3923, 4808], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3783, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3693, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3680, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3588, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5955, 5876, 1527, 2325, 3709, 4027, 8488,  541, 5799,  298, 2166, 7502,
        1168,  510, 6157,  150, 2840, 2937, 8703, 1884,  568, 3614,  634,  459,
        9152, 1801, 7944,  486, 2183,  729,  969, 3267], device='cuda:1')
idx in forward tensor([3814, 1262, 3329,  442, 6333,  565, 6178, 7059, 9140,  399,   33, 8719,
        1001, 2879, 4932, 4444, 6277, 2107, 1359, 7032, 6924, 3397, 8606, 8209,
        6013, 5941, 1528,   71, 8061, 2021,  617, 7585], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3961, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3900, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4013, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3959, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2908,  527, 3936, 3350, 3625, 1396, 2457, 2657, 1250, 2633,  764, 3100,
        7704,   88, 2275, 5252, 5892, 5880,  546, 7856, 3180, 1717,   72, 2719,
        6401, 4952, 8337,   59, 8893, 9012, 8784,  279], device='cuda:1')
tensor([1750,  760, 3318, 4428, 5584, 1263,  110, 5456, 8920, 7878, 6607, 4824,
        2242, 7368, 7150, 8518, 5349, 6168, 6882, 7525, 1997, 8532, 6479, 1750,
        6844, 8347, 3640, 1667, 5878,  613, 2949, 1726], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3892, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3829, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3704, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3606, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([2322, 3955, 1490, 5538, 5921, 7471, 6771, 6452, 6692, 2157, 1684, 2293,
        7362, 2108, 8403, 5467, 8855, 3703, 4305, 3419,  544, 4209, 5770, 7384,
        1627, 7809, 4528,  649,  116, 6493, 4535, 6330], device='cuda:0')
idx in forward tensor([8570, 2876, 6528,  295, 8077, 3580, 2111, 8137, 4687, 1493, 8665, 1393,
        6108, 1298, 3869,  835,  396, 4044, 6669, 6749, 3654, 6928, 1816, 7875,
        3037, 9033, 3756,  676, 6737, 6775, 4368, 1277], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3879, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3810, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3996, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3935, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([1876, 1082,  222, 3894, 2950, 4088, 8539, 4606,  125,   65, 1015, 3582,
        2327,  439, 7190, 8876, 4314, 1053, 3257, 1149, 7762,  759, 4637, 3212,
         814, 2020, 1650, 5875, 4760, 6984, 8389, 1283], device='cuda:0')
idx in forward tensor([7727, 4286, 6677, 3417, 3659, 8797, 8041, 8680, 3758, 3600,  767, 7610,
        3849,   28, 2345,  158, 5443, 2982, 4615, 3896,  828, 7137, 2454, 2005,
        4341, 7278, 5706, 4410, 6403, 4806, 4432, 1319], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3904, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3835, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3894, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3823, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8068,  991, 8044, 9154, 4481, 8708, 2713, 4290, 4898, 8568,  561,  800,
        2252, 2394,  998,  374, 2388, 8716,  484, 5065, 6022, 2907, 3908,  571,
        4852, 1942, 2752,  344, 1518, 5279, 4766, 4167], device='cuda:1')
idx in forward tensor([6929, 2163, 5416, 8662,  479, 2513, 5910, 3515, 5796, 4989, 8897, 3803,
         339,  253, 2684, 4858,   62, 5372, 2782, 1537, 8024, 7782, 5092, 3907,
        7139, 4683, 5640, 8377,  124, 4261, 7501, 2413], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3841, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3773, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3960, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3894, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4892, 4626,  259,  571, 3082, 6225, 3437, 4047, 1522, 3218, 8459, 1165,
         928, 2650, 8773, 5366, 8147, 3868, 5913, 4610, 5816, 2656, 4358, 1047,
         923, 5536, 7281, 1386, 1586, 7758, 7115, 2952], device='cuda:0')
idx in forward tensor([ 614, 2223, 5137, 1624, 2303, 1686, 7896, 6420, 2063, 1268, 8691, 2108,
        4455, 2384, 7643, 4249, 6957, 6820, 5803, 4075,  843, 2154, 4353,  957,
        8676, 2818, 2921,  484, 7475, 8268, 1805, 6078], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3724, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3622, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3678, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3581, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 514, 6707,  672, 5301, 2060, 1312, 3426, 8059, 1381, 2253,  329, 3005,
         841, 4320, 8723, 5834, 4434,  100, 4889, 3746, 4931, 7075, 4533, 7196,
        8690,  836, 3120, 7098, 8470, 7078, 7196, 2337], device='cuda:0')
idx in forward tensor([3071, 2171, 8831, 7110, 7474, 4641, 5468, 1889, 5630, 3906, 8088,  521,
        6127, 6740, 7351, 3861, 9078, 3936, 7522, 5288, 5448,   86, 4384, 8519,
        5950, 5797, 6380, 1723, 8880, 5819,  425, 5845], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3867, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3782, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3869, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3792, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1759,  525, 5626,  757, 5799, 6937, 1965, 6488, 8444,  687, 7213, 1089,
        8989, 5051, 1500, 4600, 4913,  836,  769, 8631, 3476,  847, 7814, 8822,
        8662, 7581, 4456, 4885,  232, 8268, 2580, 5996], device='cuda:0')
tensor([2282, 6475, 2927, 7736, 3759, 4526, 7076, 2277,  698, 7620, 7981,  911,
         291, 8591, 1003, 2255, 4229, 2197, 1326, 5177, 3086, 1287, 2890,  845,
        1078, 2780, 6873, 5792, 6538, 1456, 7646, 5801], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3919, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3963, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3899, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3835, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6051, 3660, 4403, 5936, 7689, 1973, 4388, 5603, 3178, 5525, 5375, 4914,
        5499, 7581, 1603, 4316, 3380, 6644,   32,  717, 5704, 9105, 3994, 1225,
        7046,  573, 3983, 7464, 6823,  217, 7465,  648], device='cuda:1')
tensor([2935, 4137, 8695, 6665, 8389, 8692, 1683, 3730, 1792, 1977,  742,  287,
        3478, 1576, 3246,  801,  655, 4335, 4923, 5183, 5514, 1236, 2777, 2043,
        7051, 4838, 5181, 7938, 1152,  339, 4553, 7654], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3910, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3832, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3912, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3849, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([6814, 2256, 5828, 8233, 3045,  154, 4073, 8382, 6123, 3821, 1330, 5079,
        4041, 3335,  464, 6520, 3511, 5680, 8757, 1017,  114, 1954, 3052, 2130,
         888, 8850, 7144, 1056, 1488, 4666, 5076, 6498], device='cuda:1')
idx in forward tensor([ 282, 2632,   27, 8841, 2931, 5118, 6728, 6474, 1205, 9101, 7209, 2932,
        2752, 1016, 8029, 6953,  567, 7412, 2461, 9096, 2225, 6659,  105, 1078,
        2407, 2959, 8239, 1419, 7786, 7408, 6366, 2746], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3944, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3878, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3857, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3778, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([1829, 5378, 4131, 1809,  623, 1355, 3745, 6357, 1214, 3699, 3488,  337,
        2287, 1461, 4274,  235, 4942, 1237, 1938,   67, 6806, 6305, 5040, 6319,
        7603, 5611, 4743, 3208,  981, 4956, 4845, 6855], device='cuda:0')
idx in forward tensor([1600, 5753, 6214, 5762, 6223, 1554, 4905, 6074, 4388,  268, 5890, 2536,
        5442, 5250, 8485, 2506, 3787, 3117, 6527, 7631, 7668, 7986, 7616,  933,
        8610,  292, 1676, 4532, 6198, 7967, 1609, 5639], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3855, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3784, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3830, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3750, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5854, 7119, 9147,  435, 1487, 5275, 4716, 8322, 8579, 5550, 6029, 2057,
        6035, 5036, 7134, 6616, 3103,  236, 5057, 5164, 1048, 6706, 4660, 7688,
         156, 4672, 5820, 8121, 8514, 9131, 7144, 1868], device='cuda:1')
tensor([1136, 1432, 3553, 5180, 5940, 1763, 8825, 1858, 2359, 1063, 4740, 5212,
        7286, 2064, 4465, 4536, 8110, 1191, 6232, 2796,  103, 4734, 1926, 2068,
        7158,  261, 4011, 1662, 1918, 1550, 3035, 3180], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3945, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3880, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3931, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3854, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3314, 6931, 6349, 3936,  355, 8183, 3471, 8491, 5829, 8694, 8290, 8040,
        1002, 5502, 5567, 5641, 5681, 2874, 6251, 6538, 2736, 7884, 2124, 8409,
        2318, 6605, 2278, 7174, 2445, 2443, 4949, 4202], device='cuda:0')
tensor([3674, 7104, 6797, 1880, 8798, 4309, 2103, 5910,  671, 3540, 2309, 2879,
        3325, 7140,  474, 5523, 5338, 4030, 8751,  846,   20, 4928, 1838, 7804,
        8566,  408, 2009, 3629, 5751, 3328, 8713, 5369], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3862, device='cuda:1', grad_fn=<NegBackward0>)loss_i2t_ori in get_contrastive_loss tensor(3.4045, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3991, device='cuda:0', grad_fn=<MeanBackward0>)

loss_i2t in get_contrastive_loss tensor(3.3789, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([6409, 5925, 6055, 1092, 8861,  569, 3333, 3641, 9056,   26, 4573,  227,
         344, 5405,  830, 8130,  238, 1548, 6700, 3201, 7822, 1025, 2082, 1845,
        6331, 4136, 5024, 3941, 6662, 5475, 2362, 8331], device='cuda:1')
idx in forward tensor([2100, 5283, 2020, 6712, 2403, 3052,  691, 5162, 8745, 2776, 5219, 5353,
        1616, 8954, 1930, 4146, 7772, 7610, 3113, 5184, 2161, 8017, 8601, 5765,
        2713, 1835, 6940, 5967, 4168, 3904, 8279, 1079], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3942, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3873, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3814, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3734, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([1691, 4215, 5804, 2588, 2899, 9084, 3071, 4816, 1156, 3520, 2395, 6427,
        4112, 5574, 2375, 8511, 3476, 3198, 1814, 1049, 8232, 1877, 4047, 1961,
        8959, 7155, 4960, 5279, 7892, 7631,  357, 6915], device='cuda:0')
idx in forward tensor([8596, 1305, 5726, 4749, 7527, 2194, 5247, 1555, 5299, 5120, 5979, 8190,
        6564, 7745, 6948, 8081, 4316, 8288, 3726, 2561, 2099, 1968, 2525, 6881,
         172, 5228, 6770, 1201, 5012,  384, 3552, 8170], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3979, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3915, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4010, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3950, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([7661, 2145, 2132, 7911,  809, 7001,  317, 8258, 8310, 8291, 1050,  940,
        6038, 7016, 1950, 2800, 7873, 3070, 8498, 4688, 5021,  723, 8577, 6948,
        2065, 5466, 4537, 4291, 4821, 3383, 5483, 7158], device='cuda:1')
idx in forward tensor([3678, 6058, 3236, 7925, 3690, 4131,  193, 3994, 1252, 4848,   48, 7722,
        9134, 6426,  793,    4, 4890,  466, 8721, 7490, 8407, 4417, 3303, 7310,
        5915,  502, 8582, 6466, 4200, 4601,    0, 6587], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3892, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3820, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3940, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3864, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([6333,  351, 1081, 3349, 4319,  104, 9128, 6032, 7614, 4585, 4311, 3122,
        5391, 3771, 6466,   69, 1879, 6945, 1550, 3977, 6053, 1507, 2261, 5542,
        1342, 6733, 3130, 2271, 1108, 5618, 8417, 8020], device='cuda:0')
idx in forward tensor([4312,  452, 6743, 6774, 8507,  423, 5825, 1789, 2685, 8045, 7480, 2080,
        4983, 2263, 3869, 3095, 2127, 6055, 2559, 9065, 8060, 3177, 7346, 1802,
        3954, 3608, 4398, 3563,  201, 1074, 8643, 5590], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3862, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3793, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4049, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3999, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4990, 1687, 6015, 2450, 3292, 2284, 2596, 6926, 5281, 4790, 7875, 2603,
        8753, 5802, 8629, 6927, 2171, 2482, 5003, 2592, 3568,  281, 4416,  516,
        5598, 4965, 2651, 4453, 3442, 3267, 2194, 2975], device='cuda:0')
tensor([1296,  545, 2065, 6371, 4153, 7771, 3620, 9094, 8759, 6319, 3461, 3759,
        2775, 7781, 6694,  192, 2198, 1665, 2735, 3421, 4305,  950, 8687, 6164,
        7957, 3760,  950, 5486, 7111, 6508, 6006, 2889], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3875, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3790, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4063, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4005, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1565,  538, 1550, 2761, 6953, 1335, 2853, 6308, 7863,  250, 2143, 8272,
        2713,  779, 5104, 2810,  326, 3103,  720, 8911, 7502, 2585, 5242, 3701,
        2058, 8040, 2237, 6204, 2229, 5961, 1901, 3803], device='cuda:0')
tensor([5901, 5827, 5240,  378, 5464, 5525, 2514, 3591, 8324,  527, 1298, 5307,
        2397, 6726, 2048, 1411, 5539, 6282, 5288, 1894, 4275, 5424, 4415, 8665,
        1666, 1265, 2396, 2793, 2350, 6465, 8004, 5330], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3845, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3759, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3857, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3782, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1481, 5574, 2648, 7051, 8307, 3293, 6262, 1019, 5031, 7023,  976, 4270,
        4492, 8337, 1951, 4965,  773, 7808, 6744, 2639, 8338, 6234,  205, 8174,
        1573, 8551, 4417,  768, 1214, 1719,  301, 5318], device='cuda:0')
tensor([6635,  415, 2250,  834, 7142, 6134, 7542, 6089, 1230, 6256, 4133, 6153,
        1267, 1069, 3253, 1947, 7294, 1453, 3667, 5061, 6028, 7881, 3901, 3715,
        7218, 8148, 3928, 6366, 6697, 7970, 1498, 7490], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])

loss_i2t_ori in get_contrastive_loss tensor(3.3793, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3705, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3784, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3693, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 221, 4341, 3096, 3540, 1421,  651, 4921, 5888, 3592, 2922, 5924, 6735,
        2530, 1561, 3788, 9097, 7388, 8141, 6960, 6495, 3366, 1597,  424, 4489,
        1207,  477, 8464, 5613,   56, 2120, 4238, 4592], device='cuda:0')
tensor([7379, 1661, 3111, 6603, 1854, 8124, 7605, 9009, 1897, 3864,  942, 6949,
        6513, 6973, 3493,  721, 2114, 1745, 3471, 3723, 6322, 2772, 1199,  446,
        1730, 3164, 1888, 2146, 3298, 5809, 2043,  671], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3873, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3788, device='cuda:1', grad_fn=<MeanBackward0>)
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3996, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3930, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8058, 6183,  350, 4160, 3021, 3337, 2483, 5743, 3778, 6886, 6541,  560,
        2207, 9083, 5259,  872, 3962,  653, 3212, 5351, 8308, 8185, 4151, 4954,
        1570, 4740, 8638, 5131,  344, 7791, 1232, 3676], device='cuda:1')
idx in forward tensor([2195, 3105, 1743, 1246, 1569, 8621, 2664, 8652, 3567, 6029, 7585, 3832,
        5042, 8755, 4610, 9039, 1654,  766, 6642, 7318,  209, 3858,  942, 2868,
        1355, 7658, 6832, 1155,  149, 4625, 2740,    3], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3713, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3909, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3843, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3616, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3076,  150, 7057, 5696, 5568,  558, 5484, 7746,  846,  702, 6533, 6106,
        7784,  780, 4659, 2290, 6042, 5987, 8322, 5008, 4771, 3179, 5937, 5283,
        8055, 6645, 1627, 5769, 3057, 8510, 3544, 3427], device='cuda:0')
tensor([2862,  125, 6609,  255, 5163, 4375, 8225,  804, 8921, 5475,   59, 5729,
        8218, 6731,  831, 9129, 7965, 2538, 1880,  770, 6442, 8702, 6684, 5445,
        6331, 5645, 6504, 4505, 3493, 1960, 7524,   39], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3933, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3859, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3861, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3786, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1420,  489, 8805, 6613,   62, 3315,  737, 4730, 6147, 7193, 6327,  889,
        7195, 4039, 1607, 2049, 7078, 3947, 2176, 2571, 2888, 7556,  256, 8084,
        2583, 2750,  922, 8448, 5155, 5684,  358, 7775], device='cuda:1')
tensor([3786, 9058, 3491, 2219, 6573, 4632, 4850, 4975, 4923, 3807, 1698, 6901,
        4254, 8042, 8538, 3581, 3273, 7021,  480, 5970, 6787, 4179,  869, 7208,
         979, 1657, 3065, 8966, 3000, 6130, 4678, 8076], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3799, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3702, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3982, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3922, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5246,  866, 8822,   13, 1110, 3468, 5854, 4065, 7352, 5084,  958,  692,
        6817, 3527, 2920, 3573, 1970, 2329, 2514, 1096, 8937, 7283, 8372, 7762,
        1904, 2734, 4317, 1423,  941, 3131, 3368,  441], device='cuda:1')
tensor([8651, 2078, 4889, 6680, 8585, 7349, 7577, 6014,  493, 7237, 7034, 2856,
        2426,  634, 2844, 4369, 6676, 7127, 5558,  931, 1311, 5504, 5943, 3007,
         398, 3165, 6072, 8820, 3747, 3003, 4109, 8833], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3911, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3830, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3865, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3799, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6607, 8118, 5552, 3403,  785, 5142,  843, 3953, 6638, 1360, 1240,  636,
        1817, 5413, 8794, 8616, 3536, 8682, 4446, 7779, 5811, 3460, 4474, 6822,
        7477, 8107, 5439, 3684, 6298, 2168, 7527, 7595], device='cuda:0')
tensor([8328,  206, 6053, 2354, 4739, 7469, 5032, 1904, 7089, 4747, 2938, 3448,
        1900, 5609, 4230, 5499, 1126, 5657, 6199, 2579, 4236, 3862, 1404, 5736,
        6484, 4091, 5707, 8968, 1425, 7071, 6529, 7266], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3997, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3923, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3961, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3898, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([ 855, 6663,  148, 1723, 3480, 1000, 6781, 3072, 6800, 3691, 6301, 6497,
        6626, 3215, 2452, 6488, 7560, 1376, 1251,  482, 1505, 1455, 6083, 1214,
        8052, 6079,  699, 9065, 8244, 5067, 3765, 6143], device='cuda:0')
idx in forward tensor([6805, 6611, 7315, 8273, 3950,  379, 2393, 6447, 4856, 7259, 3509, 5436,
        7655, 6751, 2701, 1033, 4978,  698, 7278, 4337, 1506, 3242,  981, 4451,
         344,  544, 2814, 2768, 6781, 8844,  210, 8188], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3845, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3764, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3786, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3704, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6611, 7398, 6682, 6542, 5316, 6466,  166, 4200, 3418, 3983,  849, 1796,
        7792, 8839, 4431, 8916, 2768,  593, 5818,  627, 6590, 7522,  517,  773,
        7146, 8877, 3299,  446, 8977,  581, 4536, 1505], device='cuda:0')
tensor([3882, 5684, 8367, 1077, 3833, 7313, 2112, 7733, 5282, 5641,  128, 1869,
        6542, 7274, 7537, 7902, 5094, 7119, 4751, 1807, 4447, 3104,  459, 8541,
        9055, 1322, 1615, 5707, 2182, 4583,  993, 5160], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3821, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3734, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3757, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3663, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7702, 8812, 2947, 8821, 8479, 9069, 7812, 7157, 1851, 2033, 5019, 2603,
          99, 6949, 1043, 5825, 6778, 7554, 3385, 2625, 8150, 4879, 7403, 5087,
        6179, 2254,  471, 8103, 3090, 3794, 1224, 6307], device='cuda:0')
tensor([ 540, 6460,  506, 2149,  956, 2354, 6955, 2765, 7482, 6081, 7447, 4014,
        7684, 7298, 5628, 2294, 3644, 4642, 6102, 6486, 2342, 6194, 6090,  495,
        8208, 6387, 4822, 3812, 3334, 4045, 1730, 2913], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3914, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3839, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3821, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3726, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1619, 3149, 7838, 2068, 8958, 5652, 7456, 3856, 6646, 3901, 8277, 2019,
        3307, 8780, 3189, 8175, 3240, 7931, 9133, 8828, 2887, 6603, 3612, 8690,
        4162, 6092, 7534, 2723, 1625, 7910, 2298, 9073], device='cuda:0')
tensor([6410,  962, 1127, 7226, 4112, 4577, 2849, 2025, 7207, 3142, 6956, 2345,
        4206, 3706, 3357, 6775, 6650, 2368, 2429, 7827, 3344, 8364, 7488, 7432,
        4966, 3899, 4400, 8194, 2666, 1220, 7151, 8273], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3769, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3676, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3716, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3629, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8478, 8623, 1482, 8405, 8638, 7374, 7871, 1170, 3350,  241, 1497, 3986,
        8736, 3199, 3915, 1980, 7712, 2218, 3572, 1538, 4883, 8365, 6560,  311,
        4699, 7594, 5548, 2799, 3399,  784, 1826, 6373], device='cuda:0')
idx in forward tensor([8766, 2967, 1519, 7660, 1914, 7695, 1582, 6420, 3714, 2022,  437, 6451,
        3911,  272, 3445, 6758, 1727, 5824, 6166,  530, 2417, 6524, 4981, 2356,
        3097, 7138, 1129, 5687, 3463, 3811, 1338, 6922], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3963, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3891, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3801, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3719, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3588, 6064, 8291, 2683, 1563, 3393, 1458, 5073, 5397,   36, 1907, 3251,
        5773, 5253, 4296, 6761, 7769, 5697, 7668,  276, 7694, 4188, 3971,  363,
        8397, 1867,  834, 4858, 6720, 1258, 4257,  793], device='cuda:0')
tensor([8603, 8358,   84, 7945,  178, 3232, 7327, 2288, 8700,  662, 4770, 4025,
        5052, 8561, 6293, 4695, 5606, 8707,  673, 8724, 1068, 7010, 7814, 7551,
        1814, 2559,  227, 5460, 2440, 2560, 6412,  340], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3786, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3705, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3907, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3837, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([6022, 6777, 3763, 7032, 6742, 8101, 8094, 1181, 6078, 7249, 7448, 2481,
        6576, 3837, 3414, 6106, 5446, 4534, 3661,  263, 4216, 5899, 6002, 5513,
        5515, 1522, 4739,  299, 8326,  965, 7809, 1740], device='cuda:0')
idx in forward tensor([6619, 7411, 7138, 1115, 1189, 8505, 5077, 8803, 7882, 5050,  280,  758,
        9014, 8041, 6483, 2235, 5439, 7012, 4277, 2539,  865, 4481, 1695, 2647,
        7769, 6248, 8150, 6836, 2848, 9021, 7532,  255], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3850, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3772, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3737, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3644, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8417,  826, 7992, 4177, 9150, 8532, 6772, 1202, 5639, 1784, 1939, 5981,
        7725, 7227, 5580, 9094, 2164, 1085, 2401,  747, 5361, 7583, 8059, 2837,
        1849, 8806, 2508, 7249,  445, 2936, 5477, 3649], device='cuda:0')
tensor([6792, 5724, 8934,  156, 4303, 7649, 4180, 8923, 6592, 9068, 6048, 6728,
        2606, 1869, 7731, 6243, 5776, 6712, 8028, 8782, 4444, 1141, 8074, 1050,
         662, 5874, 7930, 3904, 1501, 5811, 7370, 2652], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3789, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3703, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3850, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3770, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 897,   66, 8128, 3639,  851, 4710, 3923,   70,   71, 6069, 2621, 2640,
        5104, 4402, 4630, 6815, 4504, 5034,  487, 3023, 4797, 4052, 8727, 4323,
        7551, 6990, 7963,  432, 2648, 2335, 4654, 3899], device='cuda:1')
tensor([6338, 1389, 6991, 5285, 1640, 4975, 4074, 3365, 8363, 7718,   19, 3734,
        4747, 6499, 6423, 8603, 5005, 2339, 7271, 2668, 9127, 6504, 2902, 8234,
        8487, 8780, 6779, 1643,  577, 3344,  664, 7578], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3925, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3860, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3830, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3744, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1906, 7419, 1238, 6506, 2347, 2958, 4987, 1621, 6343, 8553, 2865, 5850,
         354, 9032, 7693, 6223, 1263, 5406, 4471, 7344, 1841, 6413, 8148,  838,
        1928, 2285,  429, 1174, 1464, 5727, 7531, 9036], device='cuda:0')
tensor([5338, 2372, 1410, 5087, 2194, 7930, 4011,  456, 1121, 8725, 1572, 1740,
        2607, 7501, 2668, 1295, 8965, 6608, 2140, 4911, 3774, 8269, 4546, 4349,
        2322, 9029, 1879,  722, 3913, 2744, 6529, 7718], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3854, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3775, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3910, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3833, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5740, 2633, 6924, 5085, 3152, 1977, 9046, 3814, 3921, 8475, 2975, 8946,
        8067, 2747,  145, 1421, 2370, 8015, 4846, 7430, 8582, 5604, 9042, 1276,
        4713, 2422, 6593, 3775, 8901, 1556, 2783, 7123], device='cuda:0')
tensor([2385, 3992, 1465, 4285, 7751, 5728, 6640, 4187, 2012, 4008, 4166, 5129,
        5349, 7405, 7732, 2530, 6001, 8292, 1279, 5885, 8001, 3533, 5207, 1072,
        5331, 1449, 4373, 7458, 4321, 1480, 1641, 3792], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forwardtext in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
 torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3923, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3844, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3930, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3847, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([6208, 4102, 4346, 2954, 8569,  605, 3955, 4216, 1890,  477, 6914, 8844,
        1319, 8426, 5984, 4177, 2002, 1793, 8301, 2399, 5893, 7861,  257, 1003,
        4264, 2016, 6089, 1296,  862, 7301, 2825, 3081], device='cuda:0')
idx in forward tensor([6678, 4217,  267, 1434, 5780, 3318, 3384, 2374, 1440,  473, 5269, 8856,
        8241, 2027, 2945, 4189, 4520, 4410, 1704, 6015, 7944, 3898, 4314, 7502,
        1581,  450, 7511, 8005, 1183, 4490, 4745, 3749], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3887, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3803, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3978, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3908, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 989, 3498, 4438, 4575, 5461, 7918, 7482, 6285, 4025, 4929, 5012, 1871,
        6517,  148, 6480,  845, 3013, 6862, 5741, 2888, 5508, 1662, 5268, 7659,
        1474, 7597, 3698, 2079, 5942, 1820, 1047, 4024], device='cuda:0')
tensor([4876, 4051, 8117, 7818, 7222, 6564, 3390,  257, 5193, 6412, 6958, 1849,
        8571, 7186, 4808, 7958, 5524, 6061, 3225, 7643, 3008, 1335, 3599,  689,
         602, 4815, 7853, 8083, 2854, 5690, 2318, 8332], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forwardtext in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
 torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4023, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3963, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3792, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3701, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8056, 1680, 4359, 5551, 5467,  775, 7131, 1440, 3679,  967, 2628, 6445,
        6972, 7385, 1447, 2569, 1562, 2760, 3819, 4290, 8474, 5146, 4817, 6695,
        7233, 7966, 7855, 6403,  794, 6845, 5853, 6073], device='cuda:0')
tensor([3758, 3242, 5760, 5902, 5426, 3322, 8588, 4094, 5710, 6502, 5269, 1860,
        7349, 9068, 3143, 4853, 1803, 8349, 9066, 5616, 2566, 6288, 4130,   92,
        5492, 8552, 3445, 6442, 5095, 4918,  927, 7221], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3744, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3650, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3799, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3703, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4322, 3768, 3578, 6071,   91, 1965, 2242,  605, 2976, 9104, 4418, 7760,
         626,  404, 5374, 6238, 8064, 3838,  380, 2158, 2353, 7548, 4603, 4391,
        8006, 6567, 1396, 4485, 1748, 8743, 2948, 5168], device='cuda:0')
idx in forward tensor([6013, 2818, 2798, 8474, 7237, 2758, 4900,   23, 7006, 6753, 4941, 1412,
        2758, 8815, 3105, 1419, 5845, 2427, 3637,  478, 4647, 8672, 4055, 4759,
        4313, 2006, 3112, 3560, 3305, 2393, 5319,  551], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3939, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.4019, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3962, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3871, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5774, 1099,  698, 3391, 7744, 5045, 1320, 1076,  919, 6399, 7990, 6226,
        2032, 5339, 5213,  555, 2096, 2119, 2334, 8840, 8748, 5846, 6690, 7455,
        4037, 1895, 4748, 4645, 5766, 7173, 8289, 8327], device='cuda:0')
tensor([3971,   12, 4805, 4394, 7968, 6761, 5920,  967, 1099, 4835, 6043, 8210,
         904, 1975, 6596,  914, 4151, 8676, 9113, 3902, 8549, 1659, 4690, 3717,
        1787, 1625, 7974, 3552, 3951, 6589, 4693, 3540], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3827, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3723, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3804, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3721, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4292, 7319, 6788, 1074, 2116, 2376, 7170, 2197, 1088, 3031,  635, 5767,
        7215,   83, 7994, 8637, 5550, 7107,  418, 1608, 7359, 8763,  437, 2385,
        3100, 1346, 4613,  910, 7832, 7564, 3466, 2474], device='cuda:0')
tensor([3121, 1650, 3467, 5752, 5020, 8517, 2455, 1961, 2421,  679, 5749, 7716,
        2441, 3525, 9097, 3859, 1781, 6115, 1931, 7367, 8800, 3706, 2086, 6058,
         637, 3202,  954, 8835, 3693,  520,  561, 7144], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3861, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3782, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3882, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3801, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7702, 6654, 2247, 3733, 3941, 8604, 6628, 2955, 1612, 3129, 7736, 1696,
        2454, 6271,  307, 1699, 7790, 5533,  870, 2289, 7516, 3219, 4734, 5739,
        5734, 2346, 4202, 5899, 7373, 4443, 7396, 7843], device='cuda:0')
idx in forward tensor([2520, 5734,   37,  735,  829, 2070, 5649, 7513, 3459, 6247, 7715, 3302,
        6653, 6325,  927, 8812, 5427, 7772, 8810, 4138, 7983, 6655, 2372, 7110,
        4559, 7715, 9129, 2998, 6425, 8818, 6434, 7071], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3828, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3733, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3907, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3836, device='cuda:1', grad_fn=<MeanBackward0>)
[32m2023-10-20T16:05:11 | utils.basic_utils: [0mTrain Epoch: [0]  [300/572]  eta: 0:38:21  lr: 0.000010  temperature: 0.0177  video-loss_ita: 2.3435  video-loss_itm: 0.5622  time: 9.5668  data: 0.0102  max mem: 33192 res mem: 33720
idx in forward idx in forward tensor([4829, 2872, 4662, 3100, 3575, 2811, 1719,  645, 8787, 7404, 5916,  186,
        5023, 5520, 4435, 5200, 2493, 4260, 7981, 1718, 3758, 1810, 7082, 8095,
        1675, 1179,  564, 5683, 8205, 8896, 4738, 5785], device='cuda:0')
tensor([7036, 5521, 8355, 8802, 4124, 4813, 1206, 8549,  417, 7043,  229, 2043,
        8371, 2008, 4777, 8967, 2258, 5590, 1163, 3144,  116, 8761, 3466,  209,
        1020, 7308, 2925, 3574, 3484, 7041, 1042,  239], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3910, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3836, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3827, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3751, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1521, 7088, 3430, 4814, 8629, 7189, 8438, 3817, 6228, 5843, 8340, 5267,
        2950, 2836, 6031, 4251,  290, 8071, 1559, 4323,  895, 7149, 3678,  728,
        4700, 2000, 5848,  781, 4329, 4330, 1067, 1253], device='cuda:1')
tensor([ 606, 6772, 4547, 7020, 8477, 4244, 4224,  921, 7911,   66, 4521, 1553,
        8261, 1244, 6330, 1857, 6521, 7299, 7264, 2139, 6524, 1379, 3226,  438,
        2956,  284, 5109, 7341, 6610, 1820, 6361,  537], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3890, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3815, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3896, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3821, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4861, 2438, 1438, 8538, 8744, 8367, 6467, 1768, 4390, 4543, 3505, 2189,
        5482,  216, 1692, 8392, 8514,  102, 8724, 6654, 4960, 4878, 5400, 5792,
        4983, 5688, 5213, 5563, 3607, 1966, 1083, 1279], device='cuda:0')
tensor([7689, 1519, 6395, 1872,   37, 8132, 1241, 1706, 5748, 4019, 2216, 2329,
        8697, 1873, 4133, 7173, 5458, 8143, 5972, 1523, 3860, 4810, 4328, 2947,
        8677,   25, 4187, 9125, 2410, 6716, 2508, 5251], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3719, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3622, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3834, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3751, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5174, 5369, 4683, 7988, 4731, 3703, 8237, 5409, 8687, 4809, 2503, 8206,
         140, 7040,  442, 2433, 6113, 4443, 2119, 4262, 9034, 7708, 6190, 7169,
        6464, 2448, 1036,   19, 4119, 5359, 2000, 4993], device='cuda:1')
idx in forward tensor([4305, 7239, 1587, 4976, 3648, 3834, 3028, 9019, 1893, 6898, 5625, 5756,
         575, 8826, 2155, 6491, 1400, 3815, 7244, 1647, 4136, 2526, 3069, 6607,
        2204, 3475, 6009, 4205, 1607, 6093, 4508, 4514], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3901, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3820, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3818, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3737, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2056, 3125, 8185, 6258, 4624, 7691, 2694, 1448, 8786, 4245,  701, 5785,
        7230, 8600, 3364, 7103, 5750,  233, 1794, 2416,  691, 1262, 3815, 7375,
        8111, 2221, 7683, 8123, 3330, 4221, 6715, 5490], device='cuda:1')
tensor([4648, 3014, 1422, 8833, 6448, 3569, 2720,   86, 6411, 5714, 6422, 9030,
        5929, 3215, 8009, 2858, 2030, 3865, 4344,  139, 7920, 7937, 4951, 7503,
        9118, 3089, 8313, 4480, 7735, 6159, 5328, 6678], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3993, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3933, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3730, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3637, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4427,  934, 4593, 2319, 2866, 5026, 6667, 4713, 4511, 4530, 6853, 4978,
        6661,  738, 6519, 9060, 8579, 4663, 3372, 1501, 2251, 7653, 4641, 8060,
         704, 2266, 6843, 7334, 8566, 6273, 3161, 5995], device='cuda:0')
idx in forward tensor([6840, 7556, 1227, 9071, 3937, 3335, 6499, 8876, 3859, 6406, 2299, 3472,
        1403, 5052, 8683, 6130, 8042, 5648, 3135, 2761, 8186, 6459, 4550, 5946,
        3495,  868, 2828,  982, 6334, 1741, 2184, 3329], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3875, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3793, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3820, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3729, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4412, 1751, 2905, 8659, 3602, 5888,  262,  361, 4581, 1030, 7133, 1435,
        7109, 7263, 7954, 7062, 4706, 4233, 1810, 8770, 4069, 6010, 3828, 7859,
         951, 2397, 2589, 7865, 7300, 8660, 5902, 9124], device='cuda:0')
idx in forward tensor([6993, 4045, 1800, 4515, 6435, 7324, 2378,  522, 5513, 7468, 6439,  145,
        4050, 6839, 6765, 6400, 2280,  659, 6594, 2209, 6708, 6277, 1029, 7809,
        1279, 6355, 5653, 7160, 6079, 2477, 8799, 7041], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3718, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3618, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3881, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3799, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2033, 1847, 4984, 6122, 1491, 1517, 9029, 7550, 5383, 6976, 7331, 1716,
        4023, 7390, 2765,  331, 5841, 1207, 6804, 7555, 7111, 7978, 2896, 4911,
        8291, 5734, 2735,  292, 4492, 1657, 4050, 6151], device='cuda:0')
tensor([8930,  724, 1915, 8165, 7453, 5326, 8182, 6156, 5209, 7432, 3550, 9133,
         320, 6290, 1450, 6641, 4269, 7413, 9042, 2602, 3023, 4540, 5151, 3343,
        2509,  825, 7262, 5778, 8016, 4436, 8888, 2949], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])

pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3988, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3926, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3813, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3722, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7304, 1664, 8493, 4067, 4874, 3297, 4003, 7733, 7017, 1988, 8323, 5949,
        2578, 8718, 3669,  828, 2517, 4437, 1695, 1576, 3939, 5310,  755, 4843,
        2097, 6902, 6463, 6971, 4612,  129, 5192, 1103], device='cuda:1')
idx in forward tensor([6794, 1416,  893,  199, 8887, 5412, 1835, 8644, 1839, 6293, 5808, 5858,
        3339, 3809, 6154,  953, 1188, 2230, 9087,  142, 4856, 5445, 1449, 5655,
        5415, 1539, 8004, 3641, 3821, 3331, 2435, 6326], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3780, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3691, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3808, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3725, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3958, 8189, 3145, 6339, 3659, 5281, 3359, 1743, 1958, 1292, 8813, 1294,
        5645, 7623, 5859, 1619, 5170, 3423, 7804, 8733, 4153, 3049, 1321, 4697,
        8808, 6383, 6695, 5424, 2846, 7997,  648, 2674], device='cuda:0')
tensor([5500, 7353,  891, 1422, 3482, 3452, 2945, 7357, 3258, 4926, 8900, 2850,
        8260, 3198, 4009, 8850, 4265, 6663,  753, 3664, 5482, 2549, 4607,  195,
        2805, 6494, 9104, 4579, 3897, 5608, 2256, 5299], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3943, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3877, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3918, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3852, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5678, 3995, 4685, 5642, 4745, 2119, 2701, 6637, 6855, 3928, 8030, 7755,
        8755, 6505, 3158, 3901, 1747, 3619, 8165, 2642, 7278, 3143, 4062, 3148,
         359, 8273, 8758, 2273, 7351, 8298, 3778, 1557], device='cuda:0')
tensor([6267, 2842, 4556, 7881, 2900, 2965, 4589,  861, 4950,  987, 6392, 6865,
        5241, 8168, 2091, 2092, 3885, 9107, 4304,  227, 6295,  260,  254,  988,
        6735, 7124, 6925, 3285, 1721, 8278, 7162, 6793], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3886, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3816, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3736, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3631, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2157,   99, 5339, 8943, 4483,  186, 1119, 1396, 5912, 6533, 7247, 4531,
        3888, 4300, 7932, 2934,   20, 3064, 5793, 4930, 7797, 5654, 3851, 6218,
         176, 2006, 7070, 7860, 3609, 4360, 8716, 3548], device='cuda:0')
tensor([8616, 4906, 3543, 7184, 6404, 8391, 2686, 4318, 6820, 4247, 6900, 6406,
          70, 4252, 3844, 1825, 1702, 6240, 8339, 5164, 1352, 7200, 7686, 1148,
        1677, 3219, 8182, 1521, 2867, 3218, 4072, 5771], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3813, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3715, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3980, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3917, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([1535, 8164, 7331, 4481, 5982, 3920, 3867, 3428, 8995, 4627,  639, 5686,
        6080, 3001, 3453, 6733, 8027, 2995, 3621, 4363, 3910, 5811, 5754, 2109,
         543, 4869,  747, 2485, 3413, 2012, 4894, 3930], device='cuda:1')
idx in forward tensor([7474, 8374, 4727, 8482, 8412, 6368, 1920, 2515, 3714, 1784, 6320, 3035,
        4017,  418, 7883, 6727, 5533, 1408, 8804, 2274,  214, 3131,  605, 6041,
         916, 2203, 9096, 3012, 1120, 8120, 1343, 6640], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3844, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3762, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3906, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3842, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4151, 3643, 8713, 6785,   76, 1388, 7648,  970, 8346, 4835, 4775, 2716,
        5774, 5546,   97, 3929, 8495, 5957, 3202, 8728, 3686, 5105, 6344, 7661,
        6304, 3687, 6441, 4450, 2114, 6196, 6721, 7582], device='cuda:0')
idx in forward tensor([2296, 5722, 7779, 7406, 2860, 8764, 8026, 6596, 7624, 6360,  598, 2309,
        7487,  387,  788, 1720, 7430, 2993, 1570, 5072, 6236, 5564,  585, 5063,
        6356, 4057, 8562, 3578, 7100,  891, 8366, 2663], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3943, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3879, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3935, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3876, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1925, 4618,  553, 7794, 1365, 7993,  892,  264, 5659, 3203,  633, 8578,
        6119, 7040, 2062, 3029, 1149, 3530, 3655, 6775, 3674, 1918, 1940, 8433,
         473, 5557, 2788,  399, 4033, 4928,  376, 3605], device='cuda:0')
tensor([2690, 3705,  180,  529,  154, 3814, 6627, 3352, 5412, 4264, 1560, 7637,
        5843, 6379, 8373, 6339, 6451, 8986, 7028, 8436, 1940, 6078, 3045, 6543,
        5109, 5683, 1950, 6711, 8789, 3227, 4435, 7426], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3795, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3704, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3956, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3898, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4441, 7892, 5984, 6050, 3450, 2687, 6171,  371, 4919, 8560, 6348, 5098,
        4524, 5716, 8271, 4576, 4304, 6996, 4030, 7295, 8742, 7445, 3086,  424,
         970, 8918, 3498, 8845, 3749, 6030, 1154, 6105], device='cuda:1')
idx in forward tensor([1760, 4535, 2185, 3220, 4640, 2701,  767, 2560, 2986, 3839, 1771, 2996,
        6762, 7037,  492, 3212, 4325, 6484, 7643, 6574, 6695, 4392, 3256, 4327,
        8896, 4324, 1228, 6097, 3562, 3017, 3329,  768], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3924, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3846, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3852, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3782, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([5254, 7226,   78, 1226, 3855, 1534, 6573, 5014,   73, 8043, 6247, 8013,
        2321, 4797, 4476, 3707, 7416, 8181, 8151, 7350, 3005, 3296, 2939, 2437,
        1159, 4557,   23, 8185, 1582, 1194, 4872, 2831], device='cuda:0')
idx in forward tensor([3836,  299, 6685, 5585, 8898, 6649, 5357, 3921,   22, 7615, 3441, 1785,
        6782, 4737, 6232, 6353, 7898,  332, 8926, 1985, 5752, 8090, 1993, 8546,
        6370, 7240, 5931,  208, 2706, 2815, 2544, 3069], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3810, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3725, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3773, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3692, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2564, 7114, 6935, 4730, 7755, 7468, 2753,  519, 7431, 1691, 4283, 6598,
        7109, 2777, 4000, 5304, 2693, 2737, 1086, 4682, 6701, 5663, 2672, 3124,
        7210, 6816, 6455, 4920, 6286, 7664, 5125,  346], device='cuda:0')
tensor([8433,  963, 6207, 2477, 2936,  939, 1510, 3409, 4676, 2218, 3083, 8171,
        7290, 4783, 6933, 9005, 4337, 6158, 1128, 1334, 8810,  974, 3422, 8559,
        3530, 5306,  694, 4036, 3525, 2199, 6535, 2691], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3888, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3822, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3794, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3716, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2091, 2937, 2682, 2998, 3916, 2053, 1300, 8580, 8442,   38, 3804, 3947,
        1882, 1668, 7557, 7628, 3831, 2677, 7306, 5978, 5234, 6862, 3654, 5115,
        8647, 1060, 3577, 4584, 7339, 7437, 2812,  567], device='cuda:1')
tensor([7720,  656, 1052, 6934, 3978, 7558, 4950, 6455, 8743,  709, 6305,  711,
        8079, 8256, 3640, 7436,  656, 4942, 1867, 8570, 8070, 5759,  966, 4067,
        4010, 5560, 3403, 8416,  602, 3681, 3388,  791], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4054, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3995, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3891, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3820, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4286, 4282, 4759, 5069, 7450, 7353, 6075, 8427, 5197, 5681,  839, 8583,
        2802, 1595, 2447, 2933, 9123, 7399, 1333,   66, 3126, 3375, 5408, 2796,
        6844, 1727, 4141, 4568, 9053, 8190,  505, 1255], device='cuda:0')
idx in forward tensor([6632, 2222, 6367, 7147,  138, 6759, 4292,  373, 6915,  555, 2885, 4313,
        5297, 4374, 3568,  152, 6185, 2573, 3060, 5790,  221, 6536, 5815, 5881,
        3827, 1797, 2140, 8302,    8, 6220, 3074, 4484], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3589, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3727, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3615, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3479, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4267, 4883, 1438, 4985,  605,  885, 2031, 1536,  244, 7636, 4487, 7321,
        7383, 1688, 2198, 1281, 1111, 8056, 5775, 2400, 4817, 2011, 4061, 5694,
        2549, 5440,  933, 2074, 6085, 2769, 1033, 1138], device='cuda:1')
tensor([7637, 2625, 3973, 3718, 2297,  454, 2760, 5533,  858, 3176, 7401, 5538,
        3324, 1171, 5047, 4399, 1153, 7077, 1093,  273, 6966, 7075, 3408, 1155,
        4315, 6646, 3373, 4064, 7417, 2049, 2627, 6030], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3810, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3713, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3848, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3769, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([5777, 8420, 1785, 7701, 8305, 6527, 8569,  385,  652, 5190,  309, 8437,
        8150, 7937, 2350, 7463, 1558, 8445, 5891, 8483, 4604, 1167, 3825, 1660,
        8486, 6811,  149, 4146,   69,  441, 6143,    9], device='cuda:1')
idx in forward tensor([4488,  610, 2776, 6254, 4149, 7076, 6409, 1154, 4386, 7417, 7236, 6693,
        1520, 2573, 7890, 7047, 8140, 6971, 1025, 6937, 3170, 1842, 5908, 1471,
        6418, 6390, 3508, 8564, 7612, 6297,  810, 2378], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3988, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3915, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3815, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3735, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([1772, 4995, 5404,  803, 4673, 3033, 2034, 8834, 6856, 7342, 2769, 1315,
         650, 8281, 4328, 2421,  575, 2676,  468, 3566, 3705, 9069, 7256, 8466,
        5954, 2255, 6191, 1495,  684, 4553, 8389, 7157], device='cuda:0')
idx in forward tensor([ 950, 8406, 2504, 6465, 5839, 2711, 3497, 8910, 4984, 6343,  457, 6739,
        1545, 7492, 3055, 8992,  947, 6936, 5859, 1454, 2210, 4080, 7486, 8704,
        3529, 4776, 1610, 9047, 6301, 5635, 7328, 7760], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3767, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3683, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3805, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3719, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3421, 4229, 1807, 5201,  801, 7953, 7109, 1998, 4199, 2986, 6755, 1732,
        3939,  629, 6748, 4541, 8378, 1028, 1987, 4141, 2643, 4220, 2209,  771,
        5075, 4514, 3389, 6530, 5368,  498, 3627, 1924], device='cuda:0')
tensor([3121, 2652, 8617,  450, 7285, 8090, 6699, 4240, 8436, 4344, 7980, 4139,
        7018,  220, 3660, 5999, 5879, 2296, 9096, 3459, 5267, 3429, 2166, 1385,
        3121, 7159, 3146, 7591, 2447, 3981, 4855, 6156], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3745, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3663, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3947, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3888, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2323, 3780, 3968, 7368, 7597, 7469, 8793, 5814, 3867, 5078, 3558, 5528,
        4731, 3063, 3811, 8084, 7492, 5429, 7379, 8037, 7498, 2690,  810, 3617,
        8750, 1012, 8201, 3126, 1755, 2461, 4063, 7001], device='cuda:0')
idx in forward tensor([7024, 7316, 3048, 4101, 5888, 3801, 4651, 6784, 8751,   93, 7123,  887,
        7559,  323, 7626, 3853, 1823, 2213, 6283, 8468, 1649, 5021, 6738,  340,
        8203, 2481, 5095, 7502, 5376, 5786, 4458, 2167], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])

pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3784, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3684, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3856, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3765, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6079, 7340,  715, 6084, 9079,  311, 8280, 3005, 4422,  744, 7233, 8914,
        3948, 5383,  475,  248, 8074, 2848, 5214, 1565, 3427, 5972, 1448, 5702,
        6222, 6346, 2449,  407, 8502, 8745, 2704, 2918], device='cuda:0')
tensor([6191, 4124, 7361, 3067, 3437, 8370, 5668,  569, 5371, 3606,  822,  485,
        4294, 6489, 1979, 5169, 6789, 6366, 7412, 1970, 7776, 2882, 4326, 8745,
        2126, 4333, 6301, 2858, 7620, 7877, 2272, 7466], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4020, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3957, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3825, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3740, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4397,  400, 6867, 7792, 5260, 5847, 8186, 5588, 6977, 3855, 2325, 5187,
        3524, 8850, 5399, 1802, 7219, 7800, 1113, 2032, 4908, 3471, 2625, 3122,
        7115, 8212,  592, 5056, 2773, 5438, 4635, 2554], device='cuda:1')
tensor([7245, 2655, 1451, 2556, 5089, 6211, 2044, 1467, 3647, 8535, 7562, 1575,
        4404, 6479, 8542, 4623, 8129, 4502, 1134, 6890, 5278, 1203, 6275, 6398,
        7711, 5450, 3285, 1863, 2711, 8351, 5487, 4266], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forwardtext in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
 torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3790, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3668, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3552, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3698, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4066, 4608, 7811,  378, 6832, 7741, 2619, 2185, 3972, 6321, 5668, 7229,
        9123, 4697, 7906,  679, 6391, 8773, 2302, 6116, 2485, 4962, 2728, 3391,
        3481, 3001, 7294, 8833, 5447, 4527, 4293,  642], device='cuda:0')
idx in forward tensor([7712, 4589, 7344, 6557, 8087, 2992, 3407, 3996, 5879, 5467, 2577, 4266,
        6082, 3615, 9006, 8347, 3789, 6040, 4117, 5846, 8917, 9057, 4081, 5753,
        1565, 4219,  821, 6766, 4434, 2865, 5157, 9132], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3856, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3778, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3770, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3695, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([1643, 2914, 8146, 5291, 2789, 6682, 4072, 4820,  573, 1223, 4839, 1708,
        5031, 7855, 7866, 8304, 4852, 4779, 1820, 8943,  305, 4836, 2257, 3617,
        7882, 6293, 3467, 4840, 3607, 1105, 5083, 1222], device='cuda:0')
idx in forward tensor([9017,  661, 7167,  407, 5315, 4971, 1272, 6775, 3892, 6935, 7184, 3202,
        8203,  658, 1348,  169, 4625, 2715, 4834, 8581, 6930,   53, 8611, 4027,
         426, 3319, 8319, 4715, 8078, 3010, 6648, 8680], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3937, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3857, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3956, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3890, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([ 327, 2812, 8959, 3753, 6859, 8816, 3552, 8026, 6325, 2757, 2773, 3986,
         821, 2251, 5922, 4985, 5321, 2786, 1866, 7704, 5420, 3932, 4587, 3518,
        5238,  784, 4075, 5756, 8255, 3432, 8272, 3619], device='cuda:0')
idx in forward tensor([2886, 4385, 2491, 4680, 8144, 4404, 4859, 6887,  357, 6534,  770, 8381,
        8823,  866, 3896, 8008, 6045, 6910, 8696, 5744, 4619, 2110, 8824, 8734,
        5043, 1426, 2328, 7723, 3769, 1868, 6923, 8035], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3712, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3611, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3759, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3667, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([6983, 5382,  141, 7200, 5725,  559, 3700, 8088, 5813, 1649,  566, 3600,
        4661, 3634, 6139, 2109, 6262, 1888, 7182, 4543, 5326, 5625, 6602, 6126,
        1485, 3558, 3341,  664, 7743,   99, 1625, 4661], device='cuda:0')
idx in forward tensor([4845, 2448, 1761, 8713, 2423, 2975, 6116, 2235, 5586, 6565,  515, 5488,
        2028, 5611, 8690, 3680, 1355, 8814, 3806, 1241, 6480, 7415, 1712, 4044,
        2639, 4296, 5162, 7847, 6884, 2808, 5039, 8710], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3764, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3656, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3730, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3642, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5194, 8590, 3553, 5796, 4539, 3030, 6491,  682, 7747, 8068, 7523, 2504,
        7094, 2913, 9149, 7567, 3590,  237, 8949,  900, 7195, 1471, 6365, 5877,
         819,   31,  549, 7987, 3132, 1697, 3040, 1524], device='cuda:0')
idx in forward tensor([5707, 6908, 4055, 1430, 2484,  887, 1892,  666, 7377, 1269, 7545, 5663,
        4994, 8007, 8425, 5973, 8702, 6673, 7464, 2482, 1945, 5336, 6213, 8516,
        7626, 4032, 1499, 2808, 1124, 5728, 6768,  948], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3811, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3724, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3873, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3791, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5337, 4112, 4277, 5995, 8071, 8254, 7892, 8067, 6075, 2376, 8329, 2847,
        7835, 7902, 2501, 4173, 4589, 6660, 2342, 3824, 7364, 2804, 2073, 4556,
        4572, 8084, 4023, 6737, 8062, 4636, 2466, 4650], device='cuda:1')
idx in forward tensor([ 437, 3576, 5789, 5843, 8637, 1699, 2422, 2807, 2459, 7414, 8342, 5571,
        5175, 7705,  882, 6186, 5045, 1759,  917, 1051, 5694, 4808, 3116, 5963,
        5228,  368, 8521, 4040, 6378, 5185, 8052, 6586], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3651, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3547, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3777, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3683, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4497, 5573, 7112, 7168, 3918, 1167, 4364, 4733, 2230,   78, 1958, 6786,
        7040, 4073, 2250, 4653, 4868, 5217, 8641, 6664, 4145, 9112, 6554, 2601,
        2848, 5583, 8605, 5715,  679,  692,  325, 3982], device='cuda:0')
idx in forward tensor([5966, 1679, 3056, 4819,  284, 3884, 5230, 6895,  310,  531, 3605, 5159,
        5521, 6908,  498, 2265, 2819, 6500, 7397, 5462, 6123, 4644, 8627, 5860,
        5937, 4595, 3194, 2976, 7739, 8954, 1935,  497], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3871, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3789, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3730, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3616, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2824, 3373, 7450, 1862,  123, 5628, 1656, 7483, 4097, 8473, 1913,  430,
        7930, 7174, 3594,  307, 3454, 4800, 2577, 2093, 1769, 7402, 5947, 5333,
        7472, 4097, 5911, 8984, 1747, 3675, 3882, 4097], device='cuda:0')
idx in forward tensor([6692, 1846, 5077, 5834, 4295, 6017, 3800, 5132, 4920, 2481,  249, 6559,
        1469, 7529, 5018,  815, 5933, 5576, 4239, 1348, 6840,  111,  309, 7459,
        6478, 4096, 5331, 5956, 7283, 2541, 8611, 7290], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3832, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3749, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3859, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3775, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([3642, 6642,  902, 8448, 8179, 8395, 6946, 5852,  349, 7106, 3386,  415,
        6588, 1577, 8869, 7893, 3965, 5064, 5583, 3839, 4738,  666, 7554, 4341,
        6689, 3823, 5991, 2882, 8214, 7203, 4667, 4811], device='cuda:0')
idx in forward tensor([4973, 7355, 3766, 5777, 7583, 3986, 1593,  100, 3009, 5277, 4234, 1724,
        9154, 6205,  968, 1720, 6441, 3053, 2559, 2651, 4249, 4884, 8094,  346,
        2382,  313, 2338, 2635, 7332, 5595,  980, 8536], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3769, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3686, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3912, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3837, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([9129, 4587,  906, 7893, 5447, 3242, 4569, 6835, 1785, 5719, 8077, 7390,
        8257, 4725, 8564, 7939, 3256, 4174, 8021, 7061, 5600, 5111, 4380, 3952,
        6850,  383, 5692, 7588, 4800,  133,  516, 8411], device='cuda:1')
idx in forward tensor([4443, 6900, 4178,  597, 5913, 6015, 8394, 2894, 6511, 1837, 7652, 4827,
        2579, 7640, 3396, 1021,  350, 2356, 5897, 5331, 2776, 5794, 4336, 5533,
        7721, 1890, 3566, 2462, 6622, 6248, 8620,  167], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3672, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3565, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3724, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3625, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([1464, 6771, 2513, 8579, 5367, 5265, 1369, 1755, 4999, 1818, 4547, 2813,
         765, 5616, 7466, 4626, 3628, 7585, 5833, 7475, 5818, 3752, 8789, 6377,
        8811, 2786, 8731, 3741, 9063, 1225, 4266, 7086], device='cuda:0')
idx in forward tensor([ 153,  642, 8211, 8883, 3301, 2741, 7911, 4105, 4307, 3163, 6986, 4161,
        1490, 4311, 9088,  920, 2251, 2819, 6824, 8598,  578, 8746, 7246, 1137,
        1624, 6452, 4413, 5242, 6303, 8309, 8613,  718], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3782, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3683, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4046, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3988, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2152, 2817, 2478, 3285, 1728, 7493, 6431,  459, 3395,  401, 4933, 7222,
        7471, 5875, 6622, 3795, 8250, 3060, 7066, 6514,  158,  151,  957, 8820,
        7529,  228, 1528, 2300, 5916, 6729, 8771, 6627], device='cuda:0')
tensor([8276, 2547, 1662, 2512, 2595, 1191, 7870, 8367,  759, 4831, 9081, 7228,
        9097, 4048, 3528, 1546, 7612,  172, 3689, 7844, 3880, 1347, 4786, 9121,
        8884,  794, 4144,  881, 5454, 7755, 5395, 8450], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3858, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3771, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3814, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3730, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5425, 6986,  387, 3696, 8358, 1794, 8046, 4320, 5272, 7768,  490, 5492,
         553, 3863, 5179, 2523, 3844, 3469, 1092, 5952, 8436, 5633, 1115, 5947,
        9098, 1675, 5681,  772, 7168, 2288, 1817, 8069], device='cuda:0')
tensor([2981, 5869, 8865, 5424, 1910, 7772, 2223, 2892,  244, 2610, 3504,  949,
        9099, 1787, 5596, 6940,  600, 4383, 1100, 5191, 6897,  123, 2910,  524,
        1223, 1270, 6554, 8446, 3521, 7020, 8825, 8341], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3810, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3725, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3855, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3766, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8425, 4858, 1569, 4395,  192, 2546, 2640, 2958, 3021, 6038, 5830, 7973,
        2302, 6635, 8271, 7170,  579, 7231, 7107,  230, 2433, 2928, 5641, 3847,
        8776, 7600, 1346, 4611, 3646, 7434, 8884,  542], device='cuda:1')
idx in forward tensor([3197, 5048, 8050, 3135, 2956, 4336, 3190, 2868, 2141, 7887, 6413, 8193,
        2352, 1906, 3887, 6817, 7753,  382, 3411, 1903, 1931, 7931, 4028, 2864,
        8632, 2282, 7754, 6244, 7112, 5838, 2337,  904], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forwardtext in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
 torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3755, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3669, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3905, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3820, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([1956, 3787, 8119, 2054, 7003, 4586, 7172, 5285, 7381, 5099, 3686, 5208,
        2160,  259,  386, 3827, 2145, 8448, 5991, 5644, 5758, 3658, 4470, 6468,
        7179, 5616, 1875, 1980, 4529, 1170, 3050, 7954], device='cuda:0')
idx in forward tensor([3895, 7393, 7999, 4001, 2734, 4113, 7304, 9131, 8699, 1374, 6973, 9142,
         485, 7587, 1140, 2911, 7671, 1812, 7030,  774, 5583, 1220, 3682, 8317,
        9043,  747, 7307, 8540, 3569, 7666, 7171, 2202], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3900, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3795, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3701, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3816, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3274, 5711, 1071, 5336, 4471, 1898, 3938, 7102, 6476,  176,  202, 8593,
        2786, 6328, 5701, 3718, 1363, 5678, 1320, 8491, 6366, 6128, 2150, 2418,
        5054, 7231, 7898, 2275, 8584, 4135, 6433, 4224], device='cuda:0')
tensor([1940, 7371, 8020, 4122, 5824, 7824, 8558, 1499, 5642, 7833, 7356, 3803,
        1364, 2721, 3415, 7267, 2153, 7536, 2106, 7830,  144, 3944, 3524,   36,
        3688, 1056,  594, 4891, 3461, 5971, 5539, 8496], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3758, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3654, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3821, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3731, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5735, 7342, 8196, 4902, 3183, 8058, 6603, 7487, 1553, 4105, 6645, 2231,
        1757, 5225, 2239, 1980, 8249, 5107, 5887, 1506, 6599, 2689, 9101, 3964,
        6864,  802, 2943, 1801, 6115, 5170, 1249, 3039], device='cuda:1')
idx in forward tensor([1699, 5079, 7608, 3519, 2181, 3686, 5610, 5056, 3151, 4378, 1968, 7479,
          65,  536, 8802, 5082, 8009, 8620, 8726, 5464, 1146, 8958,  479, 4727,
        5819, 2115, 7132, 1636, 2730, 3072, 2537, 5321], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3826, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3747, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3880, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3796, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3665, 5592, 4439, 4309, 1554,  923, 8853, 7792, 8173, 3949,  637,  575,
        3817, 6135, 8154, 1261, 6815, 8175, 1474,   19, 8031, 6676, 1468, 6790,
        8546, 8343, 2262,  953, 6278, 6639, 1269, 2208], device='cuda:0')
idx in forward tensor([8217, 6028, 8567, 4496, 1896, 5807, 7586, 5345, 5307, 2929,  118, 5393,
        1994, 5854, 7813, 6203, 4729, 6961, 8335, 9085, 9135, 8658, 5517, 6484,
        4253, 8435, 8168, 7924, 2740, 3150, 5704, 2169], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3667, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3565, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3862, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3788, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8051, 8508,  413, 7832, 6952, 1234, 2503,  700, 3228, 8929, 8092, 9037,
        4707, 7181, 7988, 2175,  727,  407, 2725, 5608, 3854, 4709, 8252, 3008,
        6621, 5450, 5304,  850, 5479, 7834,  709, 8475], device='cuda:1')
tensor([8079, 1301, 7926, 8982, 4053, 4265,  767, 9117, 9055, 1117, 6780, 8096,
        1473, 5043, 6906, 7116, 7329, 8727, 4414, 8935, 2560, 4658, 8023, 4269,
        4059, 3402, 8205, 7519, 4663,  504, 3924, 4548], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4033, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3966, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3845, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3764, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([1751, 6194,  427, 6056, 2485, 8016,  933, 5347, 8081, 7469, 7362, 1540,
        5865, 7441, 1174, 2588, 6985, 2809, 6500, 4274, 1329, 1976, 5558,  686,
        8903, 6245, 8956, 7110, 5551, 7260, 1201, 4233], device='cuda:1')
idx in forward tensor([4659, 3579, 4504, 3248, 1999, 8332, 3000, 7214, 7343,   46, 2030, 6920,
        6202, 8801, 4821, 6961, 4749,  730, 5385, 2626,  288, 4572, 3900, 1038,
        4489, 1661, 5923, 8116, 2135,  814, 7052, 1356], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3811, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3725, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3937, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3854, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5985, 3658, 5274, 1859, 8160, 5994, 6180, 2229,   41,  859, 5512, 3991,
        8120, 3811, 8118, 9018, 8696, 8929, 4324, 1620,  389, 8176, 5236, 3194,
         204,  753, 6252,  803,  494,  890,  758,  327], device='cuda:0')
tensor([6257, 8268, 6004, 7179, 3039, 4214, 5193, 7376, 6697, 2990, 1353, 6622,
        2003, 8203, 6351, 4924, 7269, 1485, 7239, 4379, 5204, 1766, 4005, 3551,
        4879, 6700, 1775, 2324, 4855, 1294, 5271,  624], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3746, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3648, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3788, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3700, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6007, 4817, 8183, 7365, 1873, 4227, 7176, 5835, 3875, 6922, 5505,  367,
        4243, 8400, 1143, 3034, 5076,  235, 7626, 3731, 5745, 4482, 7194, 8842,
        6314, 4934, 6202, 6254,  410, 6859, 3820, 9038], device='cuda:0')
tensor([5218,  644, 8362, 3573, 2582, 2694, 5446,  706, 6171, 7364, 5294, 8378,
        8181, 5178, 8661, 2245, 4813, 1365,  886, 8383, 2775, 3668, 2977, 5980,
        4503, 8173, 1893, 6951, 7244, 8905, 7753, 1875], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3911, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3835, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3834, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3746, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7134, 3935, 2598, 3305,  448, 1683, 1534, 3319, 7045, 6640, 5768, 4958,
         433, 4298, 5140, 8540, 5793, 7229, 7997, 5847, 3432, 3452, 3346, 4437,
        5624, 6062, 1314,  470, 4978, 1228, 6381, 1709], device='cuda:0')
tensor([1502, 5455,  496, 2054, 3975,  163, 6382, 1299, 5066, 8709, 8243,   80,
        9106, 2047, 2459, 4957, 5660, 3871, 6570, 5351, 5340, 3049, 5895,  302,
        9031, 1454, 9026, 7161, 4539, 1026, 5301, 5527], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3869, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3776, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3786, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3706, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4222, 8200, 6686, 7251, 2151, 9006, 3908, 7416, 4831, 2819, 8620, 8673,
        4902, 6582, 3910, 6677, 7465, 7422, 2140, 8940,  250, 8572, 7836, 6107,
        1109, 1265, 2243, 7297, 5300, 4674,  855,   77], device='cuda:0')
tensor([3373, 2003, 8357, 3562, 1970, 7321, 5027, 7629, 4945, 8323, 3937, 4535,
        7328, 3283, 2257, 1216, 4017, 1985,  245, 5337, 7719, 4248, 1504, 5733,
        8714, 5448, 8602, 4411,  705, 1535, 9052, 5782], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3845, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3776, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3684, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3577, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8632, 4377, 9028, 5021, 4204, 6359, 4693, 3282,  128, 4103, 6608, 8550,
        1134, 1948, 7939, 4977, 8836, 4256, 2189, 3051, 4955, 2945,  753, 7053,
         646, 2059, 7479, 8422, 2472, 5730, 6796, 2636], device='cuda:0')
tensor([1406, 2383, 8209, 8668, 2207, 8932, 7996, 6887, 1833, 5584, 7742, 3243,
        6285, 1957, 3349, 1733, 5428,  730,  474, 4341, 3695, 6145, 1386, 8007,
        4758, 8655, 5058, 2422, 4331, 1500, 4279,  918], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3711, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3609, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3779, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3690, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3379, 9045, 3788,  690,  319,  848, 6309, 8658, 7148, 7126, 4633, 6925,
        8459, 8154, 8799,  755, 5977, 8848, 3573, 5887, 3734, 1064, 5673, 4394,
        4620, 2847, 7098, 1841, 7719, 4632,  915, 6525], device='cuda:0')
tensor([6536, 2267, 4018, 3044, 1804, 3102,  479, 7676, 6457, 4016, 3738, 6425,
        1861, 1076, 4253,  467, 3030, 6921, 4598, 3473, 5715, 6874, 7497, 2970,
         757, 3434, 7530, 5873, 5837, 8149, 3893, 1872], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3722, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3625, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3795, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3697, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4789, 7708,  258, 2427, 7879, 4707,  848,  694, 6275, 6757, 5812, 8044,
        4002, 2226, 8867, 1799, 7810, 8446, 3026, 8838, 2848, 7018, 8247,  901,
        8949, 8238, 3935, 7928,  756, 1889, 2899, 2772], device='cuda:0')
tensor([6293, 5235, 1118, 7027, 6697, 6683, 6984, 3687, 7365,  931, 4860, 2402,
         620, 5783, 1406, 5169, 6062, 1830,  978, 8102, 6473,  177, 5394, 1639,
        4456, 6519, 3926, 2403, 5714, 7984, 1772, 2963], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3739, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3643, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3954, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3891, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8711, 8542, 7694, 7277, 8813, 1230, 5757, 6943, 7314,  878, 7165, 1196,
        4363, 5142, 4226, 1925, 3948,  970, 8791,  485, 9062, 7336, 5549,  640,
        6789, 1877, 8861, 5798,  733, 5534, 6348, 2754], device='cuda:0')
tensor([ 336, 4238, 9053, 6362, 8594, 4687, 3822, 2922, 2845, 5924, 4125, 2084,
        1065,  933, 1775, 8300, 4240, 8087, 2094, 8497, 7036,  433, 8112, 8155,
        1574, 2270, 5225, 4733, 4671, 7687,  317, 4243], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4022, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3961, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3942, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3869, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2845, 7546, 7300, 8485, 1484, 4191, 5584, 3089, 5731, 7638, 1400, 7964,
        5279, 6601, 2528, 1753, 3362, 4601, 2438, 6113, 5772, 5402, 1744,  381,
        7101, 3299, 6896, 2854, 8928, 6941, 2994,  813], device='cuda:0')
tensor([3525, 8085, 2425, 5491, 1786, 6688, 3835, 5078, 1617, 8517, 1929, 1419,
        8335, 1909, 2571, 4114, 3247, 2204, 3495, 6786, 2360,  849, 3166,  121,
        5958, 5289, 7524, 4617, 3365,  714, 8135, 2769], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3782, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3791, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3713, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3684, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8760, 8984, 3433, 5536, 3039, 9117,  264, 3434, 1531, 2907, 3697, 6974,
        1539, 7590, 3161, 2177, 8997, 7738, 4057, 2817, 2034, 8937, 1862, 8791,
        5755, 7176,   56, 4378, 6795,  561, 3893, 5191], device='cuda:0')
idx in forward tensor([8785, 6761, 2579,  515, 2162, 6949, 3690,  988, 4934, 8562, 4465, 5444,
        8586, 4201, 6392, 2919, 2637, 1917, 2795, 4351, 3580,  752, 6724, 1357,
        1225, 5090, 6441, 4181,  234, 2064, 3506,  539], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3864, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3777, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3876, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3806, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([1870, 2565, 6874, 1105,  996, 1442, 6303, 1212, 1027, 1710, 5196, 5862,
        3012, 2968, 4121, 1035, 7511,  627,  159,  447, 7113, 7053, 6839, 3986,
        8751, 7354, 8657,  296,  660, 1737, 5186, 1404], device='cuda:0')
idx in forward tensor([2846, 5905, 6275, 4818, 8928, 8620, 3653, 5624, 6029, 6001, 6867, 5385,
        1880, 3820, 7212, 5671, 8975, 3504, 7771, 7918, 7275, 6798, 1977, 7913,
        2720, 3536, 8033,  566,  167, 1497, 8975, 7675], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3929, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3857, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3717, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3616, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2527, 7835, 7946,  556, 3105, 3078, 5727, 1597, 1930, 2522, 1881,  761,
        3266, 5379, 7666, 2464, 4717, 1834, 1376, 2854, 2349, 8481, 4329, 5378,
        3554, 8210, 1656, 2299, 7669, 1378, 5845, 2265], device='cuda:0')
tensor([1160, 5316, 5272,  290, 5969, 4144, 4449, 8422, 6207, 8749, 3553, 2656,
        3423, 4550, 1460, 8705, 1947, 6135, 4935, 2670, 8516, 2001, 6041, 2754,
        1677, 5023, 4409, 8364, 5074, 5438, 4926,  751], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3902, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3820, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3734, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3638, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5363, 8608,  175, 7254, 6019, 6706, 3900, 8500,  303, 3890, 8989, 5092,
        5343, 5165, 6143, 3417, 4915, 4474, 2739, 7966,  449, 5115, 2324, 5813,
        3795, 8511, 9078, 7740, 5107, 6678, 7540, 4750], device='cuda:1')
idx in forward tensor([5364, 8315, 5495, 9121, 7326, 2189, 6098, 4804, 5853, 2885, 6284, 6638,
        5395, 6094, 1834, 4211, 8487, 1455,  411, 2858, 8872, 3887, 4014, 3518,
        1441, 3705, 2518,   69, 1458, 8595, 1009, 4201], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3835, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3751, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3732, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3636, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4027, 7475, 8101, 6517, 7371, 4129, 7123, 5290, 2501, 5432, 8270, 3780,
        8269, 5366,  411,  578, 4548, 5477, 4683,  852, 4333, 8295, 5067, 5265,
        8762, 6909, 3539, 5054, 5390, 2187, 5261, 1194], device='cuda:0')
tensor([1303, 5443, 5509, 7030,  795, 8654, 7527, 4319, 2987, 3969, 3938, 1359,
        5971, 4199, 1711, 7826, 5968, 8999, 5331, 7014, 8296, 7374,  373, 1646,
        5928, 5060, 2988, 7120,  919, 2629, 6218, 4861], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3777, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3682, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3908, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3831, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8213, 5620, 3482, 6789, 4189, 8907, 3028, 1147, 5613,  207, 8003, 2195,
         772, 5535, 2344, 2868, 7052, 7308,   20,   62, 1871, 4386, 3969, 2861,
        2817, 1867, 1378, 1762, 1644,  271, 3587, 7474], device='cuda:0')
tensor([7307, 3727, 4348, 6146, 5196, 3555, 2067, 7484, 8211, 6213, 2700, 8241,
        5349, 2163, 8393,    4, 7085, 8470, 6388, 7173, 7338, 3185, 7498, 4576,
        4879, 8112, 5657, 2231, 3502, 9091, 1994,  798], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3919, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3841, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3853, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3784, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6117,  951,  173, 2463, 2137,  168, 4089, 3437, 6038, 6791, 7898, 8934,
        3888, 7552, 1510, 8171, 8393,  542, 2450, 8664, 2046,  212, 5913, 5614,
        2469, 5577, 1859, 3140, 8093, 2205,  992, 3934], device='cuda:1')
tensor([7877, 6137, 1242, 4338, 4507, 2888, 8573, 4716, 8069, 2535, 2535, 3358,
         607, 6703, 3977, 4941, 1740,  627, 2730, 5258, 2468, 4457, 2618, 3361,
        2733,  431, 7391, 4542, 5860, 1640, 5300,  166], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3961, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3888, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3711, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3608, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forwardtensor([4767, 5084, 3763, 6846, 6913, 8014, 3499, 2057, 5051, 8565, 8248, 3859,
        4566,  917, 7033, 8951, 6325, 3229, 4969, 1004, 4068, 7166, 5704, 4029,
        1953, 3617, 7718, 3177, 8421, 3690,  338,  841], device='cuda:1')
 tensor([4891, 7361, 2322, 8623, 4048, 1632, 6175, 5352, 2791, 1710, 3172, 2989,
        8402, 8275, 7087, 1791, 6311, 1937, 3188, 7695,   68, 6741, 1157,  555,
         669, 5231,  967, 5046, 7686, 6719, 2720, 3343], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3829, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3741, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3725, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3616, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3032, 4248, 6484, 3809, 7968, 4203, 2362,  770,  927, 4837, 1200, 6878,
        5256, 2155, 6443, 6351, 4782, 8828, 6695, 4065, 1151, 5768, 2546, 5495,
        7360, 3336,  945, 7461, 1452, 6487, 6838, 3444], device='cuda:1')
idx in forward tensor([  93,  110, 4142, 4172,  837, 6393, 3075, 8622, 7927,  588,  937, 8236,
        4824, 4523, 2127, 7460, 5566, 5153, 2969, 2089, 6747, 4343, 7025,  598,
        8795, 1660, 1995, 7360, 4131, 8898, 5964, 4122], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3900, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3824, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3947, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3883, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7796, 5127, 2210, 2267, 7684,  533, 6566, 4282, 5549, 5695,   35, 5265,
        8256,  601, 2580, 6581, 7233,  972, 3601, 5140, 1367, 1437, 4297, 1264,
        7224, 1541, 4757, 2787, 3750, 6512, 7348, 6210], device='cuda:0')
tensor([2419, 8693, 6213, 2555, 3273, 2029, 1947, 7665,  965, 3524,  864,  677,
        5211, 2364, 8010, 7284, 8008,  280, 8516,  596, 4671,  908, 2365, 1013,
        6852, 6648, 5192, 4193, 2898, 2957,  106,  887], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3833, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3751, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3758, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3665, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4228, 7372, 4476, 3495, 1408, 8049, 2915, 2969, 6593, 4859, 4921, 1549,
        1608, 3333,  362, 3022, 1110, 8916, 5214, 8489,  167, 8941, 8313, 3277,
        4938, 4866, 5769, 3838, 7895, 2248, 4138, 8442], device='cuda:1')
tensor([9028, 5708, 9132,  625, 7202, 6664, 6922,  863, 7631, 1894, 3781, 8986,
         263,  420, 3855, 4468, 8252,  602,  393, 5530, 6507, 3691, 4997, 2650,
        7780, 3340, 6571, 3058, 4463, 8228, 1393, 2661], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3852, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3762, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3647, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3541, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([ 846, 8161, 4308, 7294, 2628, 3255, 5666, 7497, 1516,  643, 6348, 3229,
        3195, 3816, 2811,  968, 3481, 4496, 4464, 8994, 3093, 2402, 6683, 6080,
         540, 6492,  351, 1643,  461,  946, 1526,  401], device='cuda:0')
idx in forward tensor([ 743, 2938, 6057,    3, 1414, 2844, 6224, 5709, 2037,  384, 8527, 4937,
        6518, 1418, 7397, 1098, 3353, 7089, 8935, 8001, 6030, 2879, 8807, 2887,
        7546, 4158, 7873, 8127, 4213, 2686,  159, 5909], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3972, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3764, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3905, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3671, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1151,  872, 9143, 4192, 8411, 4377, 6947, 4622, 3155, 8153,  224, 7109,
        7127,  225, 6085, 2834, 2972, 2627, 1792, 3026, 8502, 5053, 3205, 1221,
        3047, 4712, 4125,  375, 6259, 4498, 1146, 7386], device='cuda:1')
tensor([7126, 2527, 7586, 1944, 6358, 5275, 2703, 7506,  673, 8818, 2051, 4276,
         196, 6783, 8906, 3025, 5247, 1387, 8436, 4438, 6898, 1517,  650, 5234,
        6716, 4905, 3160, 4485, 3081, 3696, 8074, 4510], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3881, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3800, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3790, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3690, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4034, 5304, 7042, 6736, 7630, 5731, 1735, 4430, 6139, 2055, 3068, 6068,
        6162, 2366, 6513, 4898, 8161, 2380, 1001, 4614, 3605, 3670, 7674,  247,
        8466, 9134, 5198, 3147, 8534, 4477, 4108, 3718], device='cuda:0')
idx in forward tensor([ 790,  507, 2136, 3250, 8195, 2015, 4388, 3060, 3057, 4618, 3806, 6668,
        3672, 3073, 1669, 1586, 6131, 4120, 9044, 7099, 7985, 4293, 6249, 7677,
        5381, 4952, 8791, 5107, 3938, 2596, 8968, 4877], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3852, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3771, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3845, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3750, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2671, 4069, 3210, 4731, 3669, 7106,  269, 3167, 2822, 8756, 6429, 7338,
        6632,  985,  130, 2924,  928, 2589, 9080, 8163, 1032, 3791,  713, 2040,
        4405,  616, 4624, 4472, 8887,  848,  128, 8920], device='cuda:0')
tensor([3558, 6344, 4486, 1952, 7160, 5282, 6235, 8914, 6354, 8323, 1583, 8041,
        2489, 7320, 6543, 8888, 4946, 8244, 1893,  139, 3843, 6056, 1647, 2173,
        8870, 7820, 6110, 9137, 6723, 1885, 3264, 4063], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3823, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3735, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3785, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3700, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 476, 6854, 3222, 5772, 1318, 1117, 2419, 1612, 2854, 1469, 1361, 6122,
        4660, 7245, 9107,  556, 4623, 2341,  987, 9143, 2534, 6547,  999, 2228,
        4414, 6880, 5518, 3193, 7637, 7452, 2374, 4111], device='cuda:0')
tensor([1235, 2018, 3268,  123, 6427, 6967, 1691, 2507, 6056, 8575, 1884, 5672,
        5890, 6171, 6614, 6846, 5563, 6629,  627, 7130, 7307, 3913, 3516, 6086,
        9082, 3717, 3184, 8169, 6976,  337, 2925, 5056], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3891, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3812, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3790, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3707, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8139, 1042,  584,  713, 3258, 1559, 6178, 6730, 8226, 6287, 2671, 4463,
        1325, 9046, 6151, 5441, 3393, 3094, 4092, 5918, 4089,  752,  190,  270,
        5980, 8116, 4881, 1341, 5159, 5637, 1185, 1976], device='cuda:0')
idx in forward tensor([5184, 2163,  365, 8957, 5609, 8365, 4413, 1739, 1370, 1799, 6191, 5742,
        2486, 2551, 5958, 4471, 1784, 1508, 6995, 3757, 3739, 8728, 2455, 4160,
        4679,   48, 7504,  405, 1340, 4044, 6774, 6972], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4033, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3974, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3949, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3882, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8972, 1475, 5515, 8216, 5192, 4956, 6180, 2086, 1222,  677, 4799, 2463,
        5262, 1089, 6801, 6402, 6734, 6023, 8242, 4739, 5542, 8886, 2827, 7239,
        3632, 1624, 5303, 7949, 8960, 1997, 1921,  625], device='cuda:0')
tensor([6109, 5554, 5965,  351, 2042, 5220, 8784, 2629, 1990, 6739, 4232, 3716,
        3056, 2914, 9051, 1189,  607, 7459, 3260, 4447, 1009, 5521, 2181,   65,
        7083, 3368, 9082, 3827, 7845, 3297, 5958, 1743], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3781, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3690, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3926, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3865, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6641, 6788, 5489, 8290, 6685, 2350, 5566,  840, 3342, 7128, 6094, 4411,
        5261, 3094, 8063,  150, 2262, 2320, 6383, 5635, 3736, 7583, 4141, 9033,
        4331,  274, 1808, 4271, 1311, 3714, 5167, 8545], device='cuda:0')
tensor([1148, 4073, 3492, 6380, 4070, 4843, 3778, 3232, 1827, 6640, 6147,   85,
        7045, 5557, 4765, 7710, 1129, 2100, 1343, 7342, 1153, 4801, 7362, 4973,
        3532, 5510, 3813, 8444, 5798, 3959, 7435, 2266], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3808, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3713, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3817, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3727, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4100, 3185, 5504, 4460, 5694, 2651, 5785, 4946, 8424, 4997, 4521, 2427,
        2992, 6588, 2406, 5286, 3687, 7692,  935, 2795, 5397, 8809, 6767, 5648,
        2336, 1731, 8696,   80, 3163,  968,  526, 6508], device='cuda:0')
idx in forward tensor([ 972, 4949, 8940, 6447, 6431, 5417, 5534, 3253,  646, 8397, 8825, 4081,
        4566, 4724, 1584, 6359, 8423, 3098, 3301, 8948, 4424, 3308, 6102, 6245,
        3876, 5721, 8278, 1465, 2783, 3613, 7746, 3420], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3806, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3719, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3833, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3759, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1190, 7341,  906, 3403, 3911, 3747,  371, 6336, 1254, 8586, 4851, 2157,
        2630, 5559, 1045, 1345, 2411,  310, 1117, 6763, 5722, 5638, 6091, 1622,
        1140, 1023, 4959, 4922, 6256, 9007,  744, 4718], device='cuda:0')
tensor([5235, 4472, 7537, 3633, 2130, 2764,  421, 7569, 4973, 5281, 2376,  738,
        1141, 4592, 7794, 7769, 6918, 8415, 7734, 1991,  188, 7324, 3067, 4298,
        4993, 4367, 6074,  617, 6146, 5770, 7049,  279], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3913, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3840, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3713, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3601, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3768, 6122, 1937, 3091, 4884, 2264, 6130, 5933,  109, 8119, 7461, 2576,
        3252, 5122,  639, 2834,  512, 7403, 1255, 5601,  827, 4339, 3436, 4241,
        8303, 2863, 3595, 4871, 1182, 7565, 5507, 3998], device='cuda:0')
idx in forward tensor([3171, 2441, 7311, 3342,   32,  947, 6735, 2739, 1927, 3491, 2950, 7566,
         832, 2852, 8253, 1244, 7094, 4716, 5992, 2428, 6818, 6978, 2060, 2036,
        3889,  353, 4974, 3747, 1500, 6219, 2935, 8483], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3844, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3756, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3781, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3692, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([2913,  608, 8616,  538, 1660, 2113, 1212, 3958, 7782, 2624, 1682, 7811,
        1439,  516,  731, 6842, 1850,  816, 6162, 7496, 6980, 7528, 7384, 5490,
        7708, 9144, 5237, 2665, 8103, 4121,  188, 6342], device='cuda:1')
idx in forward tensor([5804, 7809, 6178,  335, 6480, 4742,   28, 2862, 5001, 3164, 6175, 1289,
        5834, 6870, 2782, 4237, 8858, 4791, 4084, 4244, 1377, 3933, 2080, 9041,
        9141, 1855, 7818, 7175,  837,  824, 7024, 3863], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3767, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3676, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3975, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3918, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3403, 8673, 2600, 5656, 5481, 4945, 3665, 5301, 6636,  131, 4627, 2783,
        7318, 4494, 1052,  352, 5871, 4744, 4955, 2988, 7112, 6620, 5858,  194,
        1021, 8623, 5441, 6575, 8578, 4311, 1266, 2524], device='cuda:0')
idx in forward tensor([2010, 2487, 4611, 7428, 8288, 4294, 5338, 2152, 7448, 4244, 5703, 5438,
        1190, 6261, 3985, 9140, 3162, 4578, 1452,  119, 5248, 4428,  341, 2235,
        1515, 9042, 3805, 4255, 2734, 6303, 2409, 8554], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forwardtext in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
 torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3847, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3770, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3862, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3783, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4915, 6358, 3149, 2128, 3952, 8479, 2549, 8792, 7082, 2580,  156, 2524,
        3292, 1556, 2436, 4362, 5387, 5287,  366, 6886, 1480, 1600, 3925, 3680,
        3123, 6059, 7017, 2216, 8467, 3755, 3625, 4216], device='cuda:0')
tensor([  67, 2928, 4442, 3952, 6268, 8612,  573, 8410, 6881, 6672, 2974, 1809,
         283, 4382, 1459, 6799, 6130,  915, 1327, 2136, 5637, 8681, 5931, 2116,
        2006, 2400, 5474, 2504, 4359, 2474, 6334, 3194], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3830, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3754, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3881, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3795, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7964, 1455, 1593,   73, 7211, 1862,  584,  696, 4303,  153,  758, 6594,
        3438, 2548, 5871, 6336, 8427, 8243, 4636, 8849, 7363, 3249, 5199, 3056,
        5951, 6881,  201, 8948, 1368, 7408, 3615, 2822], device='cuda:0')
idx in forward tensor([4043, 5550, 2136, 8537, 5488, 5621, 4768, 6760, 2532, 6218,  612, 2313,
         474, 3391, 4988, 7659, 5102, 4194, 6970, 8333, 7786, 3233, 8581, 4519,
        3924, 5556, 5630, 2969, 2542, 7031, 2325, 8624], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3830, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3747, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3906, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3828, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 108, 2961, 6681, 2864, 4122, 1955, 1822,  740, 4998, 7413, 8985, 6880,
        4475, 1093, 3099, 2211, 2670, 6583,   60, 8189, 8885, 7938, 6313, 2820,
        8402, 4612, 8545, 1787, 5474, 8975, 2225, 2592], device='cuda:1')
idx in forward tensor([3119, 6588, 7211, 1293, 2304, 3235, 5692, 5868, 5090, 4276, 5053, 7764,
        6772, 5232, 1967, 8834, 8766,  533, 3368, 6670,  467, 8275, 3311, 1986,
        5837, 2681, 6319, 7079, 2309, 1811, 8399, 5974], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3874, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3794, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3711, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3621, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1025, 7441, 3132, 4218, 8919, 7440, 8936, 5670, 4936, 2677, 5531, 4454,
        5782, 1526, 5075, 5101,  155, 4773, 7506, 5127, 3901, 6718,  604, 4895,
        1684, 1465, 4478, 7639, 3551, 3169, 5444,  175], device='cuda:0')
tensor([1463, 1559, 9035, 5657, 5457, 5679, 1981, 5336, 7531, 5239, 7097, 2591,
        1579, 5667, 2778, 4152, 2719, 6710, 6699,  853, 6552, 9072, 8807, 6647,
        3167, 7175, 6671, 6643, 7324, 7170, 3660, 4551], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3843, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3761, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3905, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3828, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([1167, 6109, 4940, 8107, 1603, 2614, 2840, 5099, 8609, 4640, 3226, 7972,
         185, 3275, 4086,  597,  116, 5527, 8913, 4522, 4089, 7253,  866, 8525,
         436, 4315, 7407, 3973, 4831, 5620, 5327, 2103], device='cuda:0')
idx in forward tensor([6244, 8894, 5458, 5344,  120,  453, 2797, 6386, 5630, 9143, 9040, 1880,
        6507, 6678, 6812,  645, 2281, 6956, 8578, 2773, 7717,  560,  966, 4903,
        3872, 3760, 4689, 2467, 8072, 4508, 7314,  720], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3835, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3762, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3791, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3700, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([3894, 1839, 4345, 4183, 5353, 5986, 1609, 1068,  844, 4197, 3443, 2424,
        4909, 6511, 1395, 7756, 8942, 6409, 8552, 8418, 1198, 2918, 5220, 3204,
        7529, 4238, 6828, 2226, 7548, 4562,  183, 2269], device='cuda:1')
idx in forward tensor([7715, 5362,  182, 5150, 6563, 5335, 3851, 3133, 1865, 5136,   21, 8899,
        1484, 7768, 1131, 6587, 2147, 4477, 3799, 8016, 6154, 7795, 1770, 1437,
        1316, 6903,  600, 5901, 3177, 8260, 9106, 3489], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3786, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3706, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3720, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3627, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3020, 6441, 1598, 5781, 3470, 2295, 7443, 8940, 1526, 2820, 1814, 8702,
        1962, 1358, 1641, 8064, 1946, 2844, 1188, 8746, 1842, 2408, 1273,  376,
        6298, 3220, 2198, 1376, 7938, 1604, 8704, 5609], device='cuda:0')
tensor([8775, 3418, 7572, 7912, 9083,  171, 2611, 5838, 1562, 4546, 3009, 5009,
        4058, 7300, 8037, 4379, 5823, 4828, 3840, 6750, 8634, 8026, 6118, 4368,
        1679, 6998, 3281,  505, 2033, 7989, 5177, 5888], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3936, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3865, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3877, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3798, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7600,  571, 6714, 4337, 2444, 8045, 6670, 4031, 2712,  369, 5526, 5008,
        7250, 6242, 3430, 5788, 1441, 2649, 2926, 2118, 2112, 4449, 1816, 6785,
        7190, 5568, 7290, 6381, 5176, 1652, 1642, 8496], device='cuda:1')
tensor([2078, 8871, 6883, 6267, 4325, 1205, 7886, 4354, 3412, 2924, 6177, 8338,
        5083,  664, 3459, 7067, 6260, 5697, 9077, 6452, 4072, 3591, 5002,  359,
         742, 5434, 3866,  610, 5013,   48, 3005,  346], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3843, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3758, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3964, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3900, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6991,  472, 3892, 7812,  746,  870, 5050, 2903, 2073, 4608, 8996, 6684,
        3721, 9050, 5256, 7771, 7960, 4190, 7924, 7160, 5154,  962, 1812, 1383,
        9042, 4840, 6108, 2789, 6605, 1022, 7648, 7346], device='cuda:0')
tensor([2099, 1097, 5708, 8635, 3763, 3643, 6251,  200, 7365, 8547, 7435, 5133,
        7085, 1627, 7065, 2810, 8665, 5203, 4187, 5601, 4222,  397, 2631, 1488,
        7738, 4511, 4137, 1783, 6324,  509, 9120, 3830], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3783, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3699, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3916, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3845, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6607, 4113, 6146, 6913, 2726, 5836, 7547,  451, 3856, 6682, 7549, 4630,
         841, 8583, 6168, 8893, 9084, 5758, 8186, 3011, 4695, 7486, 5891, 3144,
        8443, 3598, 6179,  988, 7287, 5544,  149, 1243], device='cuda:0')
idx in forward tensor([  68,   18, 4417,  433, 2989, 1891,  903, 8401, 4392, 1222, 2985, 6421,
        2751,  246, 8011, 2257, 3143, 5030, 2782, 2048, 6283, 4933, 3075, 8117,
        6917,   14, 5088, 3011, 8301, 6388, 6498, 2431], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3903, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3831, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3809, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3723, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([9137, 9025, 8121, 7569, 6225, 1812, 1565, 3097, 3367, 4842, 2552, 4874,
        6330, 1637, 8344, 4428, 8696, 8405, 4812,  704,  703,  795, 7897, 7090,
        8688, 6646, 4961,   97, 5326, 5791, 7891, 4084], device='cuda:1')
tensor([1218, 6152, 7257, 1364,   29, 3094, 1593,   55, 3356, 7111, 4692, 8361,
        6361, 4292, 8383, 1597, 7900, 4991, 4483, 3688, 8506,  723, 4489, 8104,
        3996, 3922, 2842, 8806, 1259, 3172, 3679, 9064], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3899, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3821, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3909, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3835, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5413, 5582, 6110, 3425, 3433, 8708, 1052, 3210, 4686, 6747, 6144, 4342,
        8160, 4347, 3837, 7015, 7227, 3306, 2343,  327, 3395, 7938, 8006, 2892,
        1407, 2957, 5317, 4841,  337, 8402,  198,  322], device='cuda:0')
tensor([9074, 1933, 7156,  406,  795, 1917, 1366, 2779, 8810, 5370, 1261, 5927,
        6510, 7159, 2549, 2058, 3272, 7566, 7330, 1830, 7773, 2448, 7619, 6265,
        3186, 3446, 6032, 7444, 1589, 3921,  381,  512], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3961, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3894, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3854, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3754, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2313, 8849, 1149, 4688, 3695, 4381, 5154, 4243, 3897, 3178, 8463,   36,
        2882, 6056, 7732, 9022, 7787, 8586, 5449, 5251, 6863,   72, 3772, 6020,
        2251, 5476, 2261, 3740, 3512,  606, 7990, 8774], device='cuda:0')
tensor([1263, 1949,  465, 6941, 5181, 8372, 6410, 5188, 1022,  638, 8811, 6591,
        3955, 5113, 4101, 6052, 5274,  663, 2316, 4358, 5709, 1130, 1282, 8711,
        6144, 7260, 1716, 7015, 5894,  189, 1307, 3003], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3806, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3730, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3893, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3825, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8637, 4712, 5255, 1405, 1468, 8128, 3004, 6444, 6333, 5752, 6034, 1955,
        5967, 8226, 5493, 8452, 2572,  323, 5347, 7185, 4722, 9089, 4841, 8582,
        7293, 7561, 5947, 2012, 3386,   43, 1724, 3174], device='cuda:0')
tensor([ 160, 5958,  368, 5312, 3913, 5061, 2612, 3933,  859, 4120, 5297, 6711,
        2857,  806, 6010, 2607, 1650, 4448, 5865, 8923, 9133, 5659, 7449,   49,
        7171, 8387, 6968, 3233, 7931, 4729, 7622, 4804], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3938, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3871, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3854, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3760, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6683, 5611, 5988, 6407, 1739, 8114, 6124, 3873,  269, 8417, 5442, 6408,
        3239, 2997, 4588,  896, 6251, 3072, 8386, 6429, 5900, 6871, 4649, 5168,
        5989, 4391, 5770, 8356, 7922, 3241,  389, 6001], device='cuda:0')
idx in forward tensor([2576,  659,  650, 8563, 4906, 3540, 5468, 2476,  829, 2029, 5147, 1245,
        8348, 2790, 9113, 9091, 2668, 1158, 1243, 6574, 6262, 6998, 2885, 8481,
        7508,  215, 3592, 8312,  261, 5017, 2083,  251], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3922, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3860, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3752, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3655, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3110, 1400, 2593,  544, 4116,  359, 5568, 8271, 8814, 1596, 6337, 8285,
        2717, 3731, 2028, 4557, 6995, 7188, 6676, 5290, 3880, 2069, 5317, 6471,
        1430, 1010, 7515, 1712, 1302, 3186, 4791, 5411], device='cuda:0')
tensor([ 227, 1395, 4847, 3765, 7336, 1783, 4522, 8420, 8314, 1850, 5587, 4052,
        6121, 1205, 2179, 1971, 2583, 7537, 1193, 6749, 6231, 8563, 7457, 7582,
        8661, 8878, 5687, 7423, 5724, 5723, 8639, 7532], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forwardtext in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
 torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3834, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3760, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3770, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3688, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 665, 3048, 4718, 8019, 7325, 5963, 1233, 8270, 2054, 4369, 6198, 8109,
        4359, 4479, 3560, 6173, 4796, 6637, 4389, 2647, 9121,  555, 6129,  530,
        7667, 7793, 3692, 7540, 5399, 4472,  225, 2305], device='cuda:0')
tensor([6981, 5998, 5929, 4397, 5334, 3879, 3963, 3122, 3671, 5949, 5739, 6036,
        5517, 3018, 3402, 1822, 7241, 3396, 9125, 3435, 6861,  440, 7854, 6734,
        7966, 7087, 3426, 1145, 5617, 2470, 1426,   49], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3955, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3884, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3793, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3691, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7462, 1446, 5962, 6776, 2370, 7742, 8766, 5829, 7026, 2706,  847, 6751,
        1949, 5992,   44, 2880, 5044, 4755, 6996, 1568, 6043, 8871, 1318, 7503,
        2743, 8777, 1007, 3298, 1173, 4890, 6692, 5597], device='cuda:0')
tensor([5386, 7649, 8515,  990, 1776, 7361, 8541,  843, 7178,  749, 6172, 4284,
        3920, 6229, 8545,  200, 8609, 2600, 2354, 6260, 8912,  932, 2274, 8337,
        1254, 1088, 3550, 9136, 7051, 2843,  557, 1525], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3744, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3644, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3824, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3736, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([ 132, 2120, 4416, 5656, 8597, 7443, 1888,  469, 8666, 6925, 1569, 6672,
        4102, 5482, 7377, 5317, 2552, 7244, 5746, 4400, 6584, 4665, 3729, 8082,
        5423, 6865,  541, 2898, 4534, 5149, 8216, 4053], device='cuda:0')
idx in forward tensor([6205,  794, 7394, 4054,  186, 4583, 3204,  164, 4570, 6374, 6751, 1981,
        5655, 8855, 4421, 4605, 3266, 3110, 8548, 2539, 3322, 6129, 6221, 3858,
        7302, 6841, 3923, 8513, 2756, 2316, 2215, 4274], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3650, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3548, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3911, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3843, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4695, 6982, 6007, 3772, 8588, 7544, 7993, 8842, 8299, 5010, 1820, 5994,
        3807, 8368, 5928, 6940, 7047, 2053, 5365, 1781, 5175, 7526, 1316, 5870,
        6386, 6969, 6261, 1475, 5817, 5850, 8630,  455], device='cuda:1')
tensor([7282, 4610, 8475, 3651,  169, 3122, 9078, 4616, 2849, 7883, 5426,  936,
        5068,  331, 8411, 4717, 9111, 1180, 8747, 3820, 2960, 6784,  465, 4929,
        4595, 7073, 3755, 4781, 3684, 1707, 1124,  594], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3910, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3835, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3658, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3546, device='cuda:0', grad_fn=<MeanBackward0>)
[32m2023-10-20T16:22:08 | utils.basic_utils: [0mTrain Epoch: [0]  [400/572]  eta: 0:25:28  lr: 0.000010  temperature: 0.0181  video-loss_ita: 2.2480  video-loss_itm: 0.5705  time: 10.0607  data: 0.0101  max mem: 33192 res mem: 33720
idx in forward tensor([7705, 2429, 4938, 4867, 5398, 7679, 3346, 8002, 7747, 1603, 3933, 4042,
        4342, 7962, 4328, 7084, 7300, 1852, 7810,  578, 4547, 3870, 6626, 6594,
        8447, 5647, 6301, 6809, 8801,  676, 1317,  144], device='cuda:0')
idx in forward tensor([8868, 2180, 2793, 5732, 3453, 5362, 3729, 7289, 8679, 3173, 5037, 8393,
        8893, 1268,  558, 7714, 4845, 1311, 6156, 6752, 3880, 2087, 8093, 8461,
        9063, 6969, 1050, 1770, 5367, 6282, 7901,  546], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3755, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3667, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3788, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3707, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([5294, 3488, 6860, 5540, 3369, 4212,   83, 4739, 2515, 4576, 3937, 4541,
        6680, 4256, 1325, 3597, 8494, 3996, 2452, 6776, 2101, 6904, 6802, 1123,
        4944,   21, 1578, 5823, 3928, 2791, 2761, 1382], device='cuda:0')
idx in forward tensor([6198, 5934, 6362, 4642, 1735, 4899,   42,  663, 8200, 6088, 4881, 7746,
         806,  318, 1614, 3047, 5903, 3374, 1967, 2634, 2556, 3230, 1350, 7713,
        6454, 3059,  915, 4241, 7024, 2306, 7487, 5494], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3760, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3653, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4036, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3983, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8430, 6355, 8204, 2209, 7811, 1548, 2255, 5326, 6923, 7087, 6509, 7799,
        6274, 4280, 2377,   67, 6332, 6515, 5015, 4386, 4591, 1345, 1932, 6995,
        4616, 5705, 5752, 5671, 3684, 5452, 6210, 7319], device='cuda:1')
idx in forward tensor([7145, 4060, 6604, 5419, 2405, 4211, 4788, 4409, 5584, 3953, 3062, 1078,
        2444, 8568, 6749, 6161, 1601, 8617, 5154, 1303, 9003, 3480, 6000, 8862,
        7903, 2680, 6680, 2062, 1341, 2051, 5370, 4856], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3947, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3748, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3651, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3877, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4248, 6446, 6924, 5723,  314,  130, 4857, 2094, 2757, 1924, 7080, 3589,
        2543, 2592,  675, 7396, 3731, 8268, 1477, 6816, 3475, 7733, 4732, 3326,
        7694, 7205, 1249, 5607, 3967, 4101, 7455, 6929], device='cuda:0')
idx in forward tensor([ 317, 4353, 8510, 2613, 5416, 4677,  748, 7299, 2305, 8765, 7227, 4882,
        4206, 7362, 3569, 3272, 8176, 6291, 4263, 7249, 7000, 3777, 7587, 9081,
        1913,  851, 2400, 1759, 5860, 5889, 1371, 8924], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3762, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3674, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3891, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3807, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7406, 7292, 2544, 2601, 6807,  505,  224, 8508, 1382, 6027, 8377, 7345,
        6854, 4618,  519, 6919,  664, 3764,  891, 1485,  826, 7291, 2113, 2301,
        1815, 5836, 8874, 2791, 6982, 2134, 6114,  978], device='cuda:0')
tensor([8030, 7327, 7698, 5911, 7238, 2277, 8568, 4666,  422, 2390, 5112,  607,
        5706,  449, 8841, 4473, 6181, 5590, 4982, 5714, 3494, 3422,  264, 3409,
        7056, 2330, 7897, 6521,  765, 5320, 1778, 6891], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4001, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3935, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3959, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3882, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7078, 7496, 1564, 6782, 3706, 5589, 3007, 1622, 2564, 5991, 5066,  307,
        8202, 1563, 2675, 8057, 6608, 9071, 8701, 5914, 1247,  170, 3450,  568,
        5555, 4241, 2110, 7254, 6376, 8533, 8709, 6997], device='cuda:0')
tensor([4235, 7793, 1767, 2411, 4080, 2935,  178, 1423, 3133, 2431, 1825, 2836,
        8629,  495, 4833, 3424, 9075, 7859,  402, 8495, 3594, 8590, 5741, 2302,
        3970, 2392,  628, 4784, 1057, 8225,  242, 4897], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3774, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3778, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3694, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3688, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3280, 3676, 4581, 7731, 4857, 4242, 3618, 1786, 1190, 1184, 2371,  985,
        7508, 6215, 2492, 1671, 2606, 1512, 8503, 6154, 2372, 5840,  887, 3872,
        8774, 2343, 9024, 2193, 5866, 3915, 2822, 4426], device='cuda:0')
idx in forward tensor([5273, 3681,  522, 6843, 1171, 1922, 7281, 2541, 4652, 5695,   93, 2030,
        3510, 4334, 1122, 4405, 7292, 1076, 8040, 7337, 1576, 8684, 9023,  371,
         316, 3320, 7890, 5223, 1032, 8786, 2377, 2016], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3674, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3581, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3797, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3715, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([6526, 5381,  257, 6342, 6437, 5724, 6297, 3594, 7928, 2537, 6173,  936,
        4968, 3503, 5629, 5192, 1581,  221, 1000, 4638, 5414, 8164, 2962, 4774,
        5080, 5814, 2894, 4778,  458, 5324, 5564, 7899], device='cuda:0')
idx in forward tensor([8846, 3369,  395,  936,  899, 8494, 8577, 5134,  579, 4470, 9056, 1738,
        7376, 4312, 4497, 7706, 3992, 6811, 6979, 2446, 5532,   45, 3487, 6869,
         687, 2126, 1009, 1044,  231, 7113, 4104, 3523], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3740, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3645, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3882, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3805, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6315, 5660, 2129, 1328, 5906, 8950, 3881, 7515, 5565, 7634, 4995, 7008,
         449, 9041, 6833, 6099, 3054, 3330, 6522,  580, 4167, 4767, 3551, 2808,
        7815,  212, 3399, 8336, 2703, 8340, 1690, 9006], device='cuda:0')
tensor([8184,  447, 7803, 4906, 6978,  439, 8223, 8913, 2663, 2180, 7899, 1825,
        7425, 6525, 5053, 4061, 2193, 6134, 7808, 2987, 5951, 3750, 5544, 6346,
        8125, 3652, 2743, 6743, 3922, 6216, 6076, 3951], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3796, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3711, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3869, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3797, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3191, 2011, 8286, 4667, 7129, 8209, 8722, 6972, 2990, 8288, 3887,  390,
        6506, 7453, 4072, 6974,  881, 7468,  205, 3440, 1452, 1951, 2311, 7884,
        5041, 3708, 5685, 5153, 1708, 3775, 7313,  463], device='cuda:0')
tensor([5969, 8719, 3357, 3413, 6438, 1964, 8441, 4155, 8830, 6624, 3151, 1832,
        7817, 4582, 4940, 1179, 4487, 8165, 6516, 5039, 3889,  206,  854, 2688,
        6173, 1596, 7224,  710, 2589, 7375, 2832,  609], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3880, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3811, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3715, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3619, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8489, 3965, 2924, 7803, 1937, 7468, 6239, 5656, 7699, 7511, 9104, 1789,
        3579, 1994, 7135, 1574, 6542, 5254,  584, 4701, 6498, 3448, 2830, 4426,
        8629, 3957, 6465, 8924, 8987, 2750, 7211, 2769], device='cuda:0')
idx in forward tensor([1556, 6671, 4164, 7879, 6959, 1105, 7128, 4356, 8376, 1927, 1155,  964,
        1027, 6190, 6340, 7178, 5956, 3723, 2139, 2149,   61, 1509, 1428, 6101,
        5239, 5899, 5640, 8099,  671, 7376, 8160,  692], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3850, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3774, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3809, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3719, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8482, 4537, 3713, 4159, 7625, 1377, 4574, 6891, 5432,  110, 1294, 5503,
        3785, 5807, 8011, 2761, 7735, 6017, 2794,  165, 8098, 5952,  353, 5805,
        3432,  816, 4764, 5898, 4821, 4547, 6125, 1084], device='cuda:1')
idx in forward tensor([1007,  733, 2624, 2059, 6637, 1845, 7217, 3481, 4980,  983, 5841, 2888,
        8097, 4080, 2586, 7234, 3206, 5020, 6209, 1679, 8534, 3877, 3829, 7538,
        3721, 6103, 1180, 4720, 7150,  232, 3956, 5187], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])

pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3905, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3823, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3818, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3725, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7806, 6692, 8630, 3866, 1108, 5621, 6574, 2376,  558, 6127,  188, 1866,
        3088, 8905, 5155, 5773, 8143,  166, 6418, 5019, 7951, 3737, 1828, 7509,
        2497,  272, 8458, 2974, 5011,  740, 7460, 5943], device='cuda:0')
idx in forward tensor([6614, 4574, 3586, 5652, 2592, 8238, 2679, 5890, 1509, 5361, 6265, 5772,
        3561,  756, 9054, 2678, 5817,  698, 6759, 5198, 3639, 6365, 2831, 2122,
         815, 9005, 2288, 5676, 4204, 2133, 2429,  399], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3745, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3655, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3742, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3645, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4085, 2767, 5527,  132, 5233, 5881, 5103, 6407, 8866, 1304, 7072, 3450,
        2243, 7071, 8509, 3968, 2369, 7504, 5274, 1099, 1175,  643, 1427, 2649,
        4361, 4252, 6493, 7347, 5200, 2333, 5707,   14], device='cuda:1')
idx in forward tensor([ 721, 6171, 7324, 3297, 2944, 3663, 4397, 3312, 2245, 1523, 7745, 3779,
        6077, 6861, 5450, 8123, 1328, 2513,  485, 8836, 3597, 6436, 4129, 2919,
        7894, 7151, 8980,  359, 7914,  685, 5757, 1983], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3890, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3809, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3867, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3794, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([9038, 5676, 2660, 1276, 5886, 2826, 2104,  214, 4199, 4271, 1710,  136,
        4635, 2510, 6834, 8754, 8637, 6272, 3189, 7900, 8963, 7711, 1173, 8382,
        4375, 1737, 5807, 3863, 5040, 1810, 4638, 6994], device='cuda:0')
idx in forward tensor([7016, 7416, 2954,  153, 4692, 7534, 1378, 8670, 8752, 7279, 8553, 1264,
        2002, 1173, 7282, 2304, 6096, 2499, 9095, 1774, 6372,  126, 7236, 1151,
        5422, 3577, 2567, 2129, 8248, 3187, 6528, 3874], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3682, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3589, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3923, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3857, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2377, 5790, 6054, 7831, 9036, 3645, 6150, 6531, 1346, 6527, 8157, 2107,
        7055, 5745, 7056,  136,  272, 1465, 7360, 2202, 6033, 2605, 1204, 4429,
        3046, 3663, 7434, 8418, 1066, 2883, 4512, 7720], device='cuda:0')
tensor([3080, 1156, 2814, 2290, 6345, 8507, 7415,  161, 2387,   99, 7398, 2361,
        2451, 8601, 6386, 3890,   76, 6581,  606, 6363, 2766, 3205, 3136, 3014,
        2105,  860, 8353, 7649, 2130, 5932, 1595, 4843], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3769, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3684, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3709, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3619, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5325, 4197, 1443, 2292, 4495, 3507, 1636,  300, 7220, 7226, 2050, 3631,
        3046,  259, 1101, 7760, 8907, 2023, 3027,  487, 4849, 1688,  278, 7141,
        6919, 5841, 4612, 3521, 4980, 9152, 3704, 4215], device='cuda:0')
tensor([7770, 7653,  797, 7093, 6615, 8147, 2721, 7107, 2731, 1492, 7090, 3474,
        4430, 5915, 6813, 3142, 3665, 2974, 7916,  405, 2617,  776, 5300, 6319,
        4154, 5356,  874, 7321, 4878, 2510, 1224,  885], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3883, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3806, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3773, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3684, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4773, 7081, 7812, 8944, 2534, 4818, 6742, 6723, 3756, 3419, 4379, 1727,
        8744, 4913, 6236, 3355, 4477, 6246,  450, 5098, 1106, 5675, 5220, 3993,
        1885, 4433, 2731, 4964, 1310, 5355, 6099, 8425], device='cuda:1')
tensor([3555,  912, 7092, 4533, 1917,  117, 4246,  864,  788,   89,  622, 4926,
        4950, 8348, 1663, 4376, 3036,  256, 4689, 1910, 4137, 7702, 4523, 7686,
        1390, 6046, 6428, 1259, 8311, 7320, 2710, 2940], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3890, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3806, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3724, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3623, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([7136, 1466, 5898, 7843, 7429, 5732, 8325, 7175, 5825,   74, 1710, 4225,
        5113, 4999, 2826,  701, 4608, 2599, 4460, 6752, 2800, 7477, 5275, 3474,
        6659, 1537, 2165, 6067, 6888, 3128,  195, 7706], device='cuda:0')
idx in forward tensor([3319,  498, 5851, 5858, 1688, 6540, 9029, 3475, 7507, 8715,  275, 6863,
        1553, 2108, 2401, 1562, 8918, 1829, 6784, 7284, 3928, 7503,  355, 4015,
        7655, 8304, 4967, 2759, 7323, 8842, 4564, 7958], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3948, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3874, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3804, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3709, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4036, 2618, 4723, 3024, 5849, 1975, 6945, 3000, 2560, 2377, 4298, 7952,
        1336, 5776, 3431, 8490, 2024, 2456, 6794, 8131, 8818, 6774, 4430, 8760,
        8138, 5896, 4232, 4314, 2476, 6502, 2111, 5322], device='cuda:1')
idx in forward tensor([2300, 1380, 3485, 5058, 3692, 6812, 2538, 8388, 7670,  869, 8840, 7858,
        8970, 1849, 3641, 3611, 2704, 6235,  277, 6400, 1140, 5530, 1587, 4440,
        7221, 4530, 5531,  964, 6210, 5119, 2121, 8725], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3791, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3703, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3776, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3685, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2497, 7166, 7943, 3128, 1208, 7434, 4918,  366,  260, 2132, 3431, 8812,
        6745, 7909, 3279, 6087, 9017, 2779, 2798, 7673, 5083, 3354, 8817, 2456,
        7739, 2522, 6285, 7051, 1178, 9134, 2786,  348], device='cuda:0')
idx in forward tensor([5532, 4169, 8358, 1813, 1183, 2838,  237, 5198, 8178, 1954, 8245, 8769,
        8108, 4705, 4819, 4568, 4343, 6405, 2149,  352,  185, 6184, 3994, 6848,
         534,  199, 4281, 8122, 4272, 4498, 3146, 3097], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3701, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3590, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3715, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3605, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4327, 4954, 7217,  526, 8284, 1509, 8407, 8742, 9068, 7613, 1297, 5055,
        5812, 3291,  463, 1908,  329, 6792, 1124, 2098, 4255,  179, 7858,  463,
        7684, 8168, 7135, 5288, 7268, 4171, 5661, 7802], device='cuda:1')
tensor([7287,  780, 6191, 4774, 7040, 6698, 4258, 4096, 2316, 2603,  715, 2292,
        7772, 3125, 2472, 1422, 4120, 4755, 4927, 1851, 3768, 7485, 5016, 5919,
         174, 4869,  503, 7730, 3384,   43, 2787,  358], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3681, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3560, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3680, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3576, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1718, 4749, 5292, 8656, 4314, 5130, 5743, 4221, 4384, 6644,  850, 3273,
        2755, 7647, 1576, 4724, 5597, 8889, 6955, 2926, 5065, 5720, 4513, 4156,
        4291, 2007, 2509, 6729, 2197,    6, 2089,  539], device='cuda:0')
tensor([ 653, 1274, 8133, 3119, 1667, 6930, 6656, 3181, 8800, 3316, 5264, 8678,
        2550, 6870, 6743, 1013, 1080, 1724, 6469, 7912, 9148, 3045, 2749, 2819,
        8651, 3179, 7543, 4035, 3249, 3362, 4223, 4684], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3829, device='cuda:1', grad_fn=<NegBackward0>)loss_i2t_ori in get_contrastive_loss tensor(3.3912, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3836, device='cuda:0', grad_fn=<MeanBackward0>)

loss_i2t in get_contrastive_loss tensor(3.3750, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([7748, 3708, 8708, 2462, 1604, 8879, 6000, 4191, 3705, 7664, 8473, 3917,
         412, 2657, 1514, 6101, 2681, 7387, 8596, 1633, 4692,  702, 5447, 7870,
        7558, 5688,  835, 7211, 5560, 3626, 7547, 3829], device='cuda:0')
idx in forward tensor([8710, 9064, 5944, 8321, 2104, 6308, 4074,  872, 3979, 6147, 6534, 8035,
        5026, 6313, 6955, 8321, 1666, 4191, 2801, 2552, 3541, 1146, 3425, 1104,
        8772, 3763, 4624, 1582, 5273, 2871, 7850, 8429], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3948, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3881, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3637, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3541, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([1095, 2212, 7791, 6168, 2344, 3781, 8392, 7223, 1245, 4391, 4827, 6174,
        7088, 8776, 1578, 4988, 6952, 4647, 6892, 9152, 7893, 8338, 8625, 1732,
        3698, 3022, 3488, 7171, 1948, 7536, 5431, 1273], device='cuda:0')
idx in forward tensor([8456, 8868, 7805, 3867, 6393, 6532, 4230, 8538,  232, 3634, 1979, 1910,
        8861, 3623, 8167, 7983, 5557, 8990, 1091, 5900, 5821, 6560, 3197,  460,
        2725, 4115, 6564, 5285, 3623,   89, 3365, 6853], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3826, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3738, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3766, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3663, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1260, 2465, 1176,  624, 7302, 8614, 4227, 5142, 3058, 3224, 5693, 6689,
        6274, 3337, 7268, 7350, 8985, 5417, 3776, 8831, 7343, 7426,  995, 6330,
        2365, 1382, 2582, 3449, 6187, 8815, 8512, 6150], device='cuda:0')
tensor([1886, 3457, 4267, 8472, 5111, 7770, 8862, 4095,   95, 8738,  776,  234,
        3468,   76, 9115, 9008, 2327, 7417,  535, 5779, 4697, 3119, 6642, 3160,
        8250,  711, 2754, 7825, 3224, 6956, 6448, 5137], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3836, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3757, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3852, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3753, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([1943, 5601, 3420, 5032, 6706,  367, 7238, 3886, 8898, 7451, 6132, 1029,
        1203, 1322, 8611,  924, 7679, 3114, 6746, 2715, 4393, 3458, 3155, 6479,
        2190, 5468, 1166, 1614,  510, 6362, 7004, 4673], device='cuda:1')
idx in forward tensor([7403, 7216, 1331, 6386, 6132, 3633, 9048, 4336,  782, 6702, 1864, 1195,
        8263, 7617, 5976, 2105, 2205, 5693, 2213, 4872, 4142, 5554, 4698, 7334,
        3098, 8141, 7799, 7508, 5947, 2951, 5208, 3735], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3814, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3732, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3960, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3898, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 626, 4864,  876, 9058, 8428, 2333, 7309, 8530, 6215, 4919, 1145, 3800,
        3064, 7798,  279, 6268, 3134, 1549, 3284, 2742, 4769, 2780, 2081, 1634,
        1953, 8904, 2361, 8650, 2595, 3508, 1992,  979], device='cuda:1')
idx in forward tensor([2418, 2673,  125, 8201, 7916, 7169, 4965, 3886, 7436,  965, 8380, 5105,
         647, 7933, 8506, 6827, 3584, 3209, 4412, 3499, 1581, 4307,  659, 4995,
        6596, 5621, 2788, 1365, 4619, 5221, 7680, 8947], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3780, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3701, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3861, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3779, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8004, 4768, 2143, 8743,  426, 6455, 7574, 3394, 5978, 5336, 2815, 5264,
        6284, 7445, 6466, 1436, 8774, 4408, 5593, 1427, 3704, 6888, 3841, 3429,
        5329, 5221,  999, 2803, 2147, 1510, 6227,  763], device='cuda:1')
tensor([3034, 7072, 6959, 5889, 5894, 2645, 5510, 1347, 5418, 4078, 5289, 1920,
        7808, 6473, 9075,  219,  213,  621, 5405,  241, 2291, 3524, 6657, 4395,
        4345, 7215, 6884, 9093, 4112,  292, 3243, 2409], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3752, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3669, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3733, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3643, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5334, 1372, 5223,  992, 6852,  273, 5619, 6567, 1467, 5403, 2173, 8215,
        6591, 8510, 3424, 4888, 6906, 4165, 3515, 3137,  438, 7531, 1182, 7366,
        1427, 5933, 3043, 8489, 6133, 8595, 3711, 4780], device='cuda:0')
tensor([2072, 3447, 7601, 5733, 6477, 7361, 8976, 1305, 7644, 2445, 4854, 5040,
        5388, 8737, 5795, 3732, 2460, 8118, 8046, 5896, 8164,  477, 3479, 7533,
        2493, 7658, 2766, 8648,  728, 1498, 8471, 5108], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3900, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3816, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3799, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3715, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4140, 3797, 8135, 7400, 3110, 8875, 6182, 6445, 2562, 2553, 2927, 4109,
        6412, 6072, 5528, 8173, 4350, 5141,  745,  467, 5025, 7713, 1672, 5654,
         568, 3745, 4452, 5461, 7462, 3287, 4994, 5539], device='cuda:0')
tensor([3893,   89, 4085, 1135, 5298, 3475, 6238, 2492, 4994, 8618,  830, 5561,
        1612,  303, 6639, 5064, 7816, 3083,  540,   40, 2361, 2959, 1308, 6902,
        2939, 8218,   16, 1692, 4494, 8455, 1154, 2145], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3927, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3853, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3891, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3813, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7422, 5532, 2202, 9081, 7846, 7133, 7530,  203, 6138,  228, 2678, 5664,
        4857, 4281, 8424, 2666, 1318, 9025, 4002, 3753, 6193,  517,  916, 7156,
        3132, 5580, 2877, 4880, 3292, 5921, 3201,  254], device='cuda:1')
idx in forward tensor([5033, 1309, 7405, 1447, 6545,  977, 1873, 5965, 3162, 1207, 7189, 8281,
        8484,  867, 1626, 2348, 6499, 2449, 7136,   33, 3320, 4162, 7490, 6541,
        4021, 6547, 1280, 5309, 6248, 6664, 5874, 2914], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forwardtext in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
 torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3723, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3621, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3725, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3609, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8659, 2212, 2516, 4675, 5487, 4708, 4652, 7099, 1365, 4660, 8863, 7866,
        6335, 2125, 1930, 1944, 6371, 2117, 1542, 2253, 5940, 4886, 9022, 4535,
        2112,  907, 6184, 4997, 6613, 8927, 5190, 3052], device='cuda:0')
idx in forward tensor([2310, 7154, 7110, 6703, 6987, 6942,  128,  377, 7382, 5676, 3894, 6100,
        4700, 2487, 6612, 7810, 5820, 2803, 4532, 2502, 6279, 1936, 7679, 6421,
         899,  880, 5713,  507, 2507, 8193, 7281, 8221], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3767, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3661, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3949, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3885, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([  89, 7059, 1671, 5509, 3790,  101, 2766, 8163,    8, 8097, 8264, 2494,
        8486, 6026, 8566, 4826, 5038, 2706, 5970,  295, 4310, 3182, 5136,   54,
        2094, 7553, 5148, 5996, 8315, 2003, 7998, 8634], device='cuda:0')
tensor([4422, 8034, 3377, 3438,  360, 2088, 3462, 4631, 3066, 6625, 8742,  857,
        4565, 7067, 8013,  109, 1993, 7849, 4392, 4834, 5013, 5942, 2679, 3696,
        3874, 8672, 6045, 4198, 1118, 1243, 6537, 1009], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3793, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3702, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3893, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3818, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6115, 2319, 3374, 3848, 7337, 6823, 4943, 2938,  725, 1031, 5041, 6657,
        6091, 5062, 2851,  357, 8188, 8706, 7164, 6958, 6149, 6503, 7187, 6498,
        4594, 6930, 4055, 6651, 7252, 7716, 7862, 8316], device='cuda:1')
idx in forward tensor([1907, 1487, 6225,  394,  304, 4162, 9092, 8777, 3382, 2042, 5575, 4799,
        1136, 6698, 2355, 4767, 3538,   41, 3128, 8939, 6865, 7863, 6964,  812,
        4491, 3770, 6821, 6811, 2284, 5377, 5124, 6575], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.4018, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3965, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3756, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3662, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7046, 6037, 7048, 1990, 6531, 2105, 7608, 8824, 7821, 5138, 8113, 1992,
        6667, 8709, 4682, 8230, 5604,  669, 1939,   25,  181, 2637, 5802, 3578,
         550, 8177, 7731, 4145, 4086,  320,  629, 2373], device='cuda:0')
idx in forward tensor([1790, 1558, 2874, 1247, 6703,  937, 1402, 7868, 1881, 2089, 7656, 5068,
        3963,  191, 7382, 6262, 8251, 6708, 6650,  557, 8302, 3595, 1202, 7742,
        6899, 2359, 5882,  357, 8260, 6450, 6189, 3842], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3941, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3868, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3897, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3818, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 535, 5176, 7352, 6868, 3900, 4684, 7143, 4613, 7392, 2916, 1619, 8203,
        6902, 2942, 3904, 3012, 6698,  922, 3061,  285, 7563, 3966, 5059,  470,
         809, 2437, 8918, 3088, 7934, 2638, 8907, 3735], device='cuda:0')
tensor([4147, 5422, 3016, 8453, 6833, 2161, 5505, 7354, 1410,   15, 7113, 3610,
        3743, 6725, 7856, 8569, 6838, 4761, 3934, 2698, 1386,  590, 8688, 2613,
        7081, 8835, 5835, 2350, 5988, 4117, 5181, 4920], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3811, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3730, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3829, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3744, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1098, 1759, 6023, 5910, 5848, 8871,  603, 1630,  786,  199,  870,  106,
        3830, 6349, 1256, 3550, 6012,   46, 5938, 5151, 2876, 6799, 6076, 3685,
        6916, 3222, 1946, 8571, 3118, 3931, 3546, 3172], device='cuda:1')
tensor([ 536, 2142,  469, 5076, 2449, 6668, 3260, 8933, 2281, 2069, 3906, 1586,
        3798, 1135, 5579, 8808, 4289, 8882,  937, 3062, 1181, 5744, 2086, 6376,
        7663, 2594, 5353, 5077, 4389, 5341, 5025, 4107], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3911, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3848, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3671, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3569, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8976, 6520, 3154, 7388,  113, 2070,  918, 4620, 4448, 4134,  525,   97,
        7379, 5948, 9025, 1752, 8515, 2407, 2893, 7847, 6665,   96,  719, 3205,
        2666, 4959, 7086, 8810, 6895, 1360, 4802, 3534], device='cuda:0')
idx in forward tensor([3299, 6131, 7387, 7802, 7620,  692, 3733, 5348, 5897, 8765, 7563, 2780,
        2220, 7366, 6472,  973, 4770, 6230, 5007, 6299, 2533, 4947, 8217, 2741,
        7261, 4432, 8379, 8520, 4579, 4370, 6529, 8524], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3788, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3703, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3891, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3800, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 790, 6263, 2132, 7267, 8878, 1407, 5672, 6382, 1118, 8259, 7919, 4712,
        4317, 3260, 2293, 1789, 1894, 3813, 8481,  818, 7907, 5517, 2991, 3449,
        4235,  382, 8053, 4827, 7075, 4003, 1428, 6874], device='cuda:0')
tensor([6839, 5327, 6087, 3288, 9099, 7778, 8219, 8748, 5804, 1153, 8558, 1563,
         370, 6388, 4992, 7367, 7691, 2465, 5910, 6997, 2410, 6219,  564, 8340,
        5994, 6367, 5563, 7784, 3989, 3963, 7862, 3006], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3627, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3515, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3714, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3612, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2687, 8424, 8251,  530, 2506, 3621, 8636, 7991,  472, 7069, 8819, 6778,
        1351, 8860, 5036,  863, 2692, 3883, 8740, 5359, 1022, 5950,  951, 8747,
        4561, 8613, 4034, 8610, 6294, 1162, 3227, 7169], device='cuda:0')
tensor([ 765, 4129, 5229, 4910,  925, 5103, 2264, 3501, 4967, 4355, 6253, 4288,
        6696, 3151, 1693, 5747, 5052, 6234, 5431, 3395, 6766,  481, 3404, 1971,
        9107, 6635, 5387, 7764, 1935, 1851, 2630, 6804], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3873, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3801, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3584, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3461, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5332, 1722, 5750, 3814, 7473, 9102, 8137, 7923,  183, 2906, 7148, 3284,
        4791, 4040, 4385, 4197, 7368, 5313, 4748, 7252, 7579, 4676, 5944, 5696,
        9119, 3589, 7606, 1275,  905, 4869, 6760, 5928], device='cuda:0')
tensor([6450, 6279,  735, 4064, 4091, 8400,   74, 5940, 7942, 4628, 7073,   27,
        8030, 6454, 2527, 5498, 8022, 4555, 3260, 3289, 7975, 6286, 1347,  238,
        7628, 8222, 2744, 6165, 3042, 5408, 5121, 7133], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3748, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3666, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3919, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3855, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7725, 1036, 3043, 3504, 1841, 6909, 3395, 7151, 7519, 7025,  293, 2984,
        5883, 8640, 9095, 1647, 4904, 5621, 2195, 6694, 1763, 8407, 8745, 7400,
        8494, 3826, 6414, 6960, 6725, 6435, 1762, 5073], device='cuda:0')
tensor([7765, 5321, 4493, 8875, 2102, 5833, 1326, 5674, 2634, 2606, 1308,  668,
        1387, 1150, 1795, 5244,  778, 9054, 8152, 5885, 2317, 2131, 2732, 7171,
        3526, 5295,  938, 5351, 5839, 1542, 4983, 4963], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3836, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3743, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3816, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3726, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4254, 4698, 7072, 6686, 3672, 8195, 3548, 3486, 3239, 5867,  354, 1114,
        4565, 5274, 5117, 8284, 9153, 7845, 5543, 4245, 8986, 4311,   11, 5133,
        1400, 3575,  626, 2946, 1478, 1116, 7907, 1059], device='cuda:0')
tensor([5227, 2048, 4966, 7383, 3241, 2359, 4968, 8908, 3897, 3682, 7025, 3860,
        4663, 3155, 7520, 8201, 5271, 2999,  510, 6652, 3603, 7622, 8665, 4873,
        5458, 1527, 3683, 2276,  340, 1007, 1829, 3786], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3683, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3579, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3759, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3658, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8779, 4918,  746,  622, 2345, 1644, 1142, 5569,  901, 3361, 6349, 2091,
         217, 8112, 7423, 1130, 1350, 2174,  413, 9051, 1157, 3225, 7282, 6177,
        3975, 3674, 2465, 2705, 2493, 3985, 5665, 8026], device='cuda:1')
idx in forward tensor([1000, 7024, 3639, 8998, 1349, 7928, 5149, 8671, 6172,  890, 5439, 1469,
        3367, 8481, 2669,  347, 2124, 7185, 6689, 8077, 1471, 8639, 5598, 1160,
        5232, 8720, 4843, 6850, 6798, 2850, 8556, 3338], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3748, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3659, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3921, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3844, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1854, 1878, 5072, 7774, 6813,  488, 6926, 1424, 6572, 8522, 2630, 8180,
        3903, 1741, 3542, 6979,  654, 4975, 1502, 6233, 1491, 3036, 7253,  351,
        6683, 4574, 4951, 7079, 8031, 6136, 5503, 5410], device='cuda:0')
tensor([9141, 1196, 1689, 7722, 4795, 8029, 6219, 4653,  118, 4837, 4290, 5310,
        6363, 4753, 4958, 6549, 7851, 2272, 3172, 7262, 8675, 1885, 8701, 5290,
        1371, 5929,  448, 4553, 7972, 3839, 2278, 2184], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3621, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3495, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3861, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3781, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7135, 1059, 5830, 5997, 7272, 8837, 8159, 7712, 2832, 3153,  338, 5827,
        4177, 1235, 4990, 1765, 3675, 4842, 2380, 9112, 5757, 5313, 1806, 2928,
        1450,  961, 4736, 2093, 7443, 1069, 3776, 7774], device='cuda:0')
tensor([5979, 8444, 4286,  867,  263, 6770, 8575,   30, 2471, 3744, 8677,  688,
        5838, 1055, 6558, 2666, 8805, 7539, 6636, 8145, 1859, 4189, 7312, 5766,
        5942, 4406, 3658, 5701,  928, 4355, 2138, 6753], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3806, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3712, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3606, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3724, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8238, 5154, 4483, 1073, 2271, 2479,  127,   95, 8892, 4596, 8031, 3405,
        5592, 6419, 6993, 7819, 8391, 4723, 3192, 8674,  171, 9143, 3192,  628,
        7970,  989, 4637, 1583, 5257, 6579, 3181, 7837], device='cuda:0')
idx in forward tensor([7551, 9128, 8919, 5589, 7700, 8330, 2061, 5954, 3314, 5946, 1613,  730,
        6029, 9136, 1013, 6690, 7223, 2742, 2645, 3606, 6108, 6060, 5688, 5668,
         613, 2005, 2918, 7155, 1488, 2919, 4052, 5791], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3763, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3669, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3792, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3691, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4170, 7247, 6163, 7210, 6831, 1199,  685, 4259, 1136, 5248, 1647,  315,
        2839,   34, 4646, 7329, 1645, 1713, 5919, 5787, 4454, 4105, 6492, 3801,
        2471, 1345,  243, 8270, 8541, 7333, 3995, 8580], device='cuda:1')
tensor([8925, 8999,  629, 8902, 8851, 1998, 4921,  641, 6437,  143,  554, 7589,
        8778, 3771, 2748, 3557, 7094,   51, 4501,   61, 6005, 7671, 6477, 1903,
        6065, 6008, 7642, 1561,  945, 1111, 5294, 2881], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3692, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3590, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3801, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3711, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 872, 3321, 8462, 4538,  518,  662, 8594, 1042, 8191, 7399, 8213, 3331,
        5241,  295, 1533,  905, 7869, 7544,  695, 7575, 7599, 5003, 3387, 5932,
        2237, 7703, 3655, 6502, 3153, 7501,  905, 4169], device='cuda:0')
tensor([ 789,   92, 5287, 5458, 5739, 2896,  334, 7236, 6057, 8801,  551, 9024,
        6019, 5829, 3712, 1803, 4462, 7306, 4404, 6978, 6999,   96, 2279, 5941,
        5961, 1733, 1233,  870, 1093, 5392, 3294, 8328], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3822, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3719, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3874, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3796, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7647, 7789, 4307, 6882,  142, 2703, 8406, 1602, 2693,   90, 3812, 5696,
        7699, 4298, 4491, 7383, 8430, 4780, 8435, 1098, 1684, 3129, 3847, 8451,
        2636, 5027, 1638, 9142, 2496, 2535, 8676, 6378], device='cuda:0')
idx in forward tensor([2608, 5738, 3303, 1138, 7813, 4719, 3797, 4901, 1672, 3801, 1084, 8171,
        1172, 3444, 8465, 8543,  798, 6264, 4962, 8546, 9130, 2768, 4769, 3495,
         365,  912, 2748, 5009, 4170, 8987, 8768,  769], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])

pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3679, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3823, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3745, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3584, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([3404,  868, 4924, 8618, 5340, 3871, 7789, 5914, 1043, 6663, 3650, 2567,
        2532, 1375,  637, 5638, 8551, 1058, 2285, 6950, 6433,  950, 7467, 8342,
        4148, 2154, 6829, 5187, 2195, 8299, 4226, 8207], device='cuda:0')
idx in forward tensor([2492,  674, 8964, 1028, 3029, 8905, 6928, 1397, 5171, 4322, 6049, 1031,
        6357, 2538, 1964, 6120, 3170, 8032, 4440, 3898,  638, 8348, 5311,  842,
        6450, 1488, 1811, 3742, 2039, 4092, 4564, 2839], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3928, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3855, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3651, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3543, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8184, 3175, 5952, 2554, 5419, 5174,  563, 8064, 5022, 5573, 8019, 2026,
        1305, 2625, 7260, 7026, 6779, 7370,  857, 7162, 7337, 2336, 6835, 8166,
        8523, 5547, 2107, 8982,  737, 2891, 6072, 8797], device='cuda:0')
tensor([1562, 7213, 4880, 9100, 5961, 7669, 7223, 4468, 3275, 3559, 3092, 7819,
        7838, 2994, 4249, 1279, 5829,  616,  341, 2400, 6037, 6916, 3030, 3999,
        7625, 8922, 6628,  632, 3971, 1838, 4598, 2764], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3893, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3816, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3997, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3936, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4732,  825, 8219, 4058, 4335,  529, 7785, 3453, 2727, 5804, 1878,  811,
        5677, 3846,  220, 8242, 8727, 4008, 8239, 2467, 4763, 4159, 4589,  805,
        4837, 1680, 4835, 5144, 6817, 8944, 3354, 4448], device='cuda:1')
tensor([7107, 4208, 5604, 3261, 7392, 8360, 6419, 9057, 7170, 1800, 7005,   90,
        4717, 8219,  123, 5093, 2615, 8932, 6821, 8987,  620, 4892, 2181, 5259,
        8312, 5819, 7787, 5395,  587, 6032, 6641, 1449], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3776, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3688, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3771, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3670, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([3464, 6869, 7463, 4361,  145, 6095,  146, 7677, 7709, 4156, 5394, 2093,
        7335, 7556, 5238, 1388, 8167, 5526,  475, 3247, 4013, 2284, 5080, 4922,
        2343, 2659, 8717, 3503, 5197, 3741, 5824,  991], device='cuda:1')
idx in forward tensor([7286, 8705, 6286, 8998, 8368, 3500,  889, 7060, 3810, 3055, 5557, 1252,
          44, 1551, 3439, 2610, 8100, 6295, 2339, 4616, 1217,  838, 3848, 3033,
        2669, 8100, 3902, 7477, 3665, 4993, 9118,  478], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3907, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3825, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3819, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3729, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8374, 6268, 5015, 6569, 4519, 5964, 4332, 6019, 8298, 1697, 2424, 3483,
        4408,  743, 8937, 5354, 6907, 4496, 2762, 3882,  582,   78, 1059, 3017,
        2688, 3267, 1819, 5511, 5351, 7584, 1927, 8661], device='cuda:0')
idx in forward tensor([4090, 4996, 2246, 1554, 6662, 7889, 6346, 7632, 3270, 5951, 4771, 6860,
        7181, 3562, 8981, 4369, 6511, 4903, 8585, 5741, 8286, 7462, 2122, 1963,
        6656, 2214,    1, 2797, 8261, 2984, 1280, 5716], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3760, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3676, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3802, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3702, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6630, 1670, 1536, 8582, 3277, 3101, 3266,  242, 8991, 1333, 3523, 7690,
        4863, 5646,   79, 3549, 6163, 8250, 5093, 7528,  504, 6453, 2010, 4335,
        3701, 1054, 8971,  422, 1703,    7, 5472, 7255], device='cuda:1')
idx in forward tensor([2343, 8547, 3816, 7285, 6655, 4703,  468, 2258, 2179, 5819, 4171, 3447,
        5139, 4668, 8280, 5733, 7621, 6616, 6040,  618, 4132, 6024,  241, 8440,
        6221, 7883, 7645, 5019,  519, 4724,  882, 2675], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3856, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3779, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3787, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3696, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3603, 6875, 3168, 3998, 8666, 6989, 6348, 4109, 4146, 7644, 6384, 5578,
        3515, 8013, 5846,  894, 6092, 3644, 1589,  461, 2689, 7823, 1466,  611,
        2287, 2018, 1242, 2641, 2459,  930,  152, 5960], device='cuda:0')
idx in forward tensor([6962, 1319, 1288,  875, 1607, 4414, 8309, 1300, 4969, 6149, 7319, 7752,
         608, 2841, 8234, 9130, 7999, 5506, 5963, 2718, 4082, 2635, 2044, 7680,
        1948, 1309, 6566, 3940,  388, 6426, 1928, 6307], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3867, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3786, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3854, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3769, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5007, 6849, 7644, 2774, 7416, 8997, 3749, 5581, 3513,  612, 9049, 8885,
         530, 2219, 7652, 5276, 7223, 7102, 2799, 6568, 2123, 3404, 4825, 1535,
        1375,  789, 5232, 8380, 4954, 3682, 1416, 4041], device='cuda:1')
idx in forward tensor([3786, 2694, 7440, 1431, 1373, 1670,  113, 3331, 5402, 7696, 3501, 2227,
        1431, 8227, 1553, 1928, 7607, 1040, 8024, 6550, 7231, 4370, 2244, 3370,
        6031,  703, 5970, 2353, 6006, 8282, 6351, 6599], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3781, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3684, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3777, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3688, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2697, 6125, 2402, 7421, 4866, 6409,  292, 3452,  163, 1120, 2836, 6875,
        8445, 1622, 1243, 2484, 2708, 3584, 1751,   77,  661, 6070, 9119, 1660,
        4157, 7835, 3648, 8377, 2734, 6865,  764, 3214], device='cuda:0')
tensor([7203, 9086, 3003, 8048,  998, 1806, 7886,  604, 7536, 1079,  150, 1615,
        5043, 7749,  724,  240, 4001, 7375, 6693, 6322, 2068, 6294,  659, 1317,
        5087, 1333, 5973, 3216, 7883, 3632, 5516, 6282], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.4132, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4084, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3809, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3729, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8822, 5355,  408, 7881, 2458, 3456,  205, 2007, 1534, 5355, 1411, 3822,
        7910, 6539, 8208,  975, 9020,   49, 5551, 5405, 4517, 4615, 2050, 5748,
        7264, 1023, 7061, 5148, 6536, 7289, 2432, 8869], device='cuda:0')
tensor([1259, 8703, 6637, 8707, 3807, 2607, 1658, 3339, 4159, 9105, 2724, 7048,
        7090, 4161, 2434, 8947, 3308, 8431,  245, 8642, 5410, 5975, 8674, 4331,
        1602, 1887, 1734, 7516, 7621, 6458, 2802, 2896], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_lossloss_i2t_ori in get_contrastive_loss tensor(3.3854, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss  tensor(3.3844, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3761, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3775, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4012, 6462, 1354, 5163, 4257, 5128, 7105, 4725, 1198, 1989, 8072,  347,
        7476, 7257, 3174, 3710, 5675, 3312, 5081, 2983, 4288, 7527, 3159, 3700,
        7255, 1921, 6115, 8174, 8762, 7312, 1709, 8761], device='cuda:1')
tensor([9087, 4669, 8934, 3915, 7623, 5404, 6317, 7183, 1520, 3326, 5623,  722,
        3980, 6201, 7784, 6702, 1460,  630, 3386, 3729,   91, 8989, 5329, 6267,
        7916, 4617, 7598, 6513, 2779, 1876, 7678, 2426], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3878, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3799, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3791, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3710, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 572, 7248, 6782, 3869, 3689, 8968, 8349, 3911,  778, 7936, 3102, 7799,
        9127, 5176, 2784, 1155, 8237, 1522, 1094, 2378,  203, 6639, 5249, 8872,
        8578, 3240, 5857,  943, 8694, 3775, 2551, 4908], device='cuda:0')
idx in forward tensor([8949, 8843, 8230, 6570, 6203, 2027, 3193, 2074, 9081, 4366, 7012, 4516,
        6518,  667, 1481, 8002, 6344, 4119, 4312,  252, 4848, 7890, 2018, 1202,
         539, 3626, 2868, 6377,   58, 4980, 8500, 6729], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3928, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3849, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.4123, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.4068, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8540, 8523, 6435, 4825, 5128, 1537, 3802, 5980,  356, 2457, 4847,  377,
        8973,  392, 6137, 8285, 4990, 1230,  367, 8259, 7638, 8059, 1767, 4462,
        4966, 1767, 5713, 2425,   41, 1486, 2514, 9009], device='cuda:1')
tensor([4363, 7323, 4255, 6999, 4971, 4026, 2574, 3223, 1715, 3914, 6060, 4850,
        6783,  670, 7273, 5454, 8621, 4981, 4717, 5445, 2747, 2013, 6063, 6572,
        3960, 2215, 4663,  329, 4250, 2170,  883, 2938], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3746, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3660, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3812, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3722, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2946, 6830, 1567, 5218, 5512, 2762, 4573, 6549,  873, 3768, 3836, 2254,
        2196, 4214, 2472, 7729, 8172, 1044,  899, 7575, 7906, 3831, 5634,  428,
        9027, 3997, 4043,  818, 4077, 3317,   94, 2982], device='cuda:0')
tensor([1929, 4203, 3683, 4604, 8776, 4498, 2927, 9135, 6674, 8118, 6675, 3730,
        7982, 4853, 4385, 4899, 8686, 3943, 8176, 2648, 2816, 5935, 8069, 1189,
        5474, 4176, 3124, 6785, 4597, 7187, 7014, 2542], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3792, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3715, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3802, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3713, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([5470, 8414, 8018, 5099, 1524, 6556, 4355, 5856,   95,  891, 4635, 3978,
        4509, 3035, 8864, 2314, 8092, 9007, 7088, 6148, 6362, 5618, 7078, 1472,
        5832, 7851, 2930, 6033, 7428, 7045, 2989, 2522], device='cuda:0')
idx in forward tensor([5318,  255, 2178, 7629,  151, 1817, 1026, 2391, 4895, 6851, 8460, 7373,
        3313, 7172, 6407, 2512, 3142, 4143, 8039, 2075, 7561, 3097, 2173, 7570,
        2968, 7212, 9114, 8992, 6769, 6417, 1483, 3223], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3807, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3723, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3942, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3881, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([ 432, 3444, 4628, 1673, 2665, 4541, 7419, 6842, 7788, 7653, 7268, 1152,
        3187, 6933, 3724, 6338, 8890, 4095,  523, 8507, 1704, 6299, 2432, 1519,
        6873, 2042, 3191, 1805, 8754, 4204, 1236, 1295], device='cuda:1')
tensor([6118, 8935, 1816, 1843, 5555, 1564, 4823, 3979,  522, 8306, 3864, 8105,
        1696, 8832,  286, 8831, 6535, 4984, 5476, 2131, 5684, 9092, 6122, 1900,
        1448,   73, 8095, 3541, 4452, 3885, 7224, 7418], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3779, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3698, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3851, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3770, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([5485,  799, 4787, 2077,  949, 5999, 4154, 1103,   81, 6453, 8228, 1064,
        7337, 8321,  436, 5368, 7595, 5644, 6311, 2096, 3799, 7297, 6281, 5703,
        7614, 2534, 5855, 5693, 5697, 7432, 7603, 3866], device='cuda:0')
idx in forward tensor([8706, 7156, 4937, 1898, 3155, 8504, 2873, 4276, 1902, 2542, 8805, 4088,
        4321, 6282, 2238, 7200, 6704, 2562, 4545, 7788, 5699, 7919, 5738,  160,
        5070,  113,  640, 8943, 1191, 6075, 8573, 8407], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3739, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3656, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3838, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3758, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2221, 6621, 6394, 7946, 8119, 1900, 3991, 1589, 2286, 5266, 7435, 1456,
        8532, 4924, 4493, 3572, 7865, 5564, 2864, 4061,  960, 5679, 7257,  486,
        2662,   53, 8559, 3444,  883, 6237, 4907, 3904], device='cuda:0')
tensor([2174, 5690, 8451, 5439, 8390, 4944, 4302, 7870, 1615, 6342, 8654, 4234,
         129, 4447, 9083, 9139, 6220, 6558, 4357, 7518, 8626, 8644,  797, 1726,
        5456, 4418, 1610,  902, 2508, 6048, 8647, 4376], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3757, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3771, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3696, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3673, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([5548, 7541, 6011,  392, 5172, 2565, 2388,  189, 8775, 7050, 8167, 8371,
         839, 4499,  639, 2902, 8574, 5921, 7701, 1103, 1210, 5200, 2575, 3554,
        4799,   85, 5925,  969, 8361, 6642, 8106, 3098], device='cuda:0')
idx in forward tensor([6446, 6468, 2495, 4043, 5155, 7311,  453, 7922, 9111, 6569, 6975, 4430,
        2787, 2250, 6197, 7271, 5183, 7757, 2038, 4405, 2217, 1119, 4231, 2050,
        6144,  372, 8760, 8881, 3609, 6841, 4696, 4211], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3859, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3776, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3812, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3728, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2977, 8844,  353, 6624, 3582, 7048, 2804, 1870, 5589, 8416, 3046, 4614,
          57, 8260, 6791, 2524, 4325, 4222, 7452,  349, 6430, 8791, 2657, 5726,
        1398, 7687, 3502, 1622, 8180, 6300, 1942, 5817], device='cuda:1')
tensor([1836, 1462, 5245, 7462, 4507, 1210, 3613, 7839, 8881,  442, 6807,  157,
        3819, 2561, 4606, 7613, 6790, 5145, 7350, 7917,  185, 8129, 8645, 1779,
        8396, 7616, 2654, 2978, 6474, 4468, 8117, 6598], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3800, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3712, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3752, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3662, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8344, 6972, 6182, 7908, 1007, 3837, 1832,  690, 3945, 6152, 6347, 3209,
         313, 3002, 5335, 7561, 4651, 3516, 4861, 4806, 7143, 4296, 1848, 8191,
        4687, 3283, 1516, 5499, 9115, 2013, 2036, 5913], device='cuda:1')
idx in forward tensor([7452,  741,  814, 4664, 4772, 3854, 4590, 6908, 7821,   15, 5209, 4155,
        8391, 7059, 5615,  815, 1504, 3635, 4644, 1285, 6941, 6904, 4390, 9044,
        7517, 2025, 1158, 7235, 6026, 5111, 4346, 1952], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3699, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3598, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3885, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3814, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3663, 1733, 5111, 2552, 5147, 6025, 4781, 6809, 5756, 8782, 5539, 7723,
        5842, 7153, 3541, 8276,  372,  322, 8633, 7488,  489, 4353, 6433, 4779,
        7054, 1882, 3516, 8966, 1657, 8625, 4142, 7887], device='cuda:0')
tensor([1219, 2211, 7449, 1206, 8295, 4044, 3054, 6127, 4619, 4591, 2107, 4352,
        4888, 8498, 9106,  690, 2529, 3195, 4025, 6806, 1676, 1860, 5262, 8028,
        4419, 7188, 8089,  675, 1757, 4536, 4020, 9144], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3814, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3731, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3855, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3771, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([2348, 1693, 8435,  990, 7584, 7707, 5907, 8814, 5785, 4850,  944, 7568,
        8683, 3458, 6051, 8204, 8501,  500, 8099, 8749, 2905, 5569, 6819, 6790,
        7053,  621,  982, 8427,  204, 6223, 2204, 6601], device='cuda:1')
idx in forward tensor([3523, 2212,  795, 5646, 7142, 9018, 2461, 8909,  787, 3798, 7753, 3630,
        1982, 8194, 2805, 3423, 3796,  638, 8205,  713, 7117,  892, 8512, 4942,
        6000,  404, 8083, 7674, 8141, 1723, 6331, 2559], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3709, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3609, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3774, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3678, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6002, 1306, 1843, 7317, 1516,   47, 3651, 3385, 3798,  616, 8143, 1036,
        1533,    7, 6117, 7410, 7047, 5382, 7441, 6964, 1489, 3113, 3107, 4573,
        3447, 8693,  552, 2572, 1026, 6650, 2227,  668], device='cuda:0')
idx in forward tensor([8734, 3716, 5768, 2368, 7864, 1982,  712, 5393, 1244, 5094, 4355, 5147,
        3797, 7665, 5839, 3366,  218,  593, 7563, 1344, 3282,   91, 2633, 1011,
        4730, 7091, 4483, 6848, 6324, 9153, 5414, 4049], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3728, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3643, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3765, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3664, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([3544, 4986, 7060, 2733, 1239, 1530, 3141, 8879, 2149,  593, 8350, 5421,
        3636, 8419, 4367, 8739, 7916, 4986, 1915, 3424, 8269,  374, 5364,  392,
        5481, 2387,  348, 3183, 4607, 2229, 5141, 7428], device='cuda:0')
idx in forward tensor([7066,  944, 5162, 8414, 7884, 1860, 6011, 6108, 1153, 5330, 3109, 5927,
        6609, 3254, 2845, 8682, 2190, 4056, 3141, 3654, 1703, 1209, 7878, 7568,
        6052, 1594, 1487, 2219, 5299, 5922, 5901,  569], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3682, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3580, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3848, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3762, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([3862,  330, 3510, 3443, 7472, 6730, 2458, 7158, 2125, 6243, 7439, 5049,
        6764, 9086, 5743, 7599, 6275, 3530, 7897, 5062, 6354, 9124, 6880, 8670,
        4005, 5178, 2499, 2703, 1398, 7074, 5528, 2085], device='cuda:0')
idx in forward tensor([1836, 6421,  982,  642,  209, 6270, 5443, 7290, 2943, 5821, 8235, 3050,
        5669, 2116, 4040, 7026, 4246, 7293,  754, 7635, 2174, 8409, 5416, 2929,
        5280, 3680, 6000, 5558, 1382, 4256, 6170, 1575], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3736, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3635, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3814, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3730, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4798, 1942, 3724, 4077, 4687, 8548, 5168, 2495, 9059, 5207, 5420, 8441,
        3089, 8460, 8115,  678, 6753, 1663, 6885, 7880, 8905, 1530, 2464, 3892,
        5379, 8355, 9125, 1707, 3116, 6077, 6898,   77], device='cuda:0')
tensor([2537, 6107, 5549,  763, 1392, 3003, 4773, 5138, 8855, 6842, 6207, 6711,
        8089, 3405,  284, 3150,  658, 2061, 1227, 3473, 4798, 3806, 2105, 3442,
        7002, 7224, 2396,  822,  164, 5592, 1470, 6195], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3722, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3619, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3801, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3712, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7579, 4749, 1529, 7020, 2268, 6206, 4979, 1409, 6250, 2208, 6266, 4987,
        2531, 5227, 2512, 1143, 4990,  754, 7465, 2683, 5762, 3751, 6203, 4789,
        3478, 8872, 6631, 2517, 3948, 9067, 4768, 8172], device='cuda:0')
tensor([2727, 1154, 7511,  684, 4604, 3690, 6533, 8005, 6701, 2869, 2608, 2515,
         142, 1906, 7748, 1048, 7803,  165, 8369, 7556, 6794, 5827, 6250, 5215,
        6578, 6521, 6961, 3964, 5374, 4206, 1286, 5519], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3787, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3685, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3799, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3715, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([2623, 1241, 6885, 4662, 8593, 8074, 8236, 7954, 8413, 5972, 3761, 1327,
        1398, 2370, 2801, 7660, 6619, 2825, 6486, 8591, 7044, 2800,  838, 7064,
        4086, 3785, 2901, 2830, 4083, 7181, 4752, 5121], device='cuda:1')
idx in forward tensor([5075, 8539, 1808, 9034, 5234, 2168, 1450, 4450, 6559,  509, 7756, 6571,
        8563,   12, 3263, 3325, 6068, 8474, 4195,   95, 8863, 4079, 1949, 3305,
        1623,  117, 6312,  499, 4150, 3351, 8876, 7646], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3684, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3563, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3745, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3642, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6722, 3984, 6591, 6516, 2186, 1533, 2828, 4242, 2029,  211, 4037, 7212,
        7275, 7355, 8293,  222, 7280, 4743, 2080, 7960, 2299, 5739, 8531, 7584,
        3251, 4705, 7941, 6623, 8322, 8534, 8009, 4501], device='cuda:1')
tensor([5686,  563, 5342,  977, 6462, 4871, 4864, 4164, 3728, 8252, 4185, 4987,
        1698, 3493, 4466, 1332, 5134, 7688, 5433, 2338, 3978, 7640, 5751, 2440,
        7510, 1869, 8610, 7657, 5392,  665, 8087, 3416], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3745, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3637, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3797, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3696, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3510, 1253, 1558, 3936, 5184,  352, 4434, 8357, 6404, 7988, 4209, 2730,
        3564, 4252, 1418, 8870,  100,  799, 2067, 4970, 1374,  601, 2359, 7035,
        9112, 2097, 4210, 6562, 7201, 1267, 2051, 3537], device='cuda:0')
idx in forward tensor([ 496,  112, 7373, 1752, 5606, 4034,  728, 6419, 2816, 6188,  198, 2442,
        3962, 1872, 4780, 6141, 8211, 2641, 5623, 2053, 5379, 6372, 7098, 5875,
        4788, 2243, 3246, 6375, 1445, 2088, 1877, 4836], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3918, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3847, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3865, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3781, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([6479, 3496,  645, 3474, 4042, 3656, 5617, 6711,  899, 1904, 8505, 6290,
        1005, 2200,  186, 8433, 8720, 2186,  883, 7595, 4127, 3316, 1932, 1740,
        8610, 3167, 5529, 4375, 6177, 7906, 2676, 6255], device='cuda:1')
idx in forward tensor([6563, 7967, 7338, 7103, 7948, 8054, 6556,    2,  628, 4503, 7888, 2320,
        2637, 3158, 1545,  506, 7381, 1903, 7022, 5669, 2313, 9001, 6359, 8519,
        5278, 7763,  469, 8955, 7953, 6393, 1876, 3873], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3913, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3834, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3766, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3672, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([7661, 2803, 5367, 4014, 4066, 2241, 3144, 2034, 7662, 3992,  807, 1156,
        9011, 2253, 8419, 2249, 4466, 4981, 7639, 7765, 6389, 1856, 7023, 7773,
        6428, 3417, 8288,  811, 6145, 5510, 1581, 2600], device='cuda:0')
tensor([8499, 8673,  943, 8146, 4981, 3339, 1070, 4751, 7128,  948, 1744, 8109,
        5485, 8062, 7303, 6069, 8493, 8618, 6278, 4790, 4007, 1990, 6522,  816,
        1258, 2652, 5007, 2422, 7547, 2602, 1973, 4490], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3856, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3772, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3790, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3697, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3410, 4615, 7509, 6576, 8931, 8703,  606, 5663, 2806, 2614, 8024, 5769,
        3893, 2737,  192, 2609, 6745, 2732, 7553, 2953, 5596, 1202, 8183, 7467,
        4278, 5894, 1546, 9028,  852, 4068, 1463, 5381], device='cuda:0')
tensor([7126, 5089,  724, 4666, 2823, 2336, 7117, 7749, 3989, 8652, 1590,  426,
         827, 6699, 3733, 7248, 8116, 4032, 1005,  267, 5856, 6488, 3347, 5109,
        1055,  434, 6606,  796, 3505, 6593, 5977, 5656], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3852, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3771, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3708, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3617, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8792, 1457, 7669, 3313, 4565, 3425, 8678, 6474, 1653, 6250, 8639, 6165,
        3676, 3620, 2986, 3942, 5870, 6250, 2797, 9002, 1954, 7948, 7167,    1,
        4748, 4982,  884, 1062,  667, 2991, 6951, 5283], device='cuda:1')
tensor([4214,  580, 5518, 7776, 4688,  253,  406, 1911, 2880, 5614, 3253, 5207,
        8369, 2446, 5127, 7984, 1180, 2302, 3593, 4668, 6109, 7543, 1912, 8182,
         488, 6564, 3572, 6444, 2941,  476, 1974, 3549], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3703, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3883, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3800, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3600, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([  11, 3628, 5108, 3100, 3021, 8679, 6041, 7935, 7934, 8462, 5982, 4982,
        8280, 3179, 2780, 6890, 1023, 8980, 4879, 3448, 1591, 4673, 6882, 6259,
        8222, 6220, 7381, 2731,   22, 4855, 7830, 8114], device='cuda:1')
tensor([5373, 1959, 7119,  400, 5289, 8875,  985, 6977, 4750, 7958, 2563, 5047,
        5606, 4006, 5360, 8353,  276, 2408, 8474, 8996,  288, 4886, 6555, 7937,
        8827, 5172, 7491, 5668, 8701, 3974, 7286, 8068], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3862, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3786, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3764, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3671, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([6063, 6054, 7073, 7498, 3498, 6021, 2084, 1337, 1440, 3723, 4544, 4713,
        6096,  975, 5651, 5457,  235, 2078, 2851, 8526, 8330, 8821, 4171, 5897,
        2236, 5993, 4123, 3601, 7821, 7871, 7294, 6824], device='cuda:0')
idx in forward tensor([3634, 3238, 1761, 5210, 4166, 7775, 8902, 3918, 3898, 4340, 3431, 7219,
        1429, 1128, 6383, 2135, 4737, 8096, 2366, 8455, 2026, 6084, 3984, 3006,
        7291, 1459, 7813, 5444, 8145, 1271, 8167, 5806], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3791, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3712, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3683, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3573, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4114, 4726, 6780,  852, 4604, 6578,  895, 2024, 7943, 2338,  854, 3156,
        8448, 5305, 4324, 7886, 7108, 2411, 4607, 2534, 1828, 7977,  328, 7576,
         505, 8057,  595, 8951, 6480, 2155, 6238, 2677], device='cuda:0')
tensor([6423, 4936,  928, 6869,   36, 2670, 1680, 8883, 5740, 7950, 4339, 3503,
        4326, 8851, 5989,   67, 4776, 1143,  865, 3059, 8816,  900, 6863, 3336,
         282, 5806, 8102, 6161, 1377, 7292, 5604, 9049], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3663, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3557, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3832, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3755, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([6542, 6643, 6001, 7029, 8773, 2379, 5453, 7828, 6365, 6551, 2184, 7427,
        4694, 4053, 6075, 2113, 1633, 6140, 1063, 5928,  850, 4322, 2094, 6398,
        5601, 1359,  971, 4519, 7736, 2887,  107, 4631], device='cuda:0')
idx in forward tensor([2911, 8484, 2948, 4820, 1149, 6209,  909, 5603, 3538, 4508, 2859, 7829,
        6565, 2401, 5518, 5540, 2035, 4710, 3670, 6201,  915, 7163, 6361, 7605,
        4538, 6431, 6160,   43, 6316, 8223, 4871, 3667], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3720, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3617, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3938, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3865, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4514, 6078, 2874,  824, 8845, 1716, 4978, 6341, 3830,  800, 7720, 5644,
          34, 9142, 1897, 4880, 4206, 3484,  388, 6464, 2192, 6223, 2602,  526,
        3440,  681, 2695, 5708, 7572, 5899,  537, 7699], device='cuda:0')
tensor([8532, 8152, 1554, 5429, 8724, 4008, 7958, 4917, 7969, 4012, 3147, 1415,
        3169,  708, 2010, 8472, 1984, 1493, 1658, 7985, 2599, 7059, 1354, 5805,
        7730, 1201, 3882, 8896, 8981, 1544, 4840, 6784], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3964, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3884, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3682, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3580, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2614,  202,  108, 2371, 2655,  114, 6609, 8955, 3685, 4174, 3134, 5014,
        1150, 5233, 2480, 4869, 6246, 8722, 4150, 5779, 5806, 7801, 3485, 5017,
        5813, 5935, 7543, 8744, 7842, 3990, 8184, 8884], device='cuda:0')
idx in forward tensor([4113, 1844, 5823, 3587, 3080, 6545, 2505, 5779, 3148, 3998, 6715, 7095,
        4525, 2244, 2403, 8075, 5232, 3807, 4097,  791, 8687, 3728, 8290, 8039,
         315,  384, 3392, 1447, 6340,   58, 3120, 4033], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3831, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3747, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3815, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3726, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4662, 7955, 7609, 8027, 1164, 3338, 5993, 5884, 7250, 8748, 4741, 7845,
        3401,  424, 5737, 8188, 7909, 8511, 1366, 8243, 6838, 5545, 1764, 3514,
        2309, 3269, 1496, 4815, 1745, 2521, 8878, 6555], device='cuda:0')
idx in forward tensor([8873, 5009, 7639, 6906,  677, 7909,  600, 3529, 7777, 7369, 9120,  683,
        6715, 5605, 2749, 8302, 6905, 7839, 5345, 5637, 2536, 2311, 5998, 1675,
        9017, 6281, 7073, 2843, 1030, 5125,  302, 5703], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3609, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3494, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3778, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3691, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8368, 3751,   24, 3661, 1527, 7636, 6850, 4310, 6307, 7894, 1969, 1188,
        3997, 2100, 7366, 5378, 8545, 8038, 1788, 5122, 9080, 5812,  882, 6414,
        4658, 2756, 5860, 7549, 9011, 8033, 5673, 1726], device='cuda:0')
tensor([2968, 9082, 8965, 3515, 3277, 4109, 2753, 8307, 4764, 5700, 6781, 1945,
        8343, 4510, 6016, 7193, 1676, 8685, 6120,  802, 5784, 8906,  239,  926,
        2792, 6924, 3347, 2689, 3430, 2712, 3432,  959], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3911, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3826, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3727, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3631, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8597, 4811, 2247, 3570, 6265, 2953,  230, 4615, 2752, 8441, 1124, 5276,
        8202, 5999, 6211, 7483, 7994, 4369, 5352, 7396, 5267, 1674, 4334, 2274,
         345,  444, 7155, 6328, 4362, 6497, 1645, 1349], device='cuda:1')
idx in forward tensor([4127, 8483, 3750,  824, 1055, 6602, 8770,  754, 4359, 8916, 2375, 2894,
        4912, 4074, 1933, 1481, 1639, 7660, 1433, 3320, 6988, 3716, 7246,  518,
        8163, 8021,  115, 3503, 4977, 3981, 7690, 6520], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3957, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3880, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3749, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3651, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([2104, 2644,  675, 9060,  452, 4108, 3785, 7036, 8908, 5936, 9023, 8643,
        1425, 3954, 2057, 1713, 6946,  162, 7179, 7678, 5210, 8866, 8912, 6167,
         108,  867, 8211, 6317, 1116, 3037, 5909, 2061], device='cuda:0')
idx in forward tensor([2796, 4785,  589, 7192, 3029, 5030, 4438, 4127,  136, 4888,   71, 3788,
        5978,  746, 4705, 7844, 2200, 2436, 1847, 2088, 7566, 2973, 4650, 7141,
        5757, 8371, 4746, 2312, 4724, 8316, 4998, 1174], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3764, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3671, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3798, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3703, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5631, 7394,   64, 4917, 7485, 8663, 6042, 6098, 3659, 4399, 6758, 8963,
        1046, 5801, 4931, 2991, 3758, 7704, 1091, 6832, 8729, 9095, 2345, 8597,
        4198, 4335, 3700, 7284, 5119, 1487, 6953, 3071], device='cuda:0')
idx in forward tensor([1982, 5784, 1184, 4822, 7915, 4181, 8526, 9000, 4280, 2474, 9022,   92,
        7459, 7959, 1337, 1501, 1571, 8457, 2940, 7335, 8213, 9084, 2370, 6727,
        2904, 6445, 2174, 6507, 3638,  250, 2260, 7473], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3699, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3597, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3848, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3768, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([2055,  175, 3303, 7258, 4500, 5638, 3457, 4513, 4974, 7176, 8010, 5783,
        3777, 1708, 1063, 7960, 8960, 8369, 1846, 1285, 3173, 3933, 7485, 6883,
        4049, 5029, 2246, 4830, 6639,   39,  836, 7596], device='cuda:0')
idx in forward tensor([8487, 5650, 1103, 8131, 6647, 1483, 4894, 6050, 2850,  551, 3371,   72,
        6429, 7308, 4315, 3857,  668, 2076, 6189, 6928, 3623, 3443, 5071,  710,
         565,    5,  534, 1159, 7934, 7854, 7602, 3707], device='cuda:1')
text in forwardtext in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768]) torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])

loss_i2t_ori in get_contrastive_loss tensor(3.3804, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3723, device='cuda:1', grad_fn=<MeanBackward0>)loss_i2t_ori in get_contrastive_loss tensor(3.3718, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3626, device='cuda:0', grad_fn=<MeanBackward0>)

idx in forward tensor([3653, 3930, 2462, 1486, 2300, 2608, 8821, 7875,  739, 3014, 3883, 4537,
        6350, 4020, 7627, 7270, 5333, 5097, 7180, 6044, 6792, 4231, 8826, 9059,
        6451, 3673, 5828, 6058,  308, 6858, 7436, 4136], device='cuda:0')
idx in forward tensor([2528,  973, 3771, 6962, 5297, 5358, 1938, 3795, 4998, 2516, 8044, 7058,
        7947, 6592, 3929,  572, 6255, 8843, 5016, 3531, 8036, 8497, 6759, 5775,
        1336, 3829, 8466, 3252, 4726, 3982, 4253, 8555], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3784, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3693, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3908, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3829, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5144, 6350, 1551, 7940, 8453, 2639,  862, 1136, 5789, 8241,  331, 7149,
        3111, 2824, 5261, 1852,  986, 4957, 3926, 1620, 2942, 3687, 5246, 8769,
        2835, 7329, 6090, 6193, 8984, 2693,  544,  487], device='cuda:0')
idx in forward tensor([7230, 1350,   50, 4818, 5566, 6948, 3312, 5432, 5141, 4542, 3024, 1927,
        2132, 8405, 6084, 8270, 7386, 8959, 6014, 3826, 1457, 3728,  803, 5797,
        7954,  709, 7249, 1277, 8600,  886, 7038, 4601], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3631, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3527, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3918, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3845, device='cuda:0', grad_fn=<MeanBackward0>)
[32m2023-10-20T16:39:18 | utils.basic_utils: [0mTrain Epoch: [0]  [500/572]  eta: 0:11:00  lr: 0.000010  temperature: 0.0183  video-loss_ita: 2.4932  video-loss_itm: 0.5736  time: 10.2281  data: 0.0185  max mem: 33192 res mem: 33720
idx in forward tensor([1515, 3961, 4014, 5294, 7445,  167, 9051,  721, 5740, 4729, 6597, 7376,
        3221, 8608, 3474, 9041, 7298, 2489, 2933, 8866, 5986,  616,  348, 2159,
        5364, 6020, 2092,  262,  818, 5519, 5634, 8684], device='cuda:1')
idx in forward tensor([6047,  581, 5378, 7855,  402, 7580, 6617,  528, 6359, 8013, 8486, 3427,
         572, 4234, 6008, 7423, 1937, 8730, 3644,  651, 5935, 8936, 2943, 2575,
        2415, 5647, 5760,  826, 4735, 6864, 1891, 5285], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3821, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3734, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3811, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3714, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3870, 8344,  294, 2188,  100, 2224, 2218, 4356, 6666, 2457, 7735, 1855,
        4260,  979, 3327, 3876, 1062, 1943, 5408, 1287, 1557,  634, 8244, 8106,
        7228, 1374, 4829, 7154, 7042, 1507, 2423, 6318], device='cuda:0')
idx in forward tensor([2152,  709, 4706, 2389, 7400, 5572, 1133, 4153, 1846, 7401, 6347, 7665,
        6281, 4900, 6750, 5992, 3804, 4379, 7183, 5179, 1067, 8380, 5302,  929,
        5742, 3668, 7478, 3744, 3641, 1863, 2230, 6961], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3868, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3784, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3805, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3715, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5675, 8144, 7596, 1144, 2371, 6667, 8366, 5450, 2288, 7208, 8299, 3387,
        3200, 8518, 3953, 1949, 3426, 3434,  157, 1456,   29, 3875, 9074, 4721,
        3843, 8892, 3553, 3556, 7920, 6863, 7377,  198], device='cuda:0')
idx in forward tensor([3055, 1109, 6578, 8753,  542,  486, 5810, 8332, 6965, 8869, 7609, 3043,
        2886, 8603, 1339, 3673,  911,  456, 6073, 7013, 7465, 8689,  636, 1683,
        3988, 5449, 8352, 2296, 1958, 4229,  954, 5419], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3772, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3681, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3875, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3793, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8632, 7820,  134, 7582, 2680, 3802, 8916, 7921, 7357, 7288, 8590, 3603,
        3421, 3257, 5437,  748, 3968, 1883, 7585, 6455, 2686, 4904, 1265, 4881,
        7904, 5666, 8817, 7614, 8947, 6867, 9054, 6016], device='cuda:0')
idx in forward tensor([ 332, 6661, 5419, 5353, 8711, 1538, 1809, 5629, 7369,    9,  935, 1865,
        3086, 1442, 2186, 2892, 5675, 1504, 9114,  693,  147, 3739, 1265, 4631,
        1383, 6743,  204, 2944, 4527, 5266,  333,  313], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3888, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3821, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3828, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3739, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4436, 1231, 7443, 5413, 1883, 4157, 2897, 5999, 5886, 5304,  907, 9101,
        3085, 3108, 4890, 3322, 4409,  615, 3464, 8204, 8200, 5206, 6276, 8965,
         470, 7518, 7330,  335, 4468, 9020,  249, 7507], device='cuda:0')
idx in forward tensor([4985, 1462, 7618, 8040, 1908, 2470, 6309, 5682, 7506, 1546, 6662, 4024,
        3789, 4134, 8687, 6810, 5429, 3188, 7727, 5636, 4596,  768, 2165, 7963,
        3170, 3853, 4181, 8127, 6031, 6623, 7475,  297], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3849, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3772, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3688, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3584, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3075, 2191, 4684, 1571, 2525, 2820, 1209,  733, 3283, 6831, 5356,  757,
        8486,  197, 8615, 6123, 5387, 7269, 3190,  511, 4878, 6322, 5270, 5534,
        6138, 1822, 5151,  882, 1836, 3939, 5926, 5655], device='cuda:0')
tensor([1617, 4586, 4742, 4412,  547, 3851, 2166, 8861, 8936, 3067, 5959, 6264,
        7548, 2985, 8952, 7864, 6645, 7009, 8076, 5390, 2469, 8055, 5368, 7781,
         611, 7795,   71, 4699, 9058, 5787,  804, 8726], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3877, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3797, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3603, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3487, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5586, 6094, 5738,  914, 2556, 5490,  813, 3389, 8746, 1762, 4496, 2358,
        7455, 3630, 7096,  602,  154, 7410, 2623, 6721, 8354, 3694, 1597, 4016,
        1838, 6705, 3019, 1658, 6097, 8406, 3946, 1587], device='cuda:1')
tensor([4646, 9015, 1771, 8115,  275,  574,   31, 1502, 6552, 6546, 2091, 2386,
         138,  590, 7949, 8333, 7351, 8366, 7594,  250,  220,  278, 6377,  943,
        3259, 4175, 8575, 8829, 3760, 2544, 8605, 7737], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3830, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3747, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3808, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3730, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4411, 4104, 8874,  728, 2642, 7670,  631, 1580, 5497, 5328, 1020, 7000,
        7061, 3472, 8347, 8921, 3359, 1782, 2123, 3457, 3313, 2526, 2171, 2503,
        7490, 6800, 1585,  115, 7593, 1493, 8201, 3456], device='cuda:0')
tensor([2365,  648, 5421, 2225, 7295, 7356, 4058, 6936, 4070, 5430, 6082, 8742,
         257, 5034,  397, 2409, 1276, 5384, 5569, 4722, 7979, 8644, 3944,  593,
        7814, 1420, 6235,  409, 4002, 1366, 1054, 6807], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3740, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3643, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3911, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3826, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([8503, 6483, 3020,  300, 1864, 2994, 7777, 9074, 2158, 8066, 1563, 1926,
        3784,   70, 6540, 1574, 7148, 5259, 6911,  735, 2482,  726, 1292, 4351,
        1439, 5923, 2995, 2220, 8273, 8056, 5581, 8934], device='cuda:1')
tensor([9153,  221,  386, 7753, 6295, 7553, 1266, 1452, 2475, 2118, 4037, 3246,
        7266, 4192, 7591,  146, 6871, 2014, 4960, 8870, 4838, 1100, 6587, 3121,
        1552, 8912, 5852, 6249, 7606, 5491, 3535, 1429], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3683, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3587, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3877, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3803, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([ 679, 7518, 5100, 8638, 8678, 3081, 8082, 4935, 7429, 8461, 7530, 7436,
        5985, 6316, 7276,  655,  489, 2097, 8144, 5965, 4618, 7358, 3530,   79,
        5188, 2863, 5808, 7776, 5872, 7707,  657, 8078], device='cuda:1')
idx in forward tensor([8061, 6988, 5934, 8459, 4046, 3791,  964, 4781, 3262, 1538, 5774, 6548,
        2892, 1439, 5308, 7837, 4788, 2884,  953, 4302, 1571,  681, 8177,  932,
        5706, 4366, 4327, 5518, 8324, 2121, 4381,  595], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3751, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3659, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3810, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3727, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4728,  191,  570, 7483, 5911, 8343, 5981, 5858, 2385, 5303, 8640,  179,
        3645, 4125, 4545, 2670, 9047, 7510, 8349, 7635, 4268,  770, 6483, 8614,
        4218, 3727, 5082, 3500, 5554, 8071, 7228, 8628], device='cuda:0')
tensor([8465,  215, 6894, 8649, 2577, 8404,  583, 1933, 9116, 8228, 3031, 4777,
         177,  693, 1306, 4563, 2297, 7278, 1125, 6070, 7709, 2161, 4912, 5494,
        1926, 2610, 8837, 2016, 1646, 2500, 9007, 7825], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3887, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3812, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3733, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3638, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8059, 2473, 4956, 1631,  528, 2604, 5749, 6185, 2590, 6997, 2417, 4021,
        1845, 2596, 6148, 4154, 6835, 6411, 7826, 1651, 1615, 7612, 8653, 9032,
        3308, 9016, 1507, 1769, 1399, 5635, 5044, 6135], device='cuda:0')
idx in forward tensor([ 393, 1686, 5715, 3574, 7467, 2688, 5505, 1635, 8781, 5658, 1510, 4917,
        1071,  619, 7470, 8390, 6779, 5278, 2173, 5329, 3499, 4770,  502, 7414,
        4185, 7575, 3810,   56,  712, 6493,  699,  194], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3844, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3757, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3827, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3740, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8135, 3702, 2672, 4038, 3884,  783, 8492, 4680, 3165, 5646, 3987, 7580,
        8978, 8371, 6726, 7982, 3159, 4445, 7412, 1634, 7230, 5862, 5057, 5156,
        4839, 8467, 2545, 4401, 1110,  558, 3842, 7335], device='cuda:1')
idx in forward tensor([4591, 2019, 8557, 2702, 2578,  902, 5323, 9140,  279,  258, 1648,   40,
        5377, 1753,  432, 2582, 6437, 1238, 5386, 7481, 1917, 4509, 3228, 7347,
        3040, 7238, 1046,  423, 4788, 5570, 5726, 1706], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3938, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3865, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3849, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3761, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([1116, 7301, 5546, 7802, 5263, 3401, 8198, 4158, 8854, 5143, 3372,  245,
        5689, 4161, 8757, 1054, 1319, 4143, 1018, 2496, 4970,  789, 4340, 8231,
        6911, 6805,  302, 2271, 7777, 5790,  397, 2391], device='cuda:0')
idx in forward tensor([2008, 1557, 2008, 5125,  319, 6993, 2185, 1322, 4854, 4991, 3595, 5101,
        2891, 7860,  124, 2016, 5648, 2101,  265, 5102, 6002, 7520, 3689, 5821,
        2071, 4332, 1015, 4732, 2831, 1579, 3557, 1978], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3837, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3759, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3888, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3807, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5042, 8038, 4964, 3955, 8042, 4484, 1211, 2568, 8917,  420, 5205, 4436,
        2419, 6971, 2921, 3598, 5593, 4577, 1278, 7880, 8408, 6526, 7961, 4383,
        7642, 1508, 1107, 6644, 6733, 6310, 8386, 8381], device='cuda:1')
tensor([6469, 8434, 7247, 1096,  890, 7044, 2834, 7949, 3922, 8768, 8412, 6039,
        1662,  837, 4418, 7961, 8477, 2323, 6658, 4668, 2778, 6677, 7528, 7935,
        7204, 2468,  382, 5286,  766, 4444, 8945, 1112], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3708, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3611, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3518, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3385, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3398, 9050, 6482, 2009,  695, 3942, 7681, 3111, 3748, 4919, 8775, 3547,
        6284, 2319, 1815, 5263, 5666,  894,  700, 8252, 5578, 6561, 3667, 4927,
        4024, 7568, 7570,  506, 8362, 3058, 5780, 7994], device='cuda:0')
tensor([6463, 7192, 2351, 3905, 2480,  813, 1097, 1268, 7654, 3133, 3881, 8529,
        2726, 1757, 3213, 1594, 2496, 6942, 8725, 2642, 6724, 5782, 5889, 5561,
        3606, 2128, 8258, 1665, 1561, 2259,   59, 2979], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3798, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3709, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3985, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3922, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8080, 1152, 4285, 3925, 2802, 4382,  543,  252, 6848, 7320, 5751, 3719,
         708,  946, 7328, 7440,  426, 4554, 1758, 4070, 1987, 4462, 4725, 8350,
        6472, 5619, 8299,  907,  137, 2128, 6174, 1654], device='cuda:0')
idx in forward tensor([3323, 6717, 3937, 3506, 3921, 5457, 3290, 5124, 6119, 2434, 6335, 7962,
           5, 4393, 8554,  847, 1316, 4360, 4506, 6180, 5348, 4382, 9014, 1494,
        9022,  403, 7275, 2448, 4758,  470, 1005,  226], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3989, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3744, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3646, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3920, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([  16, 7645, 7399,  304,  454, 2139, 4051, 5084,  315, 3607, 1467,  217,
         491, 4518, 7481, 6800, 8714, 6506, 8885, 4360, 8825, 6299, 5559, 3408,
         585,  388, 4543, 7874, 4715, 6291, 8274, 5632], device='cuda:1')
tensor([1825, 1919, 8373, 8522,  461, 7778, 2095, 7617, 3793, 1327, 8558, 6299,
        6853, 8387, 8851, 4009, 5812,  545, 3258, 7068,  414, 5070, 3730, 5058,
        4970, 2231, 2144,  391, 8472, 8190, 3353, 4180], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3846, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3766, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3988, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3923, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6332, 6352, 5325,  188, 4397, 5209, 1372, 1765, 5239, 8719, 6836,  230,
        7532, 2621, 7199, 7323, 2165, 4348, 7238, 2536, 2988, 1144, 4186, 7952,
          24, 2749, 9067,   72, 1039, 8413, 5955, 4680], device='cuda:0')
idx in forward tensor([5548, 3571, 5428, 4452, 6528, 4103, 2451, 3813, 2653, 8990,  731, 5622,
        3975, 4922, 7806,  467, 6560, 4115, 7805, 5960, 7777, 3871, 7724, 5876,
        8385, 1085,  314, 2809, 3022, 3679,  304, 2566], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3778, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3693, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3772, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3694, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8457, 5160, 1741, 5217, 8316, 7555,  178, 1014,   81, 2074, 9049, 8832,
        1273, 4182, 3364,  436, 2305, 3366, 2586, 3309, 2381, 8653, 9037, 1978,
        6944, 8543, 5166, 4100, 5567,  286, 7218,  994], device='cuda:0')
idx in forward tensor([2380, 3413, 7705, 8498, 1758, 3016, 4490,   90, 5136, 5864, 5788, 7683,
        3941, 1988, 3512, 2044, 5169, 4760, 1257, 5390,  169, 4645,  643, 6583,
        5073, 5156, 1076,  976, 9006,  799, 8385, 6888], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3835, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3748, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3784, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3698, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6553, 1276, 6588, 7642, 4116, 3861, 2553, 5044, 5880, 3091, 6042, 6219,
        7079, 3640, 4147, 1177, 3695,  599, 6963, 9108,  909, 9009, 5783, 6977,
        8399, 8664, 2956, 4932, 2863, 8294, 4270, 2958], device='cuda:0')
tensor([6217, 5909, 8806, 8797, 2077,  287, 3980, 2471, 8161, 7359, 8901, 5591,
        6877, 4152,  601, 4006, 7184, 5921, 4098, 3628, 7761, 8976, 3464, 5635,
        5012, 7713, 6066, 7619, 6724, 4943, 5480, 3226], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3950, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3887, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3832, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3748, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([1090, 4638, 5472, 7346, 4920,  633, 6810,  958, 3076, 8251, 1264, 7874,
        1883,  799, 1197, 1434, 3430, 2432, 4054, 6020, 6927, 2911, 3828, 6160,
        3087, 4854, 8491, 7695, 5516, 1014, 7578,  920], device='cuda:0')
idx in forward tensor([5983, 7083, 3959, 2326, 1290, 3517, 8526, 1363, 1187,  941, 8506, 7491,
        9112, 3130, 4929, 1469, 2389, 8207,  868,  396, 7905, 3960, 7808, 1344,
        8104,  838, 3841,  645,  776, 6552, 4558, 3578], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3820, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3730, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.4001, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3939, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5379,  552, 5318, 7262, 7010, 4116, 1848, 1376, 5434, 7008, 8554,  157,
        2570, 3642, 1787, 3200, 5893, 4273, 2360, 3872, 8754, 4431, 8874, 4609,
        7276, 1182, 3255, 4649, 8168, 6625, 6524, 6979], device='cuda:1')
idx in forward tensor([6194, 8573, 5247, 7218, 5674, 8416, 5159, 4570,  466, 6992, 5695, 9148,
        8023, 4838, 8277, 5625, 7336, 7666, 5826, 4876, 7389, 8192, 4630, 7560,
        7232,  980, 2031, 1708, 5010,  877, 7541, 7859], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3676, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3575, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3864, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3791, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6118, 3454, 7246, 7552, 8528, 2831, 5702, 2229, 7191, 7717, 7423, 8792,
          42, 4821, 2795, 1668, 8633,   85, 5571, 1222, 3894, 3251,  107, 4261,
        6894, 3298,  599, 5456, 1705,  860, 5258, 5171], device='cuda:0')
tensor([1436, 3599, 7298, 5071, 4413, 4368, 1878, 3737, 4354, 9012,  385, 8653,
        4370, 3750, 2252,   81,  697, 5330, 7484, 3092, 3414, 7494,  967, 7681,
        2018,  701, 5807, 4019, 2774, 8317, 1891, 2699], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3902, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3864, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3785, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3829, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1935, 1313,  298,  543, 7478, 6802, 8817, 7387, 8649,  739, 8699, 5072,
        5091, 8809, 4554, 6516, 6755, 3845,  840, 5098, 1604,  480, 5861, 5206,
        4085, 2390,  135, 7256,   38, 1715, 6582, 2531], device='cuda:1')
tensor([6281, 3107,  804,   30, 1724, 7663, 4674, 1840, 7918, 4714, 7981, 9077,
        2431, 4110, 1399, 4356, 2032, 6258, 7889, 3853, 1505, 1853,  860, 1776,
        6139,  959, 2183, 3620, 4437, 3968, 6358, 4758], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3693, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3593, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3666, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3557, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8739,   54, 7599, 4375, 7206, 1718, 4113, 7265, 6375,  731, 5389, 6577,
        8339, 5079, 3563, 5150,  908, 7889, 9147, 7208, 7288, 8921, 2052, 2011,
        4750, 7913, 3255, 6117,  663, 3724, 9089, 8589], device='cuda:0')
idx in forward tensor([1978, 5490, 4883, 2702, 7860, 4312, 5964, 8155, 7118, 8070, 7680, 1451,
        7912, 8829, 1476, 5078, 3341, 3585, 8075, 8283, 5194, 6708, 3948, 8008,
        7074, 7692, 4082, 3865,  312, 1493, 2233, 2926], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3716, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3612, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3564, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3440, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4939, 3489, 5478, 1777, 7454, 7910, 6805, 2454,   43,  313, 4655, 4772,
        7404, 5786, 2183, 7851, 2160, 8166, 3140, 7875, 6709,  213, 3276, 5843,
         165, 7161, 3462, 8063, 1696, 6915,  624, 1267], device='cuda:0')
tensor([3496, 1504, 7329, 8601, 5976, 7679, 6570, 1460, 7756, 2147, 4068, 3017,
        3061, 7083, 2301, 3230, 5317, 9011, 9135, 7370, 2699, 2493, 3992, 6946,
        3309, 5204, 1909, 7665, 2118, 4218, 3132, 8602], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3802, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3720, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3836, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3751, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([7754, 3636, 5645, 2773, 6852, 2253, 6587, 2667,  956, 4718, 7122, 8686,
        4741, 2665, 9099,  583, 9144, 8511, 3168, 2957, 5973, 4069, 3587, 5919,
        4698, 1034, 4744, 2453, 4762,  539, 6614, 6709], device='cuda:0')
idx in forward tensor([7885, 8983, 1244, 1391, 6626, 8390, 8056, 3013, 8356, 7763, 4974, 8771,
        4459, 3511, 3342, 6182, 7663, 6500,  376, 3365, 8997, 3045,  656,  839,
        4280,  892, 1304, 8140, 8007, 4038, 5216, 4278], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3709, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3611, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3705, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3603, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([4707, 5496, 5750, 2724,  361, 8645, 5344, 5924,  930, 4508, 3420, 1512,
        1796, 1606, 6426, 8631, 6829, 4124, 8361, 1013, 1697, 2017, 5213, 3455,
        3693,  787, 7474, 7192, 8050, 6899, 1234, 3514], device='cuda:1')
idx in forward tensor([4173, 3214, 8092, 4623, 6245, 8819, 7470, 4619, 6917, 1704, 7354,  852,
        1405, 2358, 8922, 6954, 2399, 8085, 6982,  638, 2751, 3486, 2087, 3950,
        1323, 8651, 6087, 7046,  855,  266,  722,  732], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3749, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3652, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3774, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3678, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7131, 3657, 4330, 5594, 2546, 7388, 6568, 6619, 8397, 3175, 7945, 3693,
        2384, 2709, 1633, 2437, 2187, 1945, 4289,   77, 3316, 6747, 8454, 7017,
        8866, 6611, 8468, 1864, 1023, 9010, 6938, 5815], device='cuda:0')
idx in forward tensor([7800, 2127, 5885, 1014, 3722, 4625, 4562,  374, 6440,  105, 3336, 6674,
        6579, 4372,  962, 4797,  879, 4838, 1248, 6201, 7880, 8212, 1725, 2697,
        4378, 8237,  361, 4972, 7489, 5755, 5203,  267], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3791, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3702, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3864, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3788, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([5103, 8331, 6985, 8414, 6086, 3165, 7521,  719, 3256, 3970, 2151, 5940,
        7827, 6981, 8222, 8973, 3182, 8091,  753, 4601, 2834, 7764, 5345, 2295,
         823,  366, 6868, 8366, 2727, 4702, 1799, 7678], device='cuda:0')
idx in forward tensor([7112, 8429, 1289, 2455, 8904, 1618, 2555, 1039, 2316, 8691, 1786, 6740,
        5135, 2823, 1545, 7489, 1575, 6020, 4968, 7113, 1470, 8993, 8429, 1051,
        1725, 7876,  193, 4564,  511, 1370,  213, 1774], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3692, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3593, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3638, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3523, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([7801, 5096, 6270, 1686,   52, 3322, 5567, 4670, 5684, 1291, 7514, 6645,
        3769, 1170, 3678, 8881, 6356, 5500, 5465, 3367, 8615, 5219, 8897, 4208,
        9003, 3708, 8656, 3677, 3390, 8049, 8858, 4013], device='cuda:1')
idx in forward tensor([5857, 6200,  898, 2330, 5478, 7796, 7105, 6631, 1002, 8315, 5097,  683,
        2223,  940, 5753, 4738, 3234, 1773, 1651, 6971, 5541, 4895, 8000, 4653,
         163, 5436, 4449, 3015, 5713, 6828, 6951, 7352], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3885, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3803, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3720, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3619, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2939, 4315, 5602, 8779, 7139, 4596,  656, 6843, 8292, 2826, 8132, 1454,
        5685, 7180, 4234, 3480, 1302, 7985, 5727, 1692, 7869, 6641, 7080, 6170,
        5482, 7956, 5327, 6460,  305, 8053, 3685, 6783], device='cuda:0')
idx in forward tensor([ 439,  389,  456, 6014, 5452, 4754, 4226, 4424, 3808, 5763, 8820, 1238,
        3041, 9027, 6707, 6871,  918, 5002, 7282, 7167, 3576,  119, 1884, 3725,
        5623,  829, 6387,  934, 8433, 8457, 6728, 6732], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forwardtext in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
 torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3842, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3767, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3607, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3489, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4951, 1053,  729, 7865, 5754, 5231, 6329, 2649, 1271, 5248, 4303, 2558,
        4736, 5250,   55,  783, 1731, 4580, 3969, 8184, 5334, 1444, 6255, 8612,
        1308, 6887, 2505, 3673, 6312, 1355, 5705, 2331], device='cuda:1')
idx in forward tensor([7535,  402, 8229, 6234, 2164, 1885, 8202, 1277, 3222, 5415, 5721,  657,
        7913, 3010, 8326, 5406, 7964, 6138, 1582, 2089, 3300, 5042, 7538, 8103,
        1549, 3059, 9052,  661, 5229,  111, 7525, 1135], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3926, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3849, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3616, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3497, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3548, 8735, 8153, 2729, 2557, 7923, 4633, 7483, 7793, 1621, 6434, 6289,
        4179, 1682, 1566,  653, 3211, 4129, 4117, 1464, 7409, 3627, 5462, 3252,
        7557, 2785, 1592, 3651,  174, 6172, 6887, 7222], device='cuda:1')
idx in forward tensor([8370, 4565, 4059,  841,  835, 4138, 7743, 6155,  619, 5937, 3683, 5896,
        4349, 3511, 3371, 2040, 1436, 4595, 5524, 5124, 2241, 2035, 3130, 7750,
        1637, 7906,  549, 6007, 2704, 3618, 6368, 1768], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3746, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3654, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3691, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3592, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8561, 8730, 2729, 4308, 7902, 1062, 1939, 3194, 8960, 6237, 1573, 8694,
        9154, 2894, 8923, 4498, 5134, 5337, 8786,  858, 2156,   64,  598, 8215,
        1219, 4244, 7902, 3101, 1237, 1463, 2590,  973], device='cuda:1')
idx in forward tensor([4482, 2201, 3306, 1477, 5255,  814, 1087,  181, 7322, 8465, 5981, 4523,
        5561, 6070, 1678, 2237, 5224, 3831, 8473, 2248, 4093, 3244, 2882, 5980,
        7844,  294, 2497, 3576, 3213,  403, 6816,  833], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3758, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3664, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3792, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3701, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3966, 2098, 3940, 5480, 1959, 6599, 3848, 3652, 7163, 7977,  184,  145,
        8341, 1394, 3612, 3613, 5553,  152,  216, 5125, 3694, 6167, 6198, 2632,
        5298, 8442, 2282, 5793, 4874, 5665, 3635, 2885], device='cuda:1')
idx in forward tensor([8214, 7093, 3164, 4502, 2419,  409,  918, 2770, 2817, 2470,   57, 4241,
        8108, 2489, 5079, 8115, 1666, 1051, 6183, 3850, 8932,  900, 1975, 4047,
        5997, 8363,  444, 5322, 8712, 2205, 3738, 6320], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3565, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3439, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3724, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3630, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6200, 6302, 5791, 3147, 5436,  719, 4841, 3971, 4387,  177, 8652, 6618,
        3099, 7349, 3834, 4685, 7651, 3575, 7997, 7264,  705, 8865, 3630, 1073,
         559, 7192, 5519, 1711, 4538, 4415, 7878, 4480], device='cuda:1')
idx in forward tensor([2839, 1620, 2656, 3847, 7118, 4092, 6646, 7054, 3615, 3147,  115, 3790,
        3958, 1038, 8253, 6584, 7554,  306,  786, 7991, 1270, 3766, 3044, 8729,
        7019, 1221, 1010, 1905,  229, 4765, 5081, 7681], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3763, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3670, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3938, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3863, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([1025, 4849,  246, 5869, 1889, 7439, 5842, 5687, 6687, 3712, 3309, 8935,
        2258, 1970, 4364,  591, 6590, 3843, 1742, 8062,  457,  165, 7397, 1609,
        2192, 8604, 7790,  276, 3755, 8707, 6176, 6539], device='cuda:0')
idx in forward tensor([ 542, 4472, 4237, 3934,   98,  415,   56, 8938, 7497, 4264,  265, 8420,
        6089, 5874, 3368, 8542,  194, 6615, 1703, 6819, 8162, 5396, 3057, 2869,
        2188, 4084, 8998, 4091, 2958, 8480, 3352, 3190], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3845, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3761, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3695, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3580, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([8790, 8402, 1773, 6375, 2308, 4804, 9087, 5607, 4317, 5961, 8785, 8743,
        1258,  270, 5985, 4570, 5797, 7333, 6051, 6970, 2550, 5504, 6505, 5049,
        1544, 3653, 6561, 7015, 2102, 3526, 2687, 8985], device='cuda:1')
idx in forward tensor([7425,  327, 6523, 6669, 8296, 8482, 2763, 4940, 5369, 1749, 1659, 4632,
        7145, 2527, 4561, 1964, 2877, 6228, 1624,  443, 5516, 2596, 8636,  472,
        5233, 1707, 6487, 6501, 3154, 3417, 5388, 2947], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])

pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3737, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3639, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3680, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3564, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([5538,  147, 4220, 4011, 9045, 7303,  613, 3868, 5794, 7063, 6713, 2178,
        4772, 2137, 2900, 1678, 8381, 2310,  148, 1846, 5300, 8599, 3414,  920,
        2443, 7470, 7941, 4169, 3035, 2050, 4181, 7751], device='cuda:1')
idx in forward tensor([5905, 2457, 6808, 4845, 5356, 5759, 7060, 7448, 6481, 7814, 6761, 3671,
        6957, 3388, 2498, 8334, 7087, 1920, 7204, 8443, 8867,  831, 6851, 5898,
        2348, 4594, 3483, 4293, 8735, 2823, 6854, 2720], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])

image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3796, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3708, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3885, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3813, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1941, 4145, 6905, 4708, 5185,  736, 2678, 8375, 1965,  630, 8165, 8902,
        2936,  916, 7737, 6648, 3521, 3725, 2634, 9012, 2652, 5384, 2747, 7922,
        7000, 7654, 1783, 3401, 5506, 8478, 5615, 8188], device='cuda:0')
tensor([ 745, 8028, 3325, 7062, 1239, 5433, 4325, 2714, 3783, 5474, 5073, 2638,
        1941, 8647, 1585, 7547,  614,   94, 7011, 6580, 7226, 4938, 5366, 3595,
         579, 4114, 8612, 5728, 5193, 2137, 1803, 3118], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3853, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3783, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3927, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3854, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([7283, 6046, 1988, 5768, 7539, 2403, 5257, 3943, 4247, 4779,  987, 6289,
        5166,  369, 3061, 1456, 8718,  196, 3517, 5974, 5191, 4649, 5582, 1247,
        4442,  682, 4886, 2526, 1268, 5870, 4529,  214], device='cuda:0')
idx in forward tensor([1474, 5309, 2926, 6280, 6023, 6489, 7125, 6124, 8464, 4972, 6605, 8002,
        7152, 1281, 6395,  235, 6095, 6083, 4041, 2525,  862, 1626,  948, 1883,
        1894, 7977, 6304, 7834, 2286, 1195, 6026, 1548], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3845, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3746, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3792, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3699, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([2992, 3885, 7463, 7389,  310, 3032, 1559, 1707, 3235, 2601, 5872,  211,
          34, 1591, 3586, 1114,  937, 3528, 4989, 7003, 3426, 6052,  569, 3952,
        4260, 4297, 6681, 7951, 7625, 2396, 4567, 7942], device='cuda:1')
idx in forward tensor([7019, 9094, 5311,  895, 2490, 7687, 8426, 4898, 2680, 4374, 8793, 7034,
        1137,    3, 2960, 6190, 8564, 4308, 4719, 7804,  326,  972, 6818, 8619,
        1392, 1102, 4139, 3091, 7714,  535,  194, 1712], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3821, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3727, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3747, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3643, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3737, 4578, 2295,  102, 4263, 6801, 1215, 4910,  487, 3717, 7565, 4594,
        3120, 2223,  466, 5410, 6216, 2175, 4454, 4323, 4965, 8133, 6316,  503,
        1521, 9103, 2274, 1952, 7806, 2904, 3642, 8758], device='cuda:1')
idx in forward tensor([2062, 3721, 2590, 6532, 9086, 1178, 2276, 7079, 3382, 4875, 1749,  333,
        3240, 8320, 5319, 2688, 1592,  181, 1272, 4863, 3224, 6608, 2558, 2443,
        8628, 5893, 3797,  468, 4925, 8753, 6109, 3752], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3911, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3758, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3665, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3845, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([5818, 3023, 7146, 4424, 1139, 2269, 7442, 4761, 1658, 3825, 1505,  478,
        5214, 7941, 7091, 1728,  343, 3959, 6060, 2643, 2609, 2025,  388, 9029,
        3218, 4889, 4610, 6018, 6459, 4010, 5190, 6369], device='cuda:0')
tensor([1236, 5208, 1028, 7055, 6288, 6844, 4748, 8888, 2563, 1839, 1861, 5399,
         828, 5106, 3082, 8969, 5736, 3949, 7306, 9080,  502, 7797, 5114, 3271,
        6260, 2246, 3332, 5827, 3393,  219, 6375, 2263], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3861, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3783, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3581, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3445, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2884, 2321, 6310, 1482, 5727, 4344,  398, 4299, 6288, 8778, 6496, 1870,
         990, 1882, 6994,  674, 7842, 2129, 1014,  784, 7960, 1734, 6864,  618,
        7757, 8912, 6582, 6758, 5589, 3862, 8110, 4572], device='cuda:1')
tensor([8329, 3555, 2015, 8438, 5427, 4809, 6106, 7384, 7564, 3601, 6350, 3712,
        1611, 8839, 1164, 8051, 6456, 3254,  943, 2420,  643, 3286, 6731, 4000,
        5532,  992, 1848, 6834, 2275, 9008, 6992, 8992], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3685, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3582, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3634, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3515, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2085,  981, 4770, 3125, 1262, 8148, 7319, 7198,  707, 8777, 8391, 7729,
        3429, 4017, 3192, 7252, 7815, 4360, 5588, 4321, 1447, 4816,  335, 1996,
        4414,  853,  148, 5534, 6429, 1289, 3732, 5173], device='cuda:0')
idx in forward tensor([  23, 4223, 1249, 1235,  929, 6877,  922, 2289, 3068, 6957, 1317, 4714,
        2944, 5898, 4273, 1123, 5470, 3501, 1673, 1514, 6337, 5493, 3011, 8177,
        5878, 8247, 6371, 7049, 6514, 2317, 9090, 6886], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3776, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3685, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3732, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3624, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([1835, 1362, 4422, 3473, 7163, 8938, 1380, 8738, 4033, 8901, 6763, 6716,
        7700, 3199, 5470, 2738, 2134, 8823,  101,  496, 6756, 4166, 8015, 3809,
        3972, 7767, 5404, 8317, 8548, 8737, 6989, 4190], device='cuda:1')
idx in forward tensor([8175, 5643,  184, 8105, 1061, 3323, 1458, 8338, 5960, 2925, 6475, 2637,
        1486, 6813, 2764, 3321, 6411, 7802, 3006,  651, 2270,  632, 4473, 2821,
        1991, 8823, 6497, 1690, 4111, 4250, 8813,  435], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3886, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3808, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3819, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3733, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([6503, 8012, 1914, 2917, 1635, 1039, 8877, 7982, 2298, 4800, 5268, 8727,
        4743, 3688, 5521, 7593, 3095, 8576, 3852, 4039, 8740, 7458, 6402, 8257,
        5553, 7057, 9130, 5152, 3328, 7299, 2255, 2598], device='cuda:1')
idx in forward tensor([6088, 7480,  140, 6259, 8053, 1539, 8194, 6082, 2903,  779, 8598, 7121,
        3413, 4805, 2745, 1802, 7358, 3116, 7598, 7386, 3207,  161, 4700, 7411,
        2935, 6163, 7276,  541, 5142, 1923, 7322, 2517], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forwardtext in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
 torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3639, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3531, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3617, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3498, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([3999, 6050, 4833, 2090, 1389, 2891, 4284, 8768, 6660, 2432, 4560, 5882,
        7552, 6969, 8559, 6653, 4725, 1989, 8790, 4410, 3180, 6469, 4559, 8860,
         482, 3096, 7978, 1492, 8556, 2794, 3835, 1280], device='cuda:1')
tensor([8669, 1632, 3919, 8721,  790, 2530, 5277, 6970, 4172, 2436, 8198, 1878,
        7873,  223, 6803, 8704, 3565, 4844, 4737, 7406, 6396, 3196, 5504, 7647,
        2069, 6942, 5307, 8000, 5880, 6521, 1845, 8493], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forwardtext in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
 torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3804, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3717, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3685, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3581, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([ 262, 6376, 7371, 4736, 5046, 3400, 7710, 4892, 7536, 7302, 8852, 7267,
        7165, 6449, 9076, 4594, 4784, 3385, 4822, 6544,  721, 4441, 1472, 7846,
        7447, 4629, 5257, 5732, 8796, 1773, 5971, 6397], device='cuda:0')
idx in forward tensor([8739, 7038, 8520, 3840, 3864, 1720, 8012, 8430, 5647, 3063,   31, 4272,
        7048,  375, 8875, 3835, 8717, 1772, 7709, 3767, 7034, 7296, 7205, 6893,
        6004, 5615,  197, 5616, 2574, 2654, 1979, 5214], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3854, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3772, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3646, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3531, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([8602, 5660,  981, 6084, 5030, 7628,  817, 3621, 5642, 8353, 2782, 5683,
        6617, 5387, 1777, 7335, 1780, 9000, 1511, 2113, 4173, 4925, 2646, 7153,
         155, 2399, 7042,  911, 1824, 1290, 6160, 2772], device='cuda:0')
idx in forward tensor([2494, 6602, 7590, 8283, 5514, 4019, 8748, 1341, 5520, 7517,  682, 5085,
        7742, 3850, 3340, 1395, 7150, 6912, 2519, 7237, 3808, 3830, 7621, 3152,
        7401,  293, 1024, 4642, 5830, 7980, 4512, 7796], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3883, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3799, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3683, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3580, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([2386, 7872, 1083, 8854, 4259, 5746, 3135, 5105, 3028,  781, 7408, 1781,
        7364, 5264, 7521, 7821, 7303, 3767, 6988, 3588,  174, 6331, 4026, 5179,
        2838, 6152, 1033, 7576, 2520, 2397, 1123, 5666], device='cuda:0')
idx in forward tensor([3975, 6614, 2722, 5594, 8606, 7738, 8883, 8911, 5811, 8837, 2381, 1531,
        4228, 9139, 7942, 3994, 2554,  808, 7331, 2354, 7986, 5905, 2153, 4710,
        6384, 1250, 3433, 6389,  885, 5803, 3927,  541], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3720, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3756, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3655, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3607, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([6822,  761, 8485, 6389, 4015,   87, 5626,  971, 5922, 1295, 2954, 5761,
        6502, 7741, 8315, 2806, 7946, 9074, 7877, 3405, 5717,  218, 1047, 3176,
        6049, 2485, 1367, 6604, 4793, 3407, 7263, 5236], device='cuda:0')
tensor([7706, 4075, 2618,  819, 3557, 7700, 7345, 4533, 6206, 1433, 6815, 4909,
        7993, 4860, 8375, 1165, 8070, 9024, 6204, 2304, 8197, 7421, 5598, 1906,
        1072, 1305,  458, 2248,  647, 1373, 5410, 6383], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3748, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3641, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3665, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3561, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3296, 3638, 6991, 3761, 4938, 6866, 6776, 4310, 7131, 6721, 3897,  448,
        4364, 7402, 8987, 5327, 6382, 4050, 3011, 1230,  635, 2038, 5930, 7685,
        6142, 5204, 4945, 6762, 2226, 6767, 2824, 4010], device='cuda:0')
idx in forward tensor([8310, 1634, 9073, 2950, 6276, 2931, 7574, 9077, 8972,  381, 1117, 3997,
        6551,   68, 7095, 5773,  696,  830, 9100, 2460, 7197, 1798,  956, 2414,
        2233, 5434, 8984, 8319,   62, 6471, 8176, 4522], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3894, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3807, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3784, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3681, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([4666, 3321, 3654, 6630, 5943, 4140, 1432, 7535, 1489, 6744, 8529, 4936,
        4372, 1659, 8340, 5101, 6756, 8542, 7672, 1281, 1213,  239, 6150, 1041,
        3545, 1132, 6100, 4617, 7723, 4584, 2333, 6369], device='cuda:0')
tensor([3783, 5653, 8764, 1629, 6911,  948, 3905, 1514, 5983, 6440, 9050, 4349,
        1930, 1192, 1302, 7155, 4756, 2464, 5873,  648, 7979, 6710, 5873,  199,
        8490, 4088, 2970, 8210, 4760, 5018, 7587,  356], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3766, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3675, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3635, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3507, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([7762, 3204, 9033, 7648, 1358, 1901,  330, 5153, 4870, 1094,  805, 7858,
        8783, 1905, 2923, 3525, 2856, 3783, 3125, 1157, 1591, 6621, 4833, 7101,
         196, 5844, 7951, 3957, 4939, 8499, 8598, 5143], device='cuda:0')
idx in forward tensor([ 649, 1717, 6860, 6876,  416, 2123, 7422, 8345, 8046, 7330, 3120, 8630,
        4124, 5934, 5867, 6625, 5933, 1654, 9083, 2967, 7420, 3201, 6956, 2619,
        2157, 3345, 4045,   13, 4678, 6314, 8702, 6462], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3695, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3578, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3671, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3554, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([1057, 5556, 8623, 2902, 1168, 7310, 6710, 1225, 1558, 6397, 5956, 6627,
        3079,  804, 7240, 4198,  442, 5391, 3802, 6252, 2035, 4114, 1130,  581,
        1371,  193, 7016, 5575,  693, 4281, 6100, 1216], device='cuda:1')
idx in forward tensor([4888, 3787,  476, 8770, 4102, 1756, 8624, 3278, 7124, 7189, 6179, 3410,
        9032,  137, 8937, 1158, 3496, 1919, 7517, 3766, 6269,  524,  720, 8757,
        4768, 4976,  264, 8033, 7557, 3671, 3026, 7992], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3654, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3539, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3762, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3678, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4387, 1389, 5010, 3068, 2828,  772, 3084, 3156, 2500, 2133, 9044, 7002,
        7977, 8029, 5531, 1357,  996, 3287,   45,  578, 6059, 6630,   88, 6414,
        1223, 5233, 7833, 4898, 6363, 8736, 8793, 7868], device='cuda:0')
idx in forward tensor([2693, 5087, 8223,   52, 1026, 4907,  228, 7863, 8155, 1969, 4761,  986,
        2601, 7840, 6065, 3701, 7892, 4785, 1963, 4673, 7840, 4899, 7304, 2170,
        7261, 5670, 1039, 7496, 4794,  617, 4153, 4808], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3820, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3743, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3867, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3791, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([2620, 2672, 3231, 5990, 1550, 8090, 3434, 5494, 7293, 4066, 2433, 2033,
        2966, 3910, 8421, 2538, 7857,  966, 5403, 8112, 1467, 4094, 1162, 7637,
         904, 3399, 3509, 6097, 6939, 7944, 5723,  484], device='cuda:1')
idx in forward tensor([4689, 7969, 5010,  319, 6832, 2153, 8289, 8501, 6787, 1274, 3618, 1094,
         310, 7374, 3988, 2572, 1813, 8312,  419, 8179, 6143,  141, 1120, 8198,
        6492, 5006, 2495,  962, 5547, 5058, 3643, 1446], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3779, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3693, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3676, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3581, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4474, 5939, 8858,  560, 5469, 2934, 3956, 7871, 3956, 8294,  961, 8163,
        5243, 6755, 2954, 5955, 3916, 6963, 8566, 6931, 5376, 4085,  451, 8206,
        6508, 7147, 6396, 6164, 4925,  299,  508, 7128], device='cuda:1')
idx in forward tensor([7854, 6952, 4625, 4803, 4121, 3174, 4372, 7191, 6212, 1337, 8235, 2473,
        4701, 6902, 7770, 3270, 4268, 4979,  483,    0, 6597, 6845, 7259, 6260,
         901, 1093, 6746,  502, 6707, 1417, 5724,  518], device='cuda:0')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3825, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3729, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3859, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3779, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([5535, 5425, 3846, 2484, 6215, 6523, 2233, 7421, 1831, 4452, 9084,  283,
        5953, 5686, 8737, 1853, 6793, 2749, 1310, 7914, 1146, 8196,  425, 2859,
         763, 3289, 8560, 4656, 5451, 1461, 8470, 2460], device='cuda:0')
idx in forward tensor([8735,  175, 2763, 3867, 1131, 2913, 3827, 4677, 5874, 6453, 2900, 7074,
        6277, 1332, 4521, 2238, 4275, 6900, 8314, 2423, 1672, 3713, 5605, 6818,
        6820, 4976,  940, 3465, 3748, 1396,  164, 6071], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3665, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3555, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3914, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3837, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([3313, 4175, 7891,   28, 5282, 1102, 6140,  973, 7493,  959, 4242, 3647,
        2669, 7332, 7391, 2159, 1441, 1899,   31, 5208, 3385,  475, 4205, 3253,
        9036, 5426, 3389, 6768,  736, 8332, 3546, 8231], device='cuda:0')
idx in forward tensor([3916, 7620, 2317, 2521, 1659, 8422,  483, 4330, 3019, 3281,  939, 8796,
        3256, 5068, 1048, 4603, 6142, 3152, 1635, 4031, 3314, 5595, 4559, 6883,
        3726, 6897, 9013, 2629, 5810, 1213, 7415, 2940], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3790, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3703, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3908, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3828, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([1616, 1742, 2687, 8961, 8880, 3611, 3239, 6415, 3965, 4071, 3761, 6548,
        3184, 6326,  782, 5128, 4078, 6837, 2800, 6052, 4561, 5401, 3988, 1701,
        7895, 3377, 3754, 8579, 6739, 3637, 7747, 2553], device='cuda:0')
tensor([7473, 2789, 8656, 5603, 1310, 1115, 8131, 1533, 2568, 1484, 4056, 3263,
        5648, 5015, 1049, 3110, 6757, 2883, 4763, 1417, 7632, 1492, 2924, 7932,
        2594, 4505, 3845, 7454, 6627, 1406, 1291, 6470], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3839, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3757, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3768, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3677, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([4602, 8911, 4691, 6859, 7800, 3946, 1938, 3462, 1297, 8036, 1392,  769,
        8708, 6320, 2000, 7927,  486, 6183, 4757, 8796,   10, 7833, 4005, 8420,
         414, 8151,  363, 5259, 6185, 3388, 8500,  239], device='cuda:0')
idx in forward tensor([4495, 3310, 8392, 4035, 7166, 5051,  880, 1903, 4471, 1962, 2866, 1648,
        9001, 7008, 4189, 4862, 5063, 4713, 3943, 2026, 8915, 8231,  684, 5863,
         750, 5112, 2847, 2608, 5577,  839,   47,  285], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3813, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3729, device='cuda:0', grad_fn=<MeanBackward0>)
tensor(3.3579, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3460, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([3439, 7876, 5903, 1542, 3082,  636, 2712, 5883, 4971, 5362, 5166, 6145,
        6748, 1127, 3609, 3640, 6872, 5459, 6496,  200, 2077, 9122,   57,  330,
         590, 7363,  435, 5420, 7807, 3925, 1661, 1065], device='cuda:0')
idx in forward tensor([6717, 2626, 2788, 7199, 7723, 4564, 5775, 7250, 8522, 7738, 6926, 7864,
        5778, 2012, 7901, 4454, 5337, 1318, 7121, 6666, 7790, 7305, 4512, 1598,
        8908, 1474, 8364, 3664, 2265, 7617, 3704, 3633], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3876, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3794, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3510, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3389, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([ 622, 8850, 7439, 3039, 3411, 3328,  898, 1951, 5163, 3043, 1766, 7783,
        2246, 7562, 2696, 7460,   84, 5511, 6288, 5734, 7594, 5080, 8737, 3957,
        6273, 8781, 3214, 1495, 5670, 3374, 5174, 3581], device='cuda:0')
idx in forward tensor([ 712, 5147, 3332, 3012, 5382, 3237, 5766, 7010, 7739, 1739, 6884, 1621,
        2524, 1291, 4340, 3269, 4106,   51, 6178, 5178, 3586,  609, 5987, 6929,
         563, 7270, 7767, 8955, 2151, 1590, 7005, 1552], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3823, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3738, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3768, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3673, device='cuda:1', grad_fn=<MeanBackward0>)
idx in forward tensor([1256,  319, 2276, 1721, 6899, 4891, 8229,  146, 3467, 3324,  614, 8293,
        3802, 7767, 1985, 1134, 1687, 7507, 5199, 1704, 8927, 4162, 7458, 2311,
         625, 2802, 1915, 4224, 7230,  280, 2743, 3583], device='cuda:0')
idx in forward tensor([6413, 6958, 1626, 1511, 2118, 7646, 1815,  354,  697, 8130, 4251, 6818,
        7007, 3469, 2494, 2335, 1843, 4805, 2066,  712, 1059, 3895, 7684, 5421,
        5149, 2027, 4802, 6016, 8021,  745, 8227, 1673], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3743, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3633, device='cuda:1', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3770, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3663, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward idx in forward tensor([2390, 6894, 4780, 5160, 8342, 3482, 2506, 3581, 8243, 6095, 3025, 5822,
        2479, 1677, 2234,  896,  365, 7714, 3635, 9070, 5565,  619, 7293, 4561,
        5816,  297,  810, 7439, 1192, 3600, 6156, 7885], device='cuda:0')
tensor([7545, 3353, 1284, 8836, 8722, 7104,  268, 4734, 9018, 8672,  737, 3915,
        6935, 8318, 7998, 2014, 1798, 8517, 8930, 5543, 4155, 3259, 3022, 8335,
        2075, 5822, 1699, 4296, 7286, 3354, 6749, 1764], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss loss_i2t_ori in get_contrastive_loss tensor(3.3822, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3726, device='cuda:1', grad_fn=<MeanBackward0>)
tensor(3.3679, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3572, device='cuda:0', grad_fn=<MeanBackward0>)
idx in forward tensor([6364, 1916, 3616,  236, 7948,   22, 2789, 8255, 8091, 8212, 3004, 5050,
        6849,  559, 1360, 1075,   75, 4596, 7342, 2421, 2390, 2363,  376, 4832,
        9111, 2418, 4726, 5495, 3684, 2447, 6476, 3378], device='cuda:0')
idx in forward tensor([2771, 1072, 4865, 4896, 6036, 7925, 9130, 7512, 3504, 3309, 7907, 5106,
        3833, 5745, 4374, 1344, 6600, 7496,  360, 5271, 4196, 4107, 3061, 7957,
          23, 4499, 3849, 1111, 6032, 9111, 5815, 2120], device='cuda:1')
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
text in forward torch.Size([32, 60, 768])
pooled_text_embeds in forward torch.Size([32, 768])
image in forward torch.Size([32, 788, 768])
pooled_image_embeds in forward torch.Size([32, 4, 768])
neg_text1_embeds in forward torch.Size([32, 60, 768])
loss_i2t_ori in get_contrastive_loss tensor(3.3528, device='cuda:0', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3397, device='cuda:0', grad_fn=<MeanBackward0>)
loss_i2t_ori in get_contrastive_loss tensor(3.3800, device='cuda:1', grad_fn=<NegBackward0>)
loss_i2t in get_contrastive_loss tensor(3.3713, device='cuda:1', grad_fn=<MeanBackward0>)
[32m2023-10-20T16:45:01 | utils.basic_utils: [0mTrain Epoch: [0]  [571/572]  eta: 0:00:08  lr: 0.000010  temperature: 0.0185  video-loss_ita: 2.1804  video-loss_itm: 0.4785  time: 1.8639  data: 0.0002  max mem: 33192 res mem: 33720
[32m2023-10-20T16:45:01 | utils.basic_utils: [0mTrain Epoch: [0] Total time: 1:22:17 (8.6317 s / it)
[32m2023-10-20T16:45:01 | __main__: [0mAveraged train stats: lr: 0.0000  temperature: 0.0177  video-loss_ita: 2.4961  video-loss_itm: 0.5861
[32m2023-10-20T16:45:01 | tasks.retrieval_utils: [0mStart evaluation for media_type=video
[32m2023-10-20T16:45:01 | tasks.retrieval_utils: [0mComputing dual encoder features...
[32m2023-10-20T16:45:55 | utils.basic_utils: [0mextracting image feats  [0/6]  eta: 0:05:15    time: 52.5706  data: 52.0700  max mem: 33192 res mem: 33720
[32m2023-10-20T16:45:58 | utils.basic_utils: [0mextracting image feats  [5/6]  eta: 0:00:09    time: 9.3184  data: 8.8505  max mem: 33192 res mem: 33720
[32m2023-10-20T16:45:58 | utils.basic_utils: [0mextracting image feats Total time: 0:00:55 (9.3203 s / it)
[32m2023-10-20T16:45:58 | tasks.retrieval_utils: [0mFinished feature extraction
[32m2023-10-20T16:45:58 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product]
[32m2023-10-20T16:45:58 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product], done!
[32m2023-10-20T16:45:58 | tasks.retrieval_utils: [0mRerank dual-encoder results with cross-encoder...
[32m2023-10-20T16:45:58 | tasks.retrieval_utils: [0mi2t_scores.shape torch.Size([93, 184])
[32m2023-10-20T16:45:58 | tasks.retrieval_utils: [0mn_clip_per_video=1, with eval_frame_ensemble=concat
[32m2023-10-20T16:45:58 | utils.basic_utils: [0mEvaluation:  [ 0/93]  eta: 0:00:09    time: 0.1025  data: 0.0002  max mem: 33192 res mem: 33720
[32m2023-10-20T16:46:03 | utils.basic_utils: [0mEvaluation:  [92/93]  eta: 0:00:00    time: 0.0455  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:46:03 | utils.basic_utils: [0mEvaluation: Total time: 0:00:04 (0.0457 s / it)
[32m2023-10-20T16:46:03 | tasks.retrieval_utils: [0mt2i_scores.shape torch.Size([93, 184])
[32m2023-10-20T16:46:03 | utils.basic_utils: [0mEvaluation:  [ 0/93]  eta: 0:00:15    time: 0.1719  data: 0.0001  max mem: 33192 res mem: 33720
[32m2023-10-20T16:46:18 | utils.basic_utils: [0mEvaluation:  [92/93]  eta: 0:00:00    time: 0.1750  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:46:18 | utils.basic_utils: [0mEvaluation: Total time: 0:00:15 (0.1702 s / it)
[32m2023-10-20T16:46:33 | tasks.retrieval_utils: [0mEvaluation time 0:01:31
[32m2023-10-20T16:46:33 | tasks.retrieval_utils: [0mStart evaluation for media_type=video
[32m2023-10-20T16:46:33 | tasks.retrieval_utils: [0mComputing dual encoder features...
[32m2023-10-20T16:47:26 | utils.basic_utils: [0mextracting image feats  [0/6]  eta: 0:05:17    time: 52.8337  data: 52.2749  max mem: 33192 res mem: 33720
[32m2023-10-20T16:47:29 | utils.basic_utils: [0mextracting image feats  [5/6]  eta: 0:00:09    time: 9.2478  data: 8.8902  max mem: 33192 res mem: 33720
[32m2023-10-20T16:47:29 | utils.basic_utils: [0mextracting image feats Total time: 0:00:55 (9.2532 s / it)
[32m2023-10-20T16:47:29 | tasks.retrieval_utils: [0mFinished feature extraction
[32m2023-10-20T16:47:29 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product]
[32m2023-10-20T16:47:29 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product], done!
[32m2023-10-20T16:47:29 | tasks.retrieval_utils: [0mRerank dual-encoder results with cross-encoder...
[32m2023-10-20T16:47:29 | tasks.retrieval_utils: [0mi2t_scores.shape torch.Size([93, 184])
[32m2023-10-20T16:47:29 | tasks.retrieval_utils: [0mn_clip_per_video=1, with eval_frame_ensemble=concat
[32m2023-10-20T16:47:29 | utils.basic_utils: [0mEvaluation:  [ 0/93]  eta: 0:00:00    time: 0.0080  data: 0.0004  max mem: 33192 res mem: 33720
[32m2023-10-20T16:47:33 | utils.basic_utils: [0mEvaluation:  [92/93]  eta: 0:00:00    time: 0.0456  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:47:33 | utils.basic_utils: [0mEvaluation: Total time: 0:00:04 (0.0444 s / it)
[32m2023-10-20T16:47:33 | tasks.retrieval_utils: [0mt2i_scores.shape torch.Size([93, 184])
[32m2023-10-20T16:47:33 | utils.basic_utils: [0mEvaluation:  [ 0/93]  eta: 0:00:16    time: 0.1784  data: 0.0001  max mem: 33192 res mem: 33720
[32m2023-10-20T16:47:49 | utils.basic_utils: [0mEvaluation:  [92/93]  eta: 0:00:00    time: 0.1657  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:47:49 | utils.basic_utils: [0mEvaluation: Total time: 0:00:15 (0.1680 s / it)
[32m2023-10-20T16:48:03 | tasks.retrieval_utils: [0mEvaluation time 0:01:30
[32m2023-10-20T16:48:04 | tasks.retrieval_utils: [0mStart evaluation for media_type=video
[32m2023-10-20T16:48:04 | tasks.retrieval_utils: [0mComputing dual encoder features...
[32m2023-10-20T16:48:25 | utils.basic_utils: [0mextracting image feats  [0/2]  eta: 0:00:42    time: 21.1105  data: 20.8531  max mem: 33192 res mem: 33720
[32m2023-10-20T16:48:25 | utils.basic_utils: [0mextracting image feats  [1/2]  eta: 0:00:10    time: 10.6785  data: 10.4266  max mem: 33192 res mem: 33720
[32m2023-10-20T16:48:25 | utils.basic_utils: [0mextracting image feats Total time: 0:00:21 (10.6842 s / it)
[32m2023-10-20T16:48:25 | tasks.retrieval_utils: [0mFinished feature extraction
[32m2023-10-20T16:48:25 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product]
[32m2023-10-20T16:48:25 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product], done!
[32m2023-10-20T16:48:25 | tasks.retrieval_utils: [0mRerank dual-encoder results with cross-encoder...
[32m2023-10-20T16:48:25 | tasks.retrieval_utils: [0mi2t_scores.shape torch.Size([32, 62])
[32m2023-10-20T16:48:25 | tasks.retrieval_utils: [0mn_clip_per_video=1, with eval_frame_ensemble=concat
[32m2023-10-20T16:48:25 | utils.basic_utils: [0mEvaluation:  [ 0/32]  eta: 0:00:00    time: 0.0077  data: 0.0001  max mem: 33192 res mem: 33720
[32m2023-10-20T16:48:26 | utils.basic_utils: [0mEvaluation:  [31/32]  eta: 0:00:00    time: 0.0240  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:48:26 | utils.basic_utils: [0mEvaluation: Total time: 0:00:00 (0.0240 s / it)
[32m2023-10-20T16:48:26 | tasks.retrieval_utils: [0mt2i_scores.shape torch.Size([32, 62])
[32m2023-10-20T16:48:26 | utils.basic_utils: [0mEvaluation:  [ 0/32]  eta: 0:00:02    time: 0.0807  data: 0.0001  max mem: 33192 res mem: 33720
[32m2023-10-20T16:48:29 | utils.basic_utils: [0mEvaluation:  [31/32]  eta: 0:00:00    time: 0.0838  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:48:29 | utils.basic_utils: [0mEvaluation: Total time: 0:00:02 (0.0885 s / it)
[32m2023-10-20T16:48:31 | tasks.retrieval_utils: [0mEvaluation time 0:00:27
[32m2023-10-20T16:48:31 | tasks.retrieval_utils: [0mStart evaluation for media_type=video
[32m2023-10-20T16:48:31 | tasks.retrieval_utils: [0mComputing dual encoder features...
[32m2023-10-20T16:48:53 | utils.basic_utils: [0mextracting image feats  [0/2]  eta: 0:00:42    time: 21.0088  data: 20.7494  max mem: 33192 res mem: 33720
[32m2023-10-20T16:48:53 | utils.basic_utils: [0mextracting image feats  [1/2]  eta: 0:00:10    time: 10.6170  data: 10.3747  max mem: 33192 res mem: 33720
[32m2023-10-20T16:48:53 | utils.basic_utils: [0mextracting image feats Total time: 0:00:21 (10.6188 s / it)
[32m2023-10-20T16:48:53 | tasks.retrieval_utils: [0mFinished feature extraction
[32m2023-10-20T16:48:53 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product]
[32m2023-10-20T16:48:53 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product], done!
[32m2023-10-20T16:48:53 | tasks.retrieval_utils: [0mRerank dual-encoder results with cross-encoder...
[32m2023-10-20T16:48:53 | tasks.retrieval_utils: [0mi2t_scores.shape torch.Size([32, 62])
[32m2023-10-20T16:48:53 | tasks.retrieval_utils: [0mn_clip_per_video=1, with eval_frame_ensemble=concat
[32m2023-10-20T16:48:53 | utils.basic_utils: [0mEvaluation:  [ 0/32]  eta: 0:00:00    time: 0.0080  data: 0.0002  max mem: 33192 res mem: 33720
[32m2023-10-20T16:48:54 | utils.basic_utils: [0mEvaluation:  [31/32]  eta: 0:00:00    time: 0.0264  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:48:54 | utils.basic_utils: [0mEvaluation: Total time: 0:00:00 (0.0266 s / it)
[32m2023-10-20T16:48:54 | tasks.retrieval_utils: [0mt2i_scores.shape torch.Size([32, 62])
[32m2023-10-20T16:48:54 | utils.basic_utils: [0mEvaluation:  [ 0/32]  eta: 0:00:02    time: 0.0825  data: 0.0001  max mem: 33192 res mem: 33720
[32m2023-10-20T16:48:57 | utils.basic_utils: [0mEvaluation:  [31/32]  eta: 0:00:00    time: 0.0867  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:48:57 | utils.basic_utils: [0mEvaluation: Total time: 0:00:02 (0.0882 s / it)
[32m2023-10-20T16:48:59 | tasks.retrieval_utils: [0mEvaluation time 0:00:27
[32m2023-10-20T16:48:59 | tasks.retrieval_utils: [0mStart evaluation for media_type=video
[32m2023-10-20T16:48:59 | tasks.retrieval_utils: [0mComputing dual encoder features...
[32m2023-10-20T16:49:33 | utils.basic_utils: [0mextracting image feats  [0/4]  eta: 0:02:16    time: 34.0810  data: 33.7404  max mem: 33192 res mem: 33720
[32m2023-10-20T16:49:35 | utils.basic_utils: [0mextracting image feats  [3/4]  eta: 0:00:08    time: 8.8507  data: 8.6232  max mem: 33192 res mem: 33720
[32m2023-10-20T16:49:35 | utils.basic_utils: [0mextracting image feats Total time: 0:00:35 (8.8544 s / it)
[32m2023-10-20T16:49:35 | tasks.retrieval_utils: [0mFinished feature extraction
[32m2023-10-20T16:49:35 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product]
[32m2023-10-20T16:49:35 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product], done!
[32m2023-10-20T16:49:35 | tasks.retrieval_utils: [0mRerank dual-encoder results with cross-encoder...
[32m2023-10-20T16:49:35 | tasks.retrieval_utils: [0mi2t_scores.shape torch.Size([52, 102])
[32m2023-10-20T16:49:35 | tasks.retrieval_utils: [0mn_clip_per_video=1, with eval_frame_ensemble=concat
[32m2023-10-20T16:49:35 | utils.basic_utils: [0mEvaluation:  [ 0/52]  eta: 0:00:00    time: 0.0168  data: 0.0002  max mem: 33192 res mem: 33720
[32m2023-10-20T16:49:37 | utils.basic_utils: [0mEvaluation:  [51/52]  eta: 0:00:00    time: 0.0372  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:49:37 | utils.basic_utils: [0mEvaluation: Total time: 0:00:01 (0.0366 s / it)
[32m2023-10-20T16:49:37 | tasks.retrieval_utils: [0mt2i_scores.shape torch.Size([52, 102])
[32m2023-10-20T16:49:37 | utils.basic_utils: [0mEvaluation:  [ 0/52]  eta: 0:00:07    time: 0.1460  data: 0.0054  max mem: 33192 res mem: 33720
[32m2023-10-20T16:49:44 | utils.basic_utils: [0mEvaluation:  [51/52]  eta: 0:00:00    time: 0.1400  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:49:44 | utils.basic_utils: [0mEvaluation: Total time: 0:00:07 (0.1383 s / it)
[32m2023-10-20T16:49:44 | tasks.retrieval_utils: [0mEvaluation time 0:00:44
[32m2023-10-20T16:49:44 | tasks.retrieval_utils: [0mStart evaluation for media_type=video
[32m2023-10-20T16:49:44 | tasks.retrieval_utils: [0mComputing dual encoder features...
[32m2023-10-20T16:50:18 | utils.basic_utils: [0mextracting image feats  [0/4]  eta: 0:02:15    time: 33.9015  data: 33.5354  max mem: 33192 res mem: 33720
[32m2023-10-20T16:50:20 | utils.basic_utils: [0mextracting image feats  [3/4]  eta: 0:00:08    time: 8.8231  data: 8.5997  max mem: 33192 res mem: 33720
[32m2023-10-20T16:50:20 | utils.basic_utils: [0mextracting image feats Total time: 0:00:35 (8.8301 s / it)
[32m2023-10-20T16:50:20 | tasks.retrieval_utils: [0mFinished feature extraction
[32m2023-10-20T16:50:20 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product]
[32m2023-10-20T16:50:20 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product], done!
[32m2023-10-20T16:50:20 | tasks.retrieval_utils: [0mRerank dual-encoder results with cross-encoder...
[32m2023-10-20T16:50:20 | tasks.retrieval_utils: [0mi2t_scores.shape torch.Size([52, 102])
[32m2023-10-20T16:50:20 | tasks.retrieval_utils: [0mn_clip_per_video=1, with eval_frame_ensemble=concat
[32m2023-10-20T16:50:20 | utils.basic_utils: [0mEvaluation:  [ 0/52]  eta: 0:00:00    time: 0.0076  data: 0.0002  max mem: 33192 res mem: 33720
[32m2023-10-20T16:50:22 | utils.basic_utils: [0mEvaluation:  [51/52]  eta: 0:00:00    time: 0.0352  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:50:22 | utils.basic_utils: [0mEvaluation: Total time: 0:00:01 (0.0354 s / it)
[32m2023-10-20T16:50:22 | tasks.retrieval_utils: [0mt2i_scores.shape torch.Size([52, 102])
[32m2023-10-20T16:50:22 | utils.basic_utils: [0mEvaluation:  [ 0/52]  eta: 0:00:06    time: 0.1204  data: 0.0001  max mem: 33192 res mem: 33720
[32m2023-10-20T16:50:29 | utils.basic_utils: [0mEvaluation:  [51/52]  eta: 0:00:00    time: 0.1392  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:50:29 | utils.basic_utils: [0mEvaluation: Total time: 0:00:07 (0.1362 s / it)
[32m2023-10-20T16:50:29 | tasks.retrieval_utils: [0mEvaluation time 0:00:44
[32m2023-10-20T16:50:29 | tasks.retrieval_utils: [0mStart evaluation for media_type=video
[32m2023-10-20T16:50:29 | tasks.retrieval_utils: [0mComputing dual encoder features...
[32m2023-10-20T16:50:43 | utils.basic_utils: [0mextracting image feats  [0/2]  eta: 0:00:28    time: 14.2306  data: 13.9920  max mem: 33192 res mem: 33720
[32m2023-10-20T16:50:43 | utils.basic_utils: [0mextracting image feats  [1/2]  eta: 0:00:07    time: 7.1674  data: 6.9961  max mem: 33192 res mem: 33720
[32m2023-10-20T16:50:43 | utils.basic_utils: [0mextracting image feats Total time: 0:00:14 (7.1780 s / it)
[32m2023-10-20T16:50:43 | tasks.retrieval_utils: [0mFinished feature extraction
[32m2023-10-20T16:50:43 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product]
[32m2023-10-20T16:50:43 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product], done!
[32m2023-10-20T16:50:43 | tasks.retrieval_utils: [0mRerank dual-encoder results with cross-encoder...
[32m2023-10-20T16:50:43 | tasks.retrieval_utils: [0mi2t_scores.shape torch.Size([18, 35])
[32m2023-10-20T16:50:43 | tasks.retrieval_utils: [0mn_clip_per_video=1, with eval_frame_ensemble=concat
[32m2023-10-20T16:50:43 | utils.basic_utils: [0mEvaluation:  [ 0/18]  eta: 0:00:00    time: 0.0071  data: 0.0001  max mem: 33192 res mem: 33720
[32m2023-10-20T16:50:44 | utils.basic_utils: [0mEvaluation:  [17/18]  eta: 0:00:00    time: 0.0170  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:50:44 | utils.basic_utils: [0mEvaluation: Total time: 0:00:00 (0.0176 s / it)
[32m2023-10-20T16:50:44 | tasks.retrieval_utils: [0mt2i_scores.shape torch.Size([18, 35])
[32m2023-10-20T16:50:44 | utils.basic_utils: [0mEvaluation:  [ 0/18]  eta: 0:00:01    time: 0.0556  data: 0.0029  max mem: 33192 res mem: 33720
[32m2023-10-20T16:50:45 | utils.basic_utils: [0mEvaluation:  [17/18]  eta: 0:00:00    time: 0.0574  data: 0.0002  max mem: 33192 res mem: 33720
[32m2023-10-20T16:50:45 | utils.basic_utils: [0mEvaluation: Total time: 0:00:01 (0.0582 s / it)
[32m2023-10-20T16:50:45 | tasks.retrieval_utils: [0mEvaluation time 0:00:15
[32m2023-10-20T16:50:45 | tasks.retrieval_utils: [0mStart evaluation for media_type=video
[32m2023-10-20T16:50:45 | tasks.retrieval_utils: [0mComputing dual encoder features...
[32m2023-10-20T16:50:59 | utils.basic_utils: [0mextracting image feats  [0/2]  eta: 0:00:28    time: 14.0978  data: 13.8298  max mem: 33192 res mem: 33720
[32m2023-10-20T16:50:59 | utils.basic_utils: [0mextracting image feats  [1/2]  eta: 0:00:07    time: 7.0719  data: 6.9150  max mem: 33192 res mem: 33720
[32m2023-10-20T16:50:59 | utils.basic_utils: [0mextracting image feats Total time: 0:00:14 (7.0756 s / it)
[32m2023-10-20T16:50:59 | tasks.retrieval_utils: [0mFinished feature extraction
[32m2023-10-20T16:50:59 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product]
[32m2023-10-20T16:50:59 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product], done!
[32m2023-10-20T16:50:59 | tasks.retrieval_utils: [0mRerank dual-encoder results with cross-encoder...
[32m2023-10-20T16:50:59 | tasks.retrieval_utils: [0mi2t_scores.shape torch.Size([18, 35])
[32m2023-10-20T16:50:59 | tasks.retrieval_utils: [0mn_clip_per_video=1, with eval_frame_ensemble=concat
[32m2023-10-20T16:50:59 | utils.basic_utils: [0mEvaluation:  [ 0/18]  eta: 0:00:00    time: 0.0139  data: 0.0001  max mem: 33192 res mem: 33720
[32m2023-10-20T16:50:59 | utils.basic_utils: [0mEvaluation:  [17/18]  eta: 0:00:00    time: 0.0180  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:50:59 | utils.basic_utils: [0mEvaluation: Total time: 0:00:00 (0.0187 s / it)
[32m2023-10-20T16:50:59 | tasks.retrieval_utils: [0mt2i_scores.shape torch.Size([18, 35])
[32m2023-10-20T16:50:59 | utils.basic_utils: [0mEvaluation:  [ 0/18]  eta: 0:00:00    time: 0.0365  data: 0.0001  max mem: 33192 res mem: 33720
[32m2023-10-20T16:51:00 | utils.basic_utils: [0mEvaluation:  [17/18]  eta: 0:00:00    time: 0.0504  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:51:00 | utils.basic_utils: [0mEvaluation: Total time: 0:00:00 (0.0518 s / it)
[32m2023-10-20T16:51:01 | tasks.retrieval_utils: [0mEvaluation time 0:00:15
[32m2023-10-20T16:51:01 | tasks.retrieval_utils: [0mStart evaluation for media_type=video
[32m2023-10-20T16:51:01 | tasks.retrieval_utils: [0mComputing dual encoder features...
[32m2023-10-20T16:54:17 | utils.basic_utils: [0mextracting image feats  [ 0/30]  eta: 1:37:16    time: 194.5454  data: 192.6119  max mem: 33192 res mem: 33720
[32m2023-10-20T16:55:35 | utils.basic_utils: [0mextracting image feats  [29/30]  eta: 0:00:09    time: 1.2725  data: 0.7172  max mem: 33192 res mem: 33720
[32m2023-10-20T16:55:35 | utils.basic_utils: [0mextracting image feats Total time: 0:04:32 (9.0960 s / it)
[32m2023-10-20T16:55:37 | tasks.retrieval_utils: [0mFinished feature extraction
[32m2023-10-20T16:55:37 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product]
[32m2023-10-20T16:55:37 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product], done!
[32m2023-10-20T16:55:37 | tasks.retrieval_utils: [0mRerank dual-encoder results with cross-encoder...
[32m2023-10-20T16:55:37 | tasks.retrieval_utils: [0mi2t_scores.shape torch.Size([468, 935])
[32m2023-10-20T16:55:37 | tasks.retrieval_utils: [0mn_clip_per_video=1, with eval_frame_ensemble=concat
[32m2023-10-20T16:55:37 | utils.basic_utils: [0mEvaluation:  [  0/468]  eta: 0:00:12    time: 0.0261  data: 0.0016  max mem: 33192 res mem: 33720
[32m2023-10-20T16:55:41 | utils.basic_utils: [0mEvaluation:  [100/468]  eta: 0:00:16    time: 0.0427  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:55:46 | utils.basic_utils: [0mEvaluation:  [200/468]  eta: 0:00:11    time: 0.0450  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:55:50 | utils.basic_utils: [0mEvaluation:  [300/468]  eta: 0:00:07    time: 0.0424  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:55:55 | utils.basic_utils: [0mEvaluation:  [400/468]  eta: 0:00:03    time: 0.0449  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:55:58 | utils.basic_utils: [0mEvaluation:  [467/468]  eta: 0:00:00    time: 0.0424  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:55:58 | utils.basic_utils: [0mEvaluation: Total time: 0:00:20 (0.0444 s / it)
[32m2023-10-20T16:55:58 | tasks.retrieval_utils: [0mt2i_scores.shape torch.Size([468, 935])
[32m2023-10-20T16:55:58 | utils.basic_utils: [0mEvaluation:  [  0/468]  eta: 0:02:24    time: 0.3079  data: 0.0004  max mem: 33192 res mem: 33720
[32m2023-10-20T16:56:32 | utils.basic_utils: [0mEvaluation:  [100/468]  eta: 0:02:06    time: 0.3448  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:57:06 | utils.basic_utils: [0mEvaluation:  [200/468]  eta: 0:01:31    time: 0.3346  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:57:40 | utils.basic_utils: [0mEvaluation:  [300/468]  eta: 0:00:57    time: 0.3420  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:58:14 | utils.basic_utils: [0mEvaluation:  [400/468]  eta: 0:00:23    time: 0.3350  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:58:37 | utils.basic_utils: [0mEvaluation:  [467/468]  eta: 0:00:00    time: 0.3354  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T16:58:37 | utils.basic_utils: [0mEvaluation: Total time: 0:02:39 (0.3405 s / it)
[32m2023-10-20T16:58:37 | tasks.retrieval_utils: [0mEvaluation time 0:07:36
[32m2023-10-20T16:58:38 | tasks.retrieval_utils: [0mStart evaluation for media_type=video
[32m2023-10-20T16:58:38 | tasks.retrieval_utils: [0mComputing dual encoder features...
[32m2023-10-20T17:01:56 | utils.basic_utils: [0mextracting image feats  [ 0/30]  eta: 1:38:06    time: 196.2108  data: 193.7946  max mem: 33192 res mem: 33720
[32m2023-10-20T17:03:13 | utils.basic_utils: [0mextracting image feats  [29/30]  eta: 0:00:09    time: 1.2508  data: 0.6911  max mem: 33192 res mem: 33720
[32m2023-10-20T17:03:13 | utils.basic_utils: [0mextracting image feats Total time: 0:04:32 (9.0950 s / it)
[32m2023-10-20T17:03:15 | tasks.retrieval_utils: [0mFinished feature extraction
[32m2023-10-20T17:03:15 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product]
[32m2023-10-20T17:03:15 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product], done!
[32m2023-10-20T17:03:15 | tasks.retrieval_utils: [0mRerank dual-encoder results with cross-encoder...
[32m2023-10-20T17:03:15 | tasks.retrieval_utils: [0mi2t_scores.shape torch.Size([468, 935])
[32m2023-10-20T17:03:15 | tasks.retrieval_utils: [0mn_clip_per_video=1, with eval_frame_ensemble=concat
[32m2023-10-20T17:03:15 | utils.basic_utils: [0mEvaluation:  [  0/468]  eta: 0:00:08    time: 0.0174  data: 0.0013  max mem: 33192 res mem: 33720
[32m2023-10-20T17:03:19 | utils.basic_utils: [0mEvaluation:  [100/468]  eta: 0:00:16    time: 0.0461  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:03:23 | utils.basic_utils: [0mEvaluation:  [200/468]  eta: 0:00:11    time: 0.0464  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:03:28 | utils.basic_utils: [0mEvaluation:  [300/468]  eta: 0:00:07    time: 0.0451  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:03:32 | utils.basic_utils: [0mEvaluation:  [400/468]  eta: 0:00:03    time: 0.0441  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:03:36 | utils.basic_utils: [0mEvaluation:  [467/468]  eta: 0:00:00    time: 0.0450  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:03:36 | utils.basic_utils: [0mEvaluation: Total time: 0:00:20 (0.0448 s / it)
[32m2023-10-20T17:03:36 | tasks.retrieval_utils: [0mt2i_scores.shape torch.Size([468, 935])
[32m2023-10-20T17:03:36 | utils.basic_utils: [0mEvaluation:  [  0/468]  eta: 0:02:42    time: 0.3462  data: 0.0058  max mem: 33192 res mem: 33720
[32m2023-10-20T17:04:10 | utils.basic_utils: [0mEvaluation:  [100/468]  eta: 0:02:04    time: 0.3354  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:04:44 | utils.basic_utils: [0mEvaluation:  [200/468]  eta: 0:01:31    time: 0.3369  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:05:18 | utils.basic_utils: [0mEvaluation:  [300/468]  eta: 0:00:57    time: 0.3326  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:05:52 | utils.basic_utils: [0mEvaluation:  [400/468]  eta: 0:00:23    time: 0.3476  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:06:15 | utils.basic_utils: [0mEvaluation:  [467/468]  eta: 0:00:00    time: 0.3304  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:06:15 | utils.basic_utils: [0mEvaluation: Total time: 0:02:39 (0.3405 s / it)
[32m2023-10-20T17:06:15 | tasks.retrieval_utils: [0mEvaluation time 0:07:37
[32m2023-10-20T17:06:16 | tasks.retrieval_utils: [0mStart evaluation for media_type=video
[32m2023-10-20T17:06:16 | tasks.retrieval_utils: [0mComputing dual encoder features...
[32m2023-10-20T17:09:37 | utils.basic_utils: [0mextracting image feats  [ 0/32]  eta: 1:46:04    time: 198.8779  data: 194.6864  max mem: 33192 res mem: 33720
[32m2023-10-20T17:11:15 | utils.basic_utils: [0mextracting image feats  [31/32]  eta: 0:00:09    time: 1.7972  data: 1.1031  max mem: 33192 res mem: 33720
[32m2023-10-20T17:11:15 | utils.basic_utils: [0mextracting image feats Total time: 0:04:57 (9.2995 s / it)
[32m2023-10-20T17:11:17 | tasks.retrieval_utils: [0mFinished feature extraction
[32m2023-10-20T17:11:17 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product]
[32m2023-10-20T17:11:17 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product], done!
[32m2023-10-20T17:11:17 | tasks.retrieval_utils: [0mRerank dual-encoder results with cross-encoder...
[32m2023-10-20T17:11:17 | tasks.retrieval_utils: [0mi2t_scores.shape torch.Size([505, 1008])
[32m2023-10-20T17:11:17 | tasks.retrieval_utils: [0mn_clip_per_video=1, with eval_frame_ensemble=concat
[32m2023-10-20T17:11:17 | utils.basic_utils: [0mEvaluation:  [  0/505]  eta: 0:00:16    time: 0.0324  data: 0.0012  max mem: 33192 res mem: 33720
[32m2023-10-20T17:11:22 | utils.basic_utils: [0mEvaluation:  [100/505]  eta: 0:00:18    time: 0.0438  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:11:26 | utils.basic_utils: [0mEvaluation:  [200/505]  eta: 0:00:13    time: 0.0431  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:11:30 | utils.basic_utils: [0mEvaluation:  [300/505]  eta: 0:00:09    time: 0.0431  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:11:35 | utils.basic_utils: [0mEvaluation:  [400/505]  eta: 0:00:04    time: 0.0437  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:11:39 | utils.basic_utils: [0mEvaluation:  [500/505]  eta: 0:00:00    time: 0.0456  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:11:40 | utils.basic_utils: [0mEvaluation:  [504/505]  eta: 0:00:00    time: 0.0436  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:11:40 | utils.basic_utils: [0mEvaluation: Total time: 0:00:22 (0.0448 s / it)
[32m2023-10-20T17:11:40 | tasks.retrieval_utils: [0mt2i_scores.shape torch.Size([505, 1008])
[32m2023-10-20T17:11:40 | utils.basic_utils: [0mEvaluation:  [  0/505]  eta: 0:02:49    time: 0.3361  data: 0.0007  max mem: 33192 res mem: 33720
[32m2023-10-20T17:12:16 | utils.basic_utils: [0mEvaluation:  [100/505]  eta: 0:02:25    time: 0.3632  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:12:52 | utils.basic_utils: [0mEvaluation:  [200/505]  eta: 0:01:50    time: 0.3704  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:13:28 | utils.basic_utils: [0mEvaluation:  [300/505]  eta: 0:01:14    time: 0.3667  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:14:06 | utils.basic_utils: [0mEvaluation:  [400/505]  eta: 0:00:38    time: 0.3739  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:14:42 | utils.basic_utils: [0mEvaluation:  [500/505]  eta: 0:00:01    time: 0.3646  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:14:44 | utils.basic_utils: [0mEvaluation:  [504/505]  eta: 0:00:00    time: 0.3636  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:14:44 | utils.basic_utils: [0mEvaluation: Total time: 0:03:04 (0.3650 s / it)
[32m2023-10-20T17:14:44 | tasks.retrieval_utils: [0mEvaluation time 0:08:28
[32m2023-10-20T17:14:45 | tasks.retrieval_utils: [0mStart evaluation for media_type=video
[32m2023-10-20T17:14:45 | tasks.retrieval_utils: [0mComputing dual encoder features...
[32m2023-10-20T17:18:08 | utils.basic_utils: [0mextracting image feats  [ 0/32]  eta: 1:47:18    time: 201.2104  data: 197.3327  max mem: 33192 res mem: 33720
[32m2023-10-20T17:19:48 | utils.basic_utils: [0mextracting image feats  [31/32]  eta: 0:00:09    time: 1.8185  data: 1.0823  max mem: 33192 res mem: 33720
[32m2023-10-20T17:19:48 | utils.basic_utils: [0mextracting image feats Total time: 0:05:01 (9.4093 s / it)
[32m2023-10-20T17:19:50 | tasks.retrieval_utils: [0mFinished feature extraction
[32m2023-10-20T17:19:50 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product]
[32m2023-10-20T17:19:50 | tasks.retrieval_utils: [0mComputing ITC scores [dot-product], done!
[32m2023-10-20T17:19:50 | tasks.retrieval_utils: [0mRerank dual-encoder results with cross-encoder...
[32m2023-10-20T17:19:50 | tasks.retrieval_utils: [0mi2t_scores.shape torch.Size([505, 1008])
[32m2023-10-20T17:19:50 | tasks.retrieval_utils: [0mn_clip_per_video=1, with eval_frame_ensemble=concat
[32m2023-10-20T17:19:50 | utils.basic_utils: [0mEvaluation:  [  0/505]  eta: 0:00:07    time: 0.0139  data: 0.0011  max mem: 33192 res mem: 33720
[32m2023-10-20T17:19:54 | utils.basic_utils: [0mEvaluation:  [100/505]  eta: 0:00:18    time: 0.0458  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:19:59 | utils.basic_utils: [0mEvaluation:  [200/505]  eta: 0:00:13    time: 0.0464  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:20:03 | utils.basic_utils: [0mEvaluation:  [300/505]  eta: 0:00:09    time: 0.0432  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:20:08 | utils.basic_utils: [0mEvaluation:  [400/505]  eta: 0:00:04    time: 0.0442  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:20:12 | utils.basic_utils: [0mEvaluation:  [500/505]  eta: 0:00:00    time: 0.0457  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:20:12 | utils.basic_utils: [0mEvaluation:  [504/505]  eta: 0:00:00    time: 0.0473  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:20:12 | utils.basic_utils: [0mEvaluation: Total time: 0:00:22 (0.0448 s / it)
[32m2023-10-20T17:20:12 | tasks.retrieval_utils: [0mt2i_scores.shape torch.Size([505, 1008])
[32m2023-10-20T17:20:13 | utils.basic_utils: [0mEvaluation:  [  0/505]  eta: 0:02:54    time: 0.3465  data: 0.0058  max mem: 33192 res mem: 33720
[32m2023-10-20T17:20:50 | utils.basic_utils: [0mEvaluation:  [100/505]  eta: 0:02:28    time: 0.3801  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:21:29 | utils.basic_utils: [0mEvaluation:  [200/505]  eta: 0:01:55    time: 0.4172  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:22:10 | utils.basic_utils: [0mEvaluation:  [300/505]  eta: 0:01:20    time: 0.4345  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:22:52 | utils.basic_utils: [0mEvaluation:  [400/505]  eta: 0:00:41    time: 0.4012  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:23:37 | utils.basic_utils: [0mEvaluation:  [500/505]  eta: 0:00:02    time: 0.4838  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:23:39 | utils.basic_utils: [0mEvaluation:  [504/505]  eta: 0:00:00    time: 0.4876  data: 0.0000  max mem: 33192 res mem: 33720
[32m2023-10-20T17:23:39 | utils.basic_utils: [0mEvaluation: Total time: 0:03:26 (0.4086 s / it)
[32m2023-10-20T17:23:39 | tasks.retrieval_utils: [0mEvaluation time 0:08:54
[32m2023-10-20T17:23:40 | tasks.retrieval_utils: [0mStart evaluation for media_type=video
[32m2023-10-20T17:23:40 | tasks.retrieval_utils: [0mComputing dual encoder features...
